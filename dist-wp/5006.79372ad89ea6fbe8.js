"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[5006],{60084:(c,g,t)=>{t.d(g,{D:()=>h});var a=t(26496);function h(r){r?.writtenProperties&&r.writtenProperties.forEach(({target:o,propName:d,newOrigin:L})=>{(0,a.l)(o)&&L&&o.originOf(d)!==L&&o.updateOrigin(d,L)})}},26496:(c,g,t)=>{function a(h){return h&&"getAtOrigin"in h&&"originOf"in h}t.d(g,{l:()=>a})},69484:(c,g,t)=>{t.r(g),t.d(g,{save:()=>yt,saveAll:()=>ft,saveAllAs:()=>mt,saveAs:()=>dt});var a=t(15861),h=t(57678),r=t(57964),o=t(60084),d=t(85155),L=t(89713),S=t(23933),w=t(85971),k=t(79936),G=t(453),m=t(50318);const O="Feature Service",M="feature-layer-utils",q=`${M}-save`,_=`${M}-save-as`,P=`${M}-saveall`,E=`${M}-saveall-as`;function T(n){return{isValid:(0,w.fP)(n)&&("feature"!==n.type||!n.dynamicDataSource),errorMessage:"Feature layer should be a layer or table in a map or feature service"}}function F(n){const e=[],l=[];for(const{layer:i,layerJSON:y}of n)i.isTable?l.push(y):e.push(y);return{layers:e,tables:l}}function z(n){return F([n])}function J(n,e){return I.apply(this,arguments)}function I(){return(I=(0,a.Z)(function*(n,e){return/\/\d+\/?$/.test(n.url)?z(e[0]):V(e,n)})).apply(this,arguments)}function V(n,e){return D.apply(this,arguments)}function D(){return D=(0,a.Z)(function*(n,e){if(!e)return n.reverse(),F(n);const{layer:{url:l,customParameters:i,apiKey:y}}=n[0];let u=yield e.fetchData("json");null!=u?.layers&&null!=u?.tables||(u=yield function tt(n,e,l){return x.apply(this,arguments)}(u,{url:l??"",customParameters:i,apiKey:y},n.map(s=>s.layer.layerId)));for(const s of n)Q(s.layer,s.layerJSON,u);return u}),D.apply(this,arguments)}function x(){return x=(0,a.Z)(function*(n,e,l){n||={},n.layers||=[],n.tables||=[];const{url:i,customParameters:y,apiKey:u}=e,{serviceJSON:s,layersJSON:f}=yield(0,S.V)(i,{customParameters:y,apiKey:u}),p=Y(n.layers,s.layers,l),v=Y(n.tables,s.tables,l);n.layers=p.itemResources,n.tables=v.itemResources;const Z=[...p.added,...v.added],ht=f?[...f.layers,...f.tables]:[];return yield function nt(n,e,l,i){return U.apply(this,arguments)}(n,Z,i,ht),n}),x.apply(this,arguments)}function Y(n,e,l){const i=(0,h.e5)(n,e,(u,s)=>u.id===s.id);n=n.filter(u=>!i.removed.some(s=>s.id===u.id));const y=i.added;return y.forEach(({id:u})=>{n.push({id:u})}),{itemResources:n,added:y.filter(({id:u})=>!l.includes(u))}}function U(){return U=(0,a.Z)(function*(n,e,l,i){const y=yield function rt(n){return A.apply(this,arguments)}(e),u=e.map(({id:s,type:f})=>new(y.get(f))({url:l,layerId:s,sourceJSON:i.find(({id:p})=>p===s)}));yield Promise.allSettled(u.map(s=>s.load())),u.forEach(s=>{const{layerId:f,loaded:p,defaultPopupTemplate:v}=s;if(!p||null==v)return;const Z={id:f,popupInfo:v.toJSON()};"ArcGISFeatureLayer"!==s.operationalLayerType&&(Z.layerType=s.operationalLayerType),Q(s,Z,n)})}),U.apply(this,arguments)}function A(){return(A=(0,a.Z)(function*(n){const e=[];n.forEach(({type:y})=>{const u=function et(n){let e;switch(n){case"Feature Layer":case"Table":e="FeatureLayer";break;case"Oriented Imagery Layer":e="OrientedImageryLayer"}return e}(y);e.push((0,k.T[u])())});const l=yield Promise.all(e),i=new Map;return n.forEach(({type:y},u)=>{i.set(y,l[u])}),i})).apply(this,arguments)}function Q(n,e,l){!function X(n,e){const l=n.findIndex(({id:i})=>i===e.id);-1===l?n.push(e):n[l]=e}(n.isTable?l.tables:l.layers,e)}function H(n,e){if(!n.length)throw new r.Z(`${e}:missing-parameters`,"'layers' array should contain at least one feature layer")}function b(n,e){const l=n.map(i=>i.layerId);if(new Set(l).size!==l.length)throw new r.Z(`${e}:invalid-parameters`,"'layers' array should contain only one instance each of layer or table in a feature service")}function C(){return(C=(0,a.Z)(function*(n){H(n,P),yield Promise.all(n.map(e=>e.load()));for(const e of n)(0,d.DC)(e,P,T),(0,d.Ym)({layer:e,itemType:O,errorNamePrefix:P});(function at(n,e){const l=n.map(i=>i.portalItem.id);if(new Set(l).size>1)throw new r.Z(`${e}:invalid-parameters`,"All layers in the 'layers' array should be loaded from the same portal item")})(n,P),b(n,P)})).apply(this,arguments)}function ot(n,e){return K.apply(this,arguments)}function K(){return(K=(0,a.Z)(function*(n,e){const{url:l,layerId:i,title:y,fullExtent:u,isTable:s}=n,f=(0,L.Qc)(l);e.url="FeatureServer"===f?.serverType?l:`${l}/${i}`,e.title||=y,e.extent=null,s||null==u||(e.extent=yield(0,m.$o)(u)),(0,m.ck)(e,m.Kz.METADATA),(0,m.ck)(e,m.Kz.MULTI_LAYER),(0,m.qj)(e,m.Kz.SINGLE_LAYER),s&&(0,m.qj)(e,m.Kz.TABLE)})).apply(this,arguments)}function R(){return(R=(0,a.Z)(function*(n){H(n,E),yield Promise.all(n.map(e=>e.load()));for(const e of n)(0,d.DC)(e,E,T);(function st(n,e){for(const u of n){const s=u.parsedUrl.path,f=(0,L.Qc)(s);if(!f?.url.path)throw new r.Z(`${e}:invalid-parameters`,(0,d.xG)(u,`has unsupported url pattern: ${s}`),{layer:u});const v=f?.serverType;if("FeatureServer"!==v&&"MapServer"!==v)throw new r.Z(`${e}:invalid-parameters`,(0,d.xG)(u,`has unsupported server type: ${v}`),{layer:u});if("MapServer"===v&&n.length>1)throw new r.Z(`${e}:invalid-parameters`,"Only one layer or table in a map service can be saved")}const l=(0,L.Qc)(n[0].parsedUrl.path),i=l?.url.path;if(!n.every(u=>(0,L.Qc)(u.parsedUrl.path)?.url.path===i))throw new r.Z(`${e}:invalid-parameters`,"'layers' array should only contain layers or tables that belong to the same feature service")})(n,E),b(n,E)})).apply(this,arguments)}function W(){return(W=(0,a.Z)(function*(n,e){let l=0,i=0;for(const{isTable:s}of e)s?i++:l++;const y=e[0].parsedUrl.path,u=(0,L.Qc)(y);if(n.url="FeatureServer"===u?.serverType?u.url.path:y,n.title||=u.title,n.extent=null,l>0){const s=e.map(f=>f.fullExtent).filter(h.pC).reduce((f,p)=>f.clone().union(p));s&&(n.extent=yield(0,m.$o)(s))}(0,m.ck)(n,m.Kz.METADATA),(0,m.Ct)(n,m.Kz.MULTI_LAYER,e.length>1),(0,m.Ct)(n,m.Kz.SINGLE_LAYER,1===e.length),(0,m.Ct)(n,m.Kz.TABLE,i>0&&0===l),(0,d.UY)(n)})).apply(this,arguments)}function yt(n,e){return j.apply(this,arguments)}function j(){return(j=(0,a.Z)(function*(n,e){return(0,d.a1)({layer:n,itemType:O,validateLayer:T,createItemData:(l,i)=>J(i,[l]),errorNamePrefix:q},e)})).apply(this,arguments)}function ft(n,e){return B.apply(this,arguments)}function B(){return B=(0,a.Z)(function*(n,e){yield function lt(n){return C.apply(this,arguments)}(n);const l=n[0].portalItem,i=(0,G.Yv)(l),y=yield Promise.all(n.map(s=>(0,d.Nw)(s,i,e))),u=yield J(l,n.map((s,f)=>({layer:s,layerJSON:y[f]})));return(0,d.UY)(l),yield l.update({data:u}),yield Promise.all(n.slice(1).map(s=>s.portalItem.reload())),(0,o.D)(i),l.clone()}),B.apply(this,arguments)}function dt(n,e,l){return N.apply(this,arguments)}function N(){return(N=(0,a.Z)(function*(n,e,l){return(0,d.po)({layer:n,itemType:O,validateLayer:T,createItemData:(i,y)=>Promise.resolve(z(i)),errorNamePrefix:_,newItem:e,setItemProperties:ot},l)})).apply(this,arguments)}function mt(n,e,l){return $.apply(this,arguments)}function $(){return $=(0,a.Z)(function*(n,e,l){yield function ut(n){return R.apply(this,arguments)}(n);const i=(0,d.uT)({itemType:O,errorNamePrefix:E,newItem:e}),y=(0,G.Yv)(i),u=yield Promise.all(n.map(f=>(0,d.Nw)(f,y,l))),s=yield V(n.map((f,p)=>({layer:f,layerJSON:u[p]})));yield function it(n,e){return W.apply(this,arguments)}(i,n),yield(0,d.jX)(i,s,l);for(const f of n)f.portalItem=i.clone();return(0,o.D)(y),i}),$.apply(this,arguments)}},79936:(c,g,t)=>{t.d(g,{T:()=>h});var a=t(15861);const h={BingMapsLayer:(r=(0,a.Z)(function*(){return(yield t.e(4499).then(t.bind(t,84499))).default}),function(){return r.apply(this,arguments)}),BuildingSceneLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8866),t.e(4612),t.e(9893),t.e(9269),t.e(3080)]).then(t.bind(t,23080))).default});return function(){return r.apply(this,arguments)}}(),CSVLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(257).then(t.bind(t,90257))).default});return function(){return r.apply(this,arguments)}}(),DimensionLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(9645)]).then(t.bind(t,59645))).default});return function(){return r.apply(this,arguments)}}(),ElevationLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(1753)]).then(t.bind(t,86069))).default});return function(){return r.apply(this,arguments)}}(),FeatureLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.resolve().then(t.bind(t,90373))).default});return function(){return r.apply(this,arguments)}}(),GeoJSONLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(59).then(t.bind(t,80059))).default});return function(){return r.apply(this,arguments)}}(),GeoRSSLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(9050).then(t.bind(t,39050))).default});return function(){return r.apply(this,arguments)}}(),GroupLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(782).then(t.bind(t,50782))).default});return function(){return r.apply(this,arguments)}}(),ImageryLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(842),t.e(2784),t.e(6062),t.e(3338),t.e(2616),t.e(5318),t.e(2861)]).then(t.bind(t,72861))).default});return function(){return r.apply(this,arguments)}}(),ImageryTileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(6062),t.e(9350),t.e(3338),t.e(2616),t.e(3287),t.e(5318),t.e(8592),t.e(8505)]).then(t.bind(t,34208))).default});return function(){return r.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8866),t.e(8592),t.e(4092)]).then(t.bind(t,74092))).default});return function(){return r.apply(this,arguments)}}(),KMLLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(2858)]).then(t.bind(t,22858))).default});return function(){return r.apply(this,arguments)}}(),LineOfSightLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(6625)]).then(t.bind(t,17551))).default});return function(){return r.apply(this,arguments)}}(),LinkChartLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(842),t.e(3866),t.e(5904),t.e(1518),t.e(6518),t.e(2166),t.e(8592),t.e(9900)]).then(t.bind(t,49900))).default});return function(){return r.apply(this,arguments)}}(),MapImageLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(842),t.e(2784),t.e(9351),t.e(8592),t.e(5390)]).then(t.bind(t,37803))).default});return function(){return r.apply(this,arguments)}}(),MapNotesLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(8191)]).then(t.bind(t,18191))).default});return function(){return r.apply(this,arguments)}}(),MediaLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(4313)]).then(t.bind(t,69981))).default});return function(){return r.apply(this,arguments)}}(),OGCFeatureLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(842),t.e(2871),t.e(7960)]).then(t.bind(t,36019))).default});return function(){return r.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(4930)]).then(t.bind(t,22439))).default});return function(){return r.apply(this,arguments)}}(),OrientedImageryLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(617).then(t.bind(t,60617))).default});return function(){return r.apply(this,arguments)}}(),PointCloudLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8866),t.e(8592),t.e(265)]).then(t.bind(t,70265))).default});return function(){return r.apply(this,arguments)}}(),RouteLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(3301),t.e(5607)]).then(t.bind(t,25607))).default});return function(){return r.apply(this,arguments)}}(),SceneLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8866),t.e(4612),t.e(9893),t.e(9269),t.e(8592),t.e(724)]).then(t.bind(t,20724))).default});return function(){return r.apply(this,arguments)}}(),StreamLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(7157).then(t.bind(t,7157))).default});return function(){return r.apply(this,arguments)}}(),SubtypeGroupLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(6663).then(t.bind(t,46663))).default});return function(){return r.apply(this,arguments)}}(),TileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(842),t.e(2784),t.e(9351),t.e(8592),t.e(1433)]).then(t.bind(t,77183))).default});return function(){return r.apply(this,arguments)}}(),UnknownLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(4850).then(t.bind(t,84850))).default});return function(){return r.apply(this,arguments)}}(),UnsupportedLayer:function(){var r=(0,a.Z)(function*(){return(yield t.e(4680).then(t.bind(t,60842))).default});return function(){return r.apply(this,arguments)}}(),VectorTileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(7917),t.e(4433),t.e(8592),t.e(8622)]).then(t.bind(t,62003))).default});return function(){return r.apply(this,arguments)}}(),VoxelLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8866),t.e(8592),t.e(4691)]).then(t.bind(t,4691))).default});return function(){return r.apply(this,arguments)}}(),WFSLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(1970),t.e(6562)]).then(t.bind(t,18504))).default});return function(){return r.apply(this,arguments)}}(),WMSLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(616)]).then(t.bind(t,10616))).default});return function(){return r.apply(this,arguments)}}(),WMTSLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(7179)]).then(t.bind(t,67179))).default});return function(){return r.apply(this,arguments)}}(),WebTileLayer:function(){var r=(0,a.Z)(function*(){return(yield Promise.all([t.e(8592),t.e(3715)]).then(t.bind(t,54556))).default});return function(){return r.apply(this,arguments)}}()};var r},6661:(c,g,t)=>{t.d(g,{T:()=>r});var a=t(15861),h=t(66476);function r(d,L){return o.apply(this,arguments)}function o(){return(o=(0,a.Z)(function*(d,L){const{data:S}=yield(0,h.Z)(d,{responseType:"json",query:{f:"json",...L?.customParameters,token:L?.apiKey}});return S})).apply(this,arguments)}},65820:(c,g,t)=>{t.d(g,{w:()=>o});var a=t(11931),h=t(57964),r=t(40907);function o(d){if(a.default.apiKey&&(0,r.r)(d.portal.url))throw new h.Z("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${d.portal.url} when using an api key`)}}}]);