"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[7528],{33996:(P,R,h)=>{function y(x,l){const T=x.count;l||(l=new x.TypedArrayConstructor(T));for(let g=0;g<T;g++)l[g]=x.get(g);return l}h.d(R,{m:()=>y}),Object.freeze(Object.defineProperty({__proto__:null,makeDense:y},Symbol.toStringTag,{value:"Module"}))},41624:(P,R,h)=>{h.d(R,{a:()=>v,f:()=>l,n:()=>x});var y=h(40271);function v(g,u){x(g.typedBuffer,u.typedBuffer,g.typedBufferStride,u.typedBufferStride)}function x(g,u,_=2,d=_){const a=u.length/2;let n=0,i=0;if((0,y.kJ)(u)||(0,y.Q7)(u)){for(let m=0;m<a;++m)g[n]=u[i],g[n+1]=u[i+1],n+=_,i+=d;return}const f=(0,y.Op)(u);if((0,y.B3)(u))for(let m=0;m<a;++m)g[n]=Math.max(u[i]/f,-1),g[n+1]=Math.max(u[i+1]/f,-1),n+=_,i+=d;else for(let m=0;m<a;++m)g[n]=u[i]/f,g[n+1]=u[i+1]/f,n+=_,i+=d}function l(g,u,_,d){const a=g.typedBuffer,n=g.typedBufferStride,i=d?.count??g.count;let f=(d?.dstIndex??0)*n;for(let m=0;m<i;++m)a[f]=u,a[f+1]=_,f+=n}Object.freeze(Object.defineProperty({__proto__:null,fill:l,normalizeIntegerBuffer:x,normalizeIntegerBufferView:v},Symbol.toStringTag,{value:"Module"}))},52875:(P,R,h)=>{function y(T,g){v(T.typedBuffer,g.typedBuffer,T.typedBufferStride,g.typedBufferStride)}function v(T,g,u=3,_=u){const d=g.length/_;let a=0,n=0;for(let i=0;i<d;++i)T[a]=g[n],T[a+1]=g[n+1],T[a+2]=g[n+2],a+=u,n+=_}function x(T,g,u,_,d){const a=T.typedBuffer,n=T.typedBufferStride,i=d?.count??T.count;let f=(d?.dstIndex??0)*n;for(let m=0;m<i;++m)a[f]=g,a[f+1]=u,a[f+2]=_,f+=n}h.d(R,{a:()=>y,c:()=>v,f:()=>x}),Object.freeze(Object.defineProperty({__proto__:null,copy:v,copyView:y,fill:x},Symbol.toStringTag,{value:"Module"}))},5710:(P,R,h)=>{h.d(R,{a:()=>x,b:()=>g,n:()=>T,s:()=>u,t:()=>l});var y=h(58466);function x(d,a,n){l(d.typedBuffer,a.typedBuffer,n,d.typedBufferStride,a.typedBufferStride)}function l(d,a,n,i=4,f=i){if(d.length/i!=a.length/f)return void y.c.error("source and destination buffers need to have the same number of elements");const m=d.length/i,b=n[0],E=n[1],N=n[2],C=n[3],I=n[4],B=n[5],j=n[6],G=n[7],K=n[8];let V=0,Z=0;for(let $=0;$<m;$++){const W=a[V],X=a[V+1],F=a[V+2],z=a[V+3];d[Z]=b*W+C*X+j*F,d[Z+1]=E*W+I*X+G*F,d[Z+2]=N*W+B*X+K*F,d[Z+3]=z,V+=f,Z+=i}}function T(d,a){const n=Math.min(d.count,a.count),i=d.typedBuffer,f=d.typedBufferStride,m=a.typedBuffer,b=a.typedBufferStride;for(let E=0;E<n;E++){const N=E*f,C=E*b,I=m[C],B=m[C+1],j=m[C+2],G=I*I+B*B+j*j;if(G>0){const K=1/Math.sqrt(G);i[N]=K*I,i[N+1]=K*B,i[N+2]=K*j}}}function g(d,a,n){u(d.typedBuffer,a,n,d.typedBufferStride)}function u(d,a,n,i=4){const f=Math.min(d.length/i,a.count),m=a.typedBuffer,b=a.typedBufferStride;let E=0,N=0;for(let C=0;C<f;C++)d[N]=n*m[E],d[N+1]=n*m[E+1],d[N+2]=n*m[E+2],d[N+3]=n*m[E+3],E+=b,N+=i}Object.freeze(Object.defineProperty({__proto__:null,normalize:T,scale:u,scaleView:g,transformMat3:l,transformMat3View:x,transformMat4:function v(d,a,n){if(d.count!==a.count)return void y.c.error("source and destination buffers need to have the same number of elements");const i=d.count,f=n[0],m=n[1],b=n[2],E=n[3],N=n[4],C=n[5],I=n[6],B=n[7],j=n[8],G=n[9],K=n[10],V=n[11],Z=n[12],$=n[13],W=n[14],X=n[15],F=d.typedBuffer,z=d.typedBufferStride,H=a.typedBuffer,U=a.typedBufferStride;for(let J=0;J<i;J++){const Y=J*z,k=J*U,Q=H[k],q=H[k+1],ee=H[k+2],te=H[k+3];F[Y]=f*Q+N*q+j*ee+Z*te,F[Y+1]=m*Q+C*q+G*ee+$*te,F[Y+2]=b*Q+I*q+K*ee+W*te,F[Y+3]=E*Q+B*q+V*ee+X*te}}},Symbol.toStringTag,{value:"Module"}))},17765:(P,R,h)=>{function y(T,g){v(T.typedBuffer,g,T.typedBufferStride)}function v(T,g,u=4){const _=g.typedBuffer,d=g.typedBufferStride,a=g.count;let n=0,i=0;for(let f=0;f<a;++f)T[n]=_[i],T[n+1]=_[i+1],T[n+2]=_[i+2],T[n+3]=_[i+3],n+=u,i+=d}function x(T,g,u,_,d,a){const n=T.typedBuffer,i=T.typedBufferStride,f=a?.count??T.count;let m=(a?.dstIndex??0)*i;for(let b=0;b<f;++b)n[m]=g,n[m+1]=u,n[m+2]=_,n[m+3]=d,m+=i}h.d(R,{a:()=>y,c:()=>v,f:()=>x}),Object.freeze(Object.defineProperty({__proto__:null,copy:v,copyView:y,fill:x},Symbol.toStringTag,{value:"Module"}))},19840:(P,R,h)=>{function y(T){switch(T){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}h.d(R,{n1:()=>y})},73848:(P,R,h)=>{h.d(R,{C:()=>u});var y=h(15861),v=h(66476),x=h(37636),l=h(57964),T=h(79412),g=h(6785);class u{constructor(a){this._streamDataRequester=a}loadJSON(a,n){var i=this;return(0,y.Z)(function*(){return i._load("json",a,n)})()}loadBinary(a,n){var i=this;return(0,y.Z)(function*(){return(0,g.HK)(a)?((0,T.k_)(n),(0,g.AH)(a)):i._load("binary",a,n)})()}loadImage(a,n){var i=this;return(0,y.Z)(function*(){return i._load("image",a,n)})()}_load(a,n,i){var f=this;return(0,y.Z)(function*(){if(null==f._streamDataRequester)return(yield(0,v.Z)(n,{responseType:_[a]})).data;const m=yield(0,x.q6)(f._streamDataRequester.request(n,a,i));if(!0===m.ok)return m.value;throw(0,T.r9)(m.error),new l.Z("",`Request for resource failed: ${m.error}`)})()}}const _={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},22646:(P,R,h)=>{h.d(R,{p:()=>l});var y=h(40271),v=h(58248),x=h(39237);function l(_,d){switch(d){case x.MX.TRIANGLES:return function T(_){return"number"==typeof _?(0,v.KF)(_):(0,y.lq)(_)?new Uint16Array(_):_}(_);case x.MX.TRIANGLE_STRIP:return function g(_){const d="number"==typeof _?_:_.length;if(d<3)return[];const a=d-2,n=(0,v.$z)(3*a);if("number"==typeof _){let i=0;for(let f=0;f<a;f+=1)f%2==0?(n[i++]=f,n[i++]=f+1,n[i++]=f+2):(n[i++]=f+1,n[i++]=f,n[i++]=f+2)}else{let i=0;for(let f=0;f<a;f+=1)f%2==0?(n[i++]=_[f],n[i++]=_[f+1],n[i++]=_[f+2]):(n[i++]=_[f+1],n[i++]=_[f],n[i++]=_[f+2])}return n}(_);case x.MX.TRIANGLE_FAN:return function u(_){const d="number"==typeof _?_:_.length;if(d<3)return new Uint16Array(0);const a=d-2,n=a<=65536?new Uint16Array(3*a):new Uint32Array(3*a);if("number"==typeof _){let b=0;for(let E=0;E<a;++E)n[b++]=0,n[b++]=E+1,n[b++]=E+2;return n}const i=_[0];let f=_[1],m=0;for(let b=0;b<a;++b){const E=_[b+2];n[m++]=i,n[m++]=f,n[m++]=E,f=E}return n}(_)}}},65749:(P,R,h)=>{h.d(R,{$A:()=>T,Ml:()=>_,NM:()=>l,i$:()=>g});var y=h(15861),v=h(14007),x=h(15182);class l{constructor(n){this.data=n,this.type="encoded-mesh-texture",this.encoding=x.Ti.KTX2_ENCODING}}function T(a){return"encoded-mesh-texture"===a?.type}function g(a){return u.apply(this,arguments)}function u(){return(u=(0,y.Z)(function*(a){const n=new Blob([a]),i=yield n.text();return JSON.parse(i)})).apply(this,arguments)}function _(a,n){return d.apply(this,arguments)}function d(){return(d=(0,y.Z)(function*(a,n){if(n===x.Ti.KTX2_ENCODING)return new l(a);const i=new Blob([a],{type:n}),f=URL.createObjectURL(i),m=new Image;if((0,v.Z)("esri-iPhone"))return new Promise((b,E)=>{const N=()=>{I(),b(m)},C=B=>{I(),E(B)},I=()=>{URL.revokeObjectURL(f),m.removeEventListener("load",N),m.removeEventListener("error",C)};m.addEventListener("load",N),m.addEventListener("error",C),m.src=f});try{m.src=f,yield m.decode()}catch{console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(f),m})).apply(this,arguments)}},71807:(P,R,h)=>{h.d(R,{Q:()=>me});var I,B,s,y=h(15861),v=h(4703),x=h(89568),l=h(39237),u=h(57964),_=h(8611),d=h(79412),a=h(6785),n=h(93960),i=h(60838),f=h(39215),m=h(7577),b=h(11716),E=h(33996);h(14007);class C{constructor(t){this._data=t,this._offset4=0,this._dataUint32=new Uint32Array(this._data,0,Math.floor(this._data.byteLength/4))}readUint32(){const t=this._offset4;return this._offset4+=1,this._dataUint32[t]}readUint8Array(t){const r=4*this._offset4;return this._offset4+=t/4,new Uint8Array(this._data,r,t)}remainingBytes(){return this._data.byteLength-4*this._offset4}}(s=I||(I={})).SCALAR="SCALAR",s.VEC2="VEC2",s.VEC3="VEC3",s.VEC4="VEC4",s.MAT2="MAT2",s.MAT3="MAT3",s.MAT4="MAT4",function(s){s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"}(B||(B={}));var j=h(480);const G={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},K={pbrMetallicRoughness:G,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},V={ESRI_externalColorMixMode:"tint"},Z=(s={})=>{const t={...G,...s.pbrMetallicRoughness},r=function $(s){switch(s.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:(0,j.Bg)(s.ESRI_externalColorMixMode),s.ESRI_externalColorMixMode="tint"}return s}({...V,...s.extras});return{...K,...s,pbrMetallicRoughness:t,extras:r}},W={magFilter:l.cw.LINEAR,minFilter:l.cw.LINEAR_MIPMAP_LINEAR,wrapS:l.e8.REPEAT,wrapT:l.e8.REPEAT};var z=h(65749);class U{constructor(t,r,o,e){if(this._context=t,this.uri=r,this.json=o,this._glbBuffer=e,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._supportedExtensions=["KHR_texture_basisu"],this._baseUri=function F(s){let t,r;return s.replace(/^(.*\/)?([^/]*)$/,(o,e,c)=>(t=e||"",r=c||"","")),{dirPart:t,filePart:r}}(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),null==o.scenes)throw new u.Z("gltf-loader-unsupported-feature","Scenes must be defined.");if(null==o.meshes)throw new u.Z("gltf-loader-unsupported-feature","Meshes must be defined");if(null==o.nodes)throw new u.Z("gltf-loader-unsupported-feature","Nodes must be defined.");this._computeNodeParents()}static load(t,r,o){var e=this;return(0,y.Z)(function*(){if((0,a.HK)(r)){const w=(0,a.sJ)(r);if(w&&"model/gltf-binary"!==w.mediaType)try{const M=JSON.parse(w.isBase64?atob(w.data):w.data);return new U(t,r,M)}catch{}const O=(0,a.AH)(r);if(U._isGLBData(O))return e._fromGLBData(t,r,O)}if(te.test(r)||"gltf"===o?.expectedType){const w=yield t.loadJSON(r,o);return new U(t,r,w)}const c=yield t.loadBinary(r,o);if(U._isGLBData(c))return e._fromGLBData(t,r,c);if(pe.test(r)||"glb"===o?.expectedType)throw new u.Z("gltf-loader-invalid-glb","This is not a valid glb file.");const p=yield t.loadJSON(r,o);return new U(t,r,p)})()}static _isGLBData(t){if(null==t)return!1;const r=new C(t);return r.remainingBytes()>=4&&1179937895===r.readUint32()}static _fromGLBData(t,r,o){return(0,y.Z)(function*(){const e=yield U._parseGLBData(o);return new U(t,r,e.json,e.binaryData)})()}static _parseGLBData(t){return(0,y.Z)(function*(){const r=new C(t);if(r.remainingBytes()<12)throw new u.Z("gltf-loader-error","glb binary data is insufficiently large.");const o=r.readUint32(),e=r.readUint32(),c=r.readUint32();if(1179937895!==o)throw new u.Z("gltf-loader-error","Magic first 4 bytes do not fit to expected glb value.");if(t.byteLength<c)throw new u.Z("gltf-loader-error","glb binary data is smaller than header specifies.");if(2!==e)throw new u.Z("gltf-loader-unsupported-feature","An unsupported glb container version was detected. Only version 2 is supported.");let p,w,O=0;for(;r.remainingBytes()>=8;){const M=r.readUint32(),A=r.readUint32();if(0===O){if(1313821514!==A)throw new u.Z("gltf-loader-error","First glb chunk must be JSON.");if(M<0)throw new u.Z("gltf-loader-error","No JSON data found.");p=yield(0,z.i$)(r.readUint8Array(M))}else if(1===O){if(5130562!==A)throw new u.Z("gltf-loader-unsupported-feature","Second glb chunk expected to be BIN.");w=r.readUint8Array(M)}else v.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] More than 2 glb chunks detected. Skipping.");O+=1}if(!p)throw new u.Z("gltf-loader-error","No glb JSON chunk detected.");return{json:p,binaryData:w}})()}getBuffer(t,r){var o=this;return(0,y.Z)(function*(){const e=o.json.buffers[t];if(null==e.uri){if(null==o._glbBuffer)throw new u.Z("gltf-loader-error","glb buffer not present");return o._glbBuffer}const c=yield o._getBufferLoader(t,r);if(c.byteLength!==e.byteLength)throw new u.Z("gltf-loader-error","Buffer byte lengths should match.");return c})()}_getBufferLoader(t,r){var o=this;return(0,y.Z)(function*(){const e=o._bufferLoaders.get(t);if(e)return e;const p=o._context.loadBinary(o._resolveUri(o.json.buffers[t].uri),r).then(w=>new Uint8Array(w));return o._bufferLoaders.set(t,p),p})()}getAccessor(t,r){var o=this;return(0,y.Z)(function*(){if(!o.json.accessors)throw new u.Z("gltf-loader-unsupported-feature","Accessors missing.");const e=o.json.accessors[t];if(null==e?.bufferView)throw new u.Z("gltf-loader-unsupported-feature","Some accessor does not specify a bufferView.");if(e.type in[I.MAT2,I.MAT3,I.MAT4])throw new u.Z("gltf-loader-unsupported-feature",`AttributeType ${e.type} is not supported`);const c=o.json.bufferViews[e.bufferView],p=yield o.getBuffer(c.buffer,r),w=Q[e.type],O=q[e.componentType],M=w*O,A=c.byteStride||M;return{raw:p.buffer,byteStride:A,byteOffset:p.byteOffset+(c.byteOffset||0)+(e.byteOffset||0),entryCount:e.count,isDenselyPacked:A===M,componentCount:w,componentByteSize:O,componentType:e.componentType,min:e.min,max:e.max,normalized:!!e.normalized}})()}getIndexData(t,r){var o=this;return(0,y.Z)(function*(){if(null==t.indices)return;const e=yield o.getAccessor(t.indices,r);if(e.isDenselyPacked)switch(e.componentType){case l.g.UNSIGNED_BYTE:return new Uint8Array(e.raw,e.byteOffset,e.entryCount);case l.g.UNSIGNED_SHORT:return new Uint16Array(e.raw,e.byteOffset,e.entryCount);case l.g.UNSIGNED_INT:return new Uint32Array(e.raw,e.byteOffset,e.entryCount)}else switch(e.componentType){case l.g.UNSIGNED_BYTE:return(0,E.m)(o._wrapAccessor(b.D_,e));case l.g.UNSIGNED_SHORT:return(0,E.m)(o._wrapAccessor(b.av,e));case l.g.UNSIGNED_INT:return(0,E.m)(o._wrapAccessor(b.Nu,e))}})()}getPositionData(t,r){var o=this;return(0,y.Z)(function*(){if(null==t.attributes.POSITION)throw new u.Z("gltf-loader-unsupported-feature","No POSITION vertex data found.");const e=yield o.getAccessor(t.attributes.POSITION,r);if(e.componentType!==l.g.FLOAT)throw new u.Z("gltf-loader-unsupported-feature","Expected type FLOAT for POSITION vertex attribute, but found "+l.g[e.componentType]);if(3!==e.componentCount)throw new u.Z("gltf-loader-unsupported-feature","POSITION vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return o._wrapAccessor(b.ct,e)})()}getNormalData(t,r){var o=this;return(0,y.Z)(function*(){if(null==t.attributes.NORMAL)throw new u.Z("gltf-loader-error","No NORMAL vertex data found.");const e=yield o.getAccessor(t.attributes.NORMAL,r);if(e.componentType!==l.g.FLOAT)throw new u.Z("gltf-loader-unsupported-feature","Expected type FLOAT for NORMAL vertex attribute, but found "+l.g[e.componentType]);if(3!==e.componentCount)throw new u.Z("gltf-loader-unsupported-feature","NORMAL vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return o._wrapAccessor(b.ct,e)})()}getTangentData(t,r){var o=this;return(0,y.Z)(function*(){if(null==t.attributes.TANGENT)throw new u.Z("gltf-loader-error","No TANGENT vertex data found.");const e=yield o.getAccessor(t.attributes.TANGENT,r);if(e.componentType!==l.g.FLOAT)throw new u.Z("gltf-loader-unsupported-feature","Expected type FLOAT for TANGENT vertex attribute, but found "+l.g[e.componentType]);if(4!==e.componentCount)throw new u.Z("gltf-loader-unsupported-feature","TANGENT vertex attribute must have 4 components, but found "+e.componentCount.toFixed());return new b.ek(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)})()}getTextureCoordinates(t,r){var o=this;return(0,y.Z)(function*(){if(null==t.attributes.TEXCOORD_0)throw new u.Z("gltf-loader-error","No TEXCOORD_0 vertex data found.");const e=yield o.getAccessor(t.attributes.TEXCOORD_0,r);if(2!==e.componentCount)throw new u.Z("gltf-loader-unsupported-feature","TEXCOORD_0 vertex attribute must have 2 components, but found "+e.componentCount.toFixed());if(e.componentType===l.g.FLOAT)return o._wrapAccessor(b.Eu,e);if(!e.normalized)throw new u.Z("gltf-loader-unsupported-feature","Integer component types are only supported for a normalized accessor for TEXCOORD_0.");return function ee(s){switch(s.componentType){case l.g.BYTE:return new b.Vs(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount);case l.g.UNSIGNED_BYTE:return new b.xA(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount);case l.g.SHORT:return new b.or(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount);case l.g.UNSIGNED_SHORT:return new b.TS(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount);case l.g.UNSIGNED_INT:return new b.qt(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount);case l.g.FLOAT:return new b.Eu(s.raw,s.byteOffset,s.byteStride,s.byteOffset+s.byteStride*s.entryCount)}}(e)})()}getVertexColors(t,r){var o=this;return(0,y.Z)(function*(){if(null==t.attributes.COLOR_0)throw new u.Z("gltf-loader-error","No COLOR_0 vertex data found.");const e=yield o.getAccessor(t.attributes.COLOR_0,r);if(4!==e.componentCount&&3!==e.componentCount)throw new u.Z("gltf-loader-unsupported-feature","COLOR_0 attribute must have 3 or 4 components, but found "+e.componentCount.toFixed());if(4===e.componentCount){if(e.componentType===l.g.FLOAT)return o._wrapAccessor(b.ek,e);if(e.componentType===l.g.UNSIGNED_BYTE)return o._wrapAccessor(b.mc,e);if(e.componentType===l.g.UNSIGNED_SHORT)return o._wrapAccessor(b.v6,e)}else if(3===e.componentCount){if(e.componentType===l.g.FLOAT)return o._wrapAccessor(b.ct,e);if(e.componentType===l.g.UNSIGNED_BYTE)return o._wrapAccessor(b.ne,e);if(e.componentType===l.g.UNSIGNED_SHORT)return o._wrapAccessor(b.mw,e)}throw new u.Z("gltf-loader-unsupported-feature","Unsupported component type for COLOR_0 attribute: "+l.g[e.componentType])})()}hasPositions(t){return void 0!==t.attributes.POSITION}hasNormals(t){return void 0!==t.attributes.NORMAL}hasVertexColors(t){return void 0!==t.attributes.COLOR_0}hasTextureCoordinates(t){return void 0!==t.attributes.TEXCOORD_0}hasTangents(t){return void 0!==t.attributes.TANGENT}getMaterial(t,r,o){var e=this;return(0,y.Z)(function*(){let c=t.material?e._materialCache.get(t.material):void 0;if(!c){const p=null!=t.material?Z(e.json.materials[t.material]):Z(),w=p.pbrMetallicRoughness,O=e.hasVertexColors(t),M=e.getTexture(w.baseColorTexture,r),A=e.getTexture(p.normalTexture,r),S=o?e.getTexture(p.occlusionTexture,r):void 0,L=o?e.getTexture(p.emissiveTexture,r):void 0,D=o?e.getTexture(w.metallicRoughnessTexture,r):void 0,re=null!=t.material?t.material:-1;c={alphaMode:p.alphaMode,alphaCutoff:p.alphaCutoff,color:w.baseColorFactor,doubleSided:!!p.doubleSided,colorTexture:yield M,normalTexture:yield A,name:p.name,id:re,occlusionTexture:yield S,emissiveTexture:yield L,emissiveFactor:p.emissiveFactor,metallicFactor:w.metallicFactor,roughnessFactor:w.roughnessFactor,metallicRoughnessTexture:yield D,hasVertexColors:O,ESRI_externalColorMixMode:p.extras.ESRI_externalColorMixMode,colorTextureTransform:w?.baseColorTexture?.extensions?.KHR_texture_transform,normalTextureTransform:p.normalTexture?.extensions?.KHR_texture_transform,occlusionTextureTransform:p.occlusionTexture?.extensions?.KHR_texture_transform,emissiveTextureTransform:p.emissiveTexture?.extensions?.KHR_texture_transform,metallicRoughnessTextureTransform:w?.metallicRoughnessTexture?.extensions?.KHR_texture_transform}}return c})()}getTexture(t,r){var o=this;return(0,y.Z)(function*(){if(!t)return;if(0!==(t.texCoord||0))throw new u.Z("gltf-loader-unsupported-feature","Only TEXCOORD with index 0 is supported.");const e=t.index,c=o.json.textures[e],p=(s=>({...W,...s}))(null!=c.sampler?o.json.samplers[c.sampler]:{}),w=o._getTextureSourceId(c),O=o.json.images[w],M=yield o._loadTextureImageData(e,c,r);return(0,_.s1)(o._textureCache,e,()=>{const A=L=>33071===L||33648===L||10497===L,S=L=>{throw new u.Z("gltf-loader-error",`Unexpected TextureSampler WrapMode: ${L}`)};return{data:M,wrapS:A(p.wrapS)?p.wrapS:S(p.wrapS),wrapT:A(p.wrapT)?p.wrapT:S(p.wrapT),minFilter:p.minFilter,name:O.name,id:e}})})()}getNodeTransform(t){if(void 0===t)return J;let r=this._nodeTransformCache.get(t);if(!r){const o=this.getNodeTransform(this._getNodeParent(t)),e=this.json.nodes[t];e.matrix?r=(0,i.m)((0,x.a)(),o,e.matrix):e.translation||e.rotation||e.scale?(r=(0,x.b)(o),e.translation&&(0,i.w)(r,r,e.translation),e.rotation&&(k[3]=(0,f.g)(k,e.rotation),(0,i.k)(r,r,k[3],k)),e.scale&&(0,i.b)(r,r,e.scale)):r=(0,x.b)(o),this._nodeTransformCache.set(t,r)}return r}_wrapAccessor(t,r){return new t(r.raw,r.byteOffset,r.byteStride,r.byteOffset+r.byteStride*(r.entryCount-1)+r.componentByteSize*r.componentCount)}_resolveUri(t){return(0,a.hF)(t,this._baseUri)}_getNodeParent(t){return this._nodeParentMap.get(t)}_checkVersionSupported(){const t=n.G.parse(this.json.asset.version,"glTF");Y.validate(t)}_checkRequiredExtensionsSupported(){const t=this.json;if(t.extensionsRequired&&!t.extensionsRequired.every(r=>this._supportedExtensions.includes(r)))throw new u.Z("gltf-loader-unsupported-feature","gltf loader was not able to load unsupported feature. Required extensions: "+t.extensionsRequired.join(", "))}_computeNodeParents(){this.json.nodes.forEach((t,r)=>{t.children&&t.children.forEach(o=>{this._nodeParentMap.set(o,r)})})}_loadTextureImageData(t,r,o){var e=this;return(0,y.Z)(function*(){const c=e._textureLoaders.get(t);if(c)return c;const p=e._createTextureLoader(r,o);return e._textureLoaders.set(t,p),p})()}_getTextureSourceId(t){if(void 0!==t.extensions&&null!==t.extensions.KHR_texture_basisu)return t.extensions.KHR_texture_basisu.source;if(null!==t.source)return t.source;throw new u.Z("gltf-loader-unsupported-feature","Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.")}_createTextureLoader(t,r){var o=this;return(0,y.Z)(function*(){const e=o._getTextureSourceId(t),c=o.json.images[e];if(c.uri){if(c.uri.endsWith(".ktx2")){const M=yield o._context.loadBinary(o._resolveUri(c.uri),r);return new z.NM(new Uint8Array(M))}return o._context.loadImage(o._resolveUri(c.uri),r)}if(null==c.bufferView)throw new u.Z("gltf-loader-unsupported-feature","Image bufferView must be defined.");if(null==c.mimeType)throw new u.Z("gltf-loader-unsupported-feature","Image mimeType must be defined.");const p=o.json.bufferViews[c.bufferView],w=yield o.getBuffer(p.buffer,r);if(null!=p.byteStride)throw new u.Z("gltf-loader-unsupported-feature","byteStride not supported for image buffer");return(0,z.Ml)(new Uint8Array(w.buffer,w.byteOffset+(p.byteOffset||0),p.byteLength),c.mimeType)})()}getLoadedBuffersSize(){var t=this;return(0,y.Z)(function*(){if(t._glbBuffer)return t._glbBuffer.byteLength;const r=yield(0,d.OT)(Array.from(t._bufferLoaders.values())),o=yield(0,d.OT)(Array.from(t._textureLoaders.values()));return r.reduce((e,c)=>e+(c?.byteLength??0),0)+o.reduce((e,c)=>e+(c?(0,z.$A)(c)?c.data.byteLength:c.width*c.height*4:0),0)})()}}const J=(0,i.A)((0,x.a)(),Math.PI/2),Y=new n.G(2,0,"glTF"),k=(0,m.a)(),Q={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},q={[l.g.BYTE]:1,[l.g.UNSIGNED_BYTE]:1,[l.g.SHORT]:2,[l.g.UNSIGNED_SHORT]:2,[l.g.FLOAT]:4,[l.g.INT]:4,[l.g.UNSIGNED_INT]:4},te=/\.gltf$/i,pe=/\.glb$/i;let _e=0;function me(s,t){return oe.apply(this,arguments)}function oe(){return oe=(0,y.Z)(function*(s,t,r={},o=!0){const e=yield U.load(s,t,r),c="gltf_"+_e++,p={lods:[],materials:new Map,textures:new Map,meta:he(e)},w=!(!e.json.asset.extras||"symbolResource"!==e.json.asset.extras.ESRI_type),O=new Map;yield function ye(s,t){return se.apply(this,arguments)}(e,function(){var A=(0,y.Z)(function*(S,L,D,re){const ae=O.get(D)??0;O.set(D,ae+1);const ne=void 0!==S.mode?S.mode:l.MX.TRIANGLES,ue=ne===l.MX.TRIANGLES||ne===l.MX.TRIANGLE_STRIP||ne===l.MX.TRIANGLE_FAN?ne:null;if(null==ue)return void v.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Unsupported primitive mode ("+l.MX[ne]+"). Skipping primitive.");if(!e.hasPositions(S))return void v.Z.getLogger("esri.views.3d.glTF").warn("Skipping primitive without POSITION vertex attribute.");const we=e.getPositionData(S,r),xe=e.getMaterial(S,r,o),ie=e.hasNormals(S)?e.getNormalData(S,r):null,le=e.hasTangents(S)?e.getTangentData(S,r):null,ce=e.hasTextureCoordinates(S)?e.getTextureCoordinates(S,r):null,fe=e.hasVertexColors(S)?e.getVertexColors(S,r):null,Ee=e.getIndexData(S,r),ve={name:re,transform:(0,x.b)(L),attributes:{position:yield we,normal:ie?yield ie:null,texCoord0:ce?yield ce:null,color:fe?yield fe:null,tangent:le?yield le:null},indices:yield Ee,primitiveType:ue,material:Te(p,yield xe,c)};let de=null;null!=p.meta?.ESRI_lod&&"screenSpaceRadius"===p.meta.ESRI_lod.metric&&(de=p.meta.ESRI_lod.thresholds[D]),p.lods[D]=p.lods[D]||{parts:[],name:re,lodThreshold:de},p.lods[D].parts[ae]=ve});return function(S,L,D,re){return A.apply(this,arguments)}}());for(const A of p.lods)A.parts=A.parts.filter(S=>!!S);const M=yield e.getLoadedBuffersSize();return{model:p,meta:{isEsriSymbolResource:w,uri:e.uri},customMeta:{},size:M}}),oe.apply(this,arguments)}function he(s){let r=null;return s.json.nodes.forEach(o=>{const e=o.extras;null!=e&&(e.ESRI_proxyEllipsoid||e.ESRI_lod)&&(r=e)}),r}function se(){return se=(0,y.Z)(function*(s,t){const r=s.json,o=r.scenes[r.scene||0].nodes,e=o.length>1,c=[];for(const O of o){const M=r.nodes[O];c.push(p(O,0)),ge(M)&&!e&&M.extensions.MSFT_lod.ids.forEach((A,S)=>p(A,S+1))}function p(O,M){return w.apply(this,arguments)}function w(){return(w=(0,y.Z)(function*(O,M){const A=r.nodes[O],S=s.getNodeTransform(O);if(null!=A.weights&&v.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Morph targets are not supported."),null!=A.mesh){const L=r.meshes[A.mesh];for(const D of L.primitives)c.push(t(D,S,M,L.name))}for(const L of A.children||[])c.push(p(L,M))})).apply(this,arguments)}yield Promise.all(c)}),se.apply(this,arguments)}function ge(s){return s.extensions?.MSFT_lod&&Array.isArray(s.extensions.MSFT_lod.ids)}function Te(s,t,r){const o=c=>{const p=`${r}_tex_${c&&c.id}${c?.name?"_"+c.name:""}`;if(c&&!s.textures.has(p)){const w=function g(s,t={}){return{data:s,parameters:{wrap:{s:l.e8.REPEAT,t:l.e8.REPEAT,...t.wrap},noUnpackFlip:!0,mipmap:!1,...t}}}(c.data,{wrap:{s:c.wrapS,t:c.wrapT},mipmap:be.has(c.minFilter),noUnpackFlip:!0});s.textures.set(p,w)}return p},e=`${r}_mat_${t.id}_${t.name}`;if(!s.materials.has(e)){const c=function T(s={}){return{color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,colorTextureTransform:null,normalTextureTransform:null,occlusionTextureTransform:null,emissiveTextureTransform:null,metallicRoughnessTextureTransform:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply",...s}}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?o(t.colorTexture):void 0,textureNormal:t.normalTexture?o(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?o(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?o(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?o(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],colorTextureTransform:t.colorTextureTransform,normalTextureTransform:t.normalTextureTransform,occlusionTextureTransform:t.occlusionTextureTransform,emissiveTextureTransform:t.emissiveTextureTransform,metallicRoughnessTextureTransform:t.metallicRoughnessTextureTransform,metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor});s.materials.set(e,c)}return e}const be=new Set([l.cw.LINEAR_MIPMAP_LINEAR,l.cw.LINEAR_MIPMAP_NEAREST])},77891:(P,R,h)=>{h.d(R,{j:()=>y});const y=2.1}}]);