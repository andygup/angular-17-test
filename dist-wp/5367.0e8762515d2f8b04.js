"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[5367],{15367:(X,H,w)=>{w.d(H,{Z:()=>C});var m=w(15861),I=w(18722),p=w(70930),R=w(95418),k=w(58446),A=w(76961),O=w(23686);class C extends R.Z{constructor(g){super(g),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=g.relationString,this._parent=g.parentfeatureset,this._maxProcessing=40,this._relation=g.relation,this._relationGeom=g.relationGeom}_getSet(g){var h=this;return(0,m.Z)(function*(){if(null===h._wset){yield h._ensureLoaded();const Z=yield h._parent._getFilteredSet("esriSpatialRelRelation"!==h._relation?h._relation:h._relation+":"+h._relationString,h._relationGeom,null,null,g);return h._checkCancelled(g),h._wset=new k.Z(Z._candidates.slice(0),Z._known.slice(0),Z._ordered,h._clonePageDefinition(Z.pagesDefinition)),h._wset}return h._wset})()}_isInFeatureSet(g){let h=this._parent._isInFeatureSet(g);return h===A.dj.NotInFeatureSet?h:(h=this._idstates[g],void 0===h?A.dj.Unknown:h)}_getFeature(g,h,Z){return this._parent._getFeature(g,h,Z)}_getFeatures(g,h,Z,E){return this._parent._getFeatures(g,h,Z,E)}_featureFromCache(g){return this._parent._featureFromCache(g)}executeSpatialRelationTest(g){var h=this;return(0,m.Z)(function*(){if(null===g.geometry)return!1;switch(h._relation){case"esriSpatialRelEnvelopeIntersects":return(0,O.kK)((0,A.SV)(h._relationGeom),(0,A.SV)(g.geometry));case"esriSpatialRelIntersects":return(0,O.kK)(h._relationGeom,g.geometry);case"esriSpatialRelContains":return(0,O.r3)(h._relationGeom,g.geometry);case"esriSpatialRelOverlaps":return(0,O.Nm)(h._relationGeom,g.geometry);case"esriSpatialRelWithin":return(0,O.uh)(h._relationGeom,g.geometry);case"esriSpatialRelTouches":return(0,O.W4)(h._relationGeom,g.geometry);case"esriSpatialRelCrosses":return(0,O.jU)(h._relationGeom,g.geometry);case"esriSpatialRelRelation":return(0,O.LV)(h._relationGeom,g.geometry,h._relationString??"")}})()}_fetchAndRefineFeatures(g,h,Z){var E=this;return(0,m.Z)(function*(){const j=new k.Z([],g,!1,null),v=Math.min(h,g.length);yield E._parent?._getFeatures(j,-1,v,Z),E._checkCancelled(Z);const T=[];for(let e=0;e<v;e++){const n=E._parent._featureFromCache(g[e]);T.push(yield E.executeSpatialRelationTest(n))}for(let e=0;e<h;e++)E._idstates[g[e]]=!0===T[e]?A.dj.InFeatureSet:A.dj.NotInFeatureSet;return"success"})()}_getFilteredSet(g,h,Z,E,j){var v=this;return(0,m.Z)(function*(){yield v._ensureLoaded();const T=yield v._parent._getFilteredSet("esriSpatialRelRelation"!==v._relation?v._relation:v._relation+":"+v._relationString,v._relationGeom,Z,E,j);let e;return v._checkCancelled(j),e=null!==h?new k.Z(T._candidates.slice(0).concat(T._known.slice(0)),[],T._ordered,v._clonePageDefinition(T.pagesDefinition)):new k.Z(T._candidates.slice(0),T._known.slice(0),T._ordered,v._clonePageDefinition(T.pagesDefinition)),e})()}_stat(g,h,Z,E,j,v,T){var e=this;return(0,m.Z)(function*(){if(""!==Z)return{calculated:!1};const n=yield e._parent._stat(g,h,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,j,v,T);return!1===n.calculated?null===j&&""===Z&&null===E?e._manualStat(g,h,v,T):{calculated:!1}:n})()}_canDoAggregates(g,h,Z,E,j){var v=this;return(0,m.Z)(function*(){return""===Z&&null===E&&null!==v._parent&&v._parent._canDoAggregates(g,h,"esriSpatialRelRelation"!==v._relation?v._relation:v._relation+":"+v._relationString,v._relationGeom,j)})()}_getAggregatePagesDataSourceDefinition(g,h,Z,E,j,v,T){var e=this;return(0,m.Z)(function*(){if(null===e._parent)throw new p.EN(p.H9.NeverReach);return e._parent._getAggregatePagesDataSourceDefinition(g,h,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,j,v,T)})()}static registerAction(){R.Z._featuresetFunctions.intersects=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:g})},R.Z._featuresetFunctions.envelopeIntersects=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:g})},R.Z._featuresetFunctions.contains=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:g})},R.Z._featuresetFunctions.overlaps=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:g})},R.Z._featuresetFunctions.within=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:g})},R.Z._featuresetFunctions.touches=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:g})},R.Z._featuresetFunctions.crosses=function(g){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:g})},R.Z._featuresetFunctions.relate=function(g,h){return null==g?new I.Z({parentfeatureset:this}):new C({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:g,relationString:h})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}},18722:(X,H,w)=>{w.d(H,{Z:()=>A});var m=w(15861),I=w(70930),p=w(95418),R=w(58446),k=w(76961);class A extends p.Z{constructor(C){super(C),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new R.Z([],[],!1,null),this._parent=C.parentfeatureset,this._databaseType=k.Bj.Standardised}_getSet(){var C=this;return(0,m.Z)(function*(){return C._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return k.dj.NotInFeatureSet}_getFeature(){return(0,m.Z)(function*(){throw new I.EN(I.H9.NeverReach)})()}queryAttachments(){return(0,m.Z)(function*(){return[]})()}_getFeatures(){return(0,m.Z)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,m.Z)(function*(){throw new I.EN(I.H9.NeverReach)})()}_getFilteredSet(){return(0,m.Z)(function*(){return new R.Z([],[],!1,null)})()}_stat(C,J,g,h,Z,E,j){return this._manualStat(C,J,E,j)}_canDoAggregates(){return(0,m.Z)(function*(){return!1})()}}},95418:(X,H,w)=>{w.d(H,{Z:()=>j});var m=w(15861),I=w(19104),p=w(70930),R=w(860);class k{constructor(T,e){this._lastId=-1,this._progress=e,this._parent=T}reset(){this._lastId=-1}nextBatchAsArcadeFeatures(T,e){var n=this;return(0,m.Z)(function*(){const s=yield n.nextBatch(T);return null===s?s:s.map(r=>R.Z.createFromGraphicLikeObject(r.geometry,r.attributes,n._parent,e))})()}nextBatch(T){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(s=>this.nextBatch(T),s=>this.nextBatch(T));const e={returnpromise:null,hasset:!1},n=[];return e.returnpromise=new Promise((s,r)=>{this._parent._getSet(this._progress).then(o=>{const c=o._known;let D=c.length-1;if("GETPAGES"===c[c.length-1]&&(D-=1),this._lastId+T>D&&c.length>0&&"GETPAGES"===c[c.length-1])this._parent._expandPagedSet(o,this._parent._maxQueryRate(),0,0,this._progress).then(L=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(T).then(s,r)},L=>{e.hasset=!0,this._parent._mainSetInUse=null,r(L)});else{if(D>=this._lastId+T||0===o._candidates.length){for(let L=0;L<T;L++){const Y=L+this._lastId+1;if(Y>=c.length)break;n[L]=c[Y]}return this._lastId+=n.length,0===n.length&&(e.hasset=!0,this._parent._mainSetInUse=null,s([])),void this._parent._getFeatureBatch(n,this._progress).then(L=>{e.hasset=!0,this._parent._mainSetInUse=null,s(L)},L=>{e.hasset=!0,this._parent._mainSetInUse=null,r(L)})}this._parent._refineSetBlock(o,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(T).then(s,r)},L=>{e.hasset=!0,this._parent._mainSetInUse=null,r(L)})}},o=>{e.hasset=!0,this._parent._mainSetInUse=null,r(o)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(e=>this.next(),e=>this.next());const T={returnpromise:null,hasset:!1};return T.returnpromise=new Promise((e,n)=>{this._parent._getSet(this._progress).then(s=>{const r=s._known;this._lastId<r.length-1?"GETPAGES"===r[this._lastId+1]?this._parent._expandPagedSet(s,this._parent._maxQueryRate(),0,0,this._progress).then(o=>(T.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(e,n):(this._lastId+=1,this._parent._getFeature(s,r[this._lastId],this._progress).then(o=>{T.hasset=!0,this._parent._mainSetInUse=null,e(o)},o=>{T.hasset=!0,this._parent._mainSetInUse=null,n(o)})):s._candidates.length>0?this._parent._refineSetBlock(s,this._parent._maxProcessingRate(),this._progress).then(()=>{T.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,n)},o=>{T.hasset=!0,this._parent._mainSetInUse=null,n(o)}):(T.hasset=!0,this._parent._mainSetInUse=null,e(null))},s=>{T.hasset=!0,this._parent._mainSetInUse=null,n(s)})}),!1===T.hasset&&(this._parent._mainSetInUse=T.returnpromise,T.hasset=!0),T.returnpromise}count(){var T=this;return(0,m.Z)(function*(){if(-1!==T._parent._totalCount)return T._parent._totalCount;const e=yield T._parent._getSet(T._progress),n=yield T._refineAllSets(e);return T._parent._totalCount=n._known.length,T._parent._totalCount})()}_refineAllSets(T){var e=this;return(0,m.Z)(function*(){if(T._known.length>0&&"GETPAGES"===T._known[T._known.length-1])return yield e._parent._expandPagedSet(T,e._parent._maxQueryRate(),0,1,e._progress),e._refineAllSets(T);if(T._candidates.length>0){if("GETPAGES"===T._known[T._candidates.length-1])return yield e._parent._expandPagedSet(T,e._parent._maxQueryRate(),0,2,e._progress),e._refineAllSets(T);const n=yield e._parent._refineSetBlock(T,e._parent._maxProcessingRate(),e._progress);return n._candidates.length>0?e._refineAllSets(n):n}return T})()}}var A=w(58446),O=w(76961),C=w(80389),J=w(79412),g=w(85904),h=w(23686),Z=w(43814),E=w(40100);let j=(()=>{class v{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=O.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.typeIdField=null,this.types=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,this.fsetInfo=null,e?.lrucache&&(this.recentlyUsedQueries=e.lrucache),e?.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,n){return void 0===n?this[e]:(void 0!==this[e]&&(this[e]=n),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,m.Z)(function*(){return!0===e._parent?.loaded?(e._initialiseFeatureSet(),e):(yield e._parent?.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.fields=[],this.typeIdField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new Z.Z({wkid:4326}),this.geometryType=O.Qk.point)}getField(e,n){let s;return(n=n||this.fields)&&(e=e.toLowerCase(),n.some(r=>(r&&r.name.toLowerCase()===e&&(s=r),!!s))),s}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=E.Z.fromLayer({timeInfo:this.timeInfo,editFieldsInfo:this.editFieldsInfo,dateFieldsTimeZone:this.dateFieldsTimeZone,datesInUnknownTimezone:this.datesInUnknownTimezone,fields:this.fields})),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new p.EN(p.H9.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,n,s,r,o){var c=this;return(0,m.Z)(function*(){return null!==c._parent&&c._parent._canDoAggregates(e,n,s,r,o)})()}_getAggregatePagesDataSourceDefinition(e,n,s,r,o,c,D){var x=this;return(0,m.Z)(function*(){if(null===x._parent)throw new p.EN(p.H9.NeverReach);return x._parent._getAggregatePagesDataSourceDefinition(e,n,s,r,o,c,D)})()}_getAgregagtePhysicalPage(e,n,s){var r=this;return(0,m.Z)(function*(){if(null===r._parent)throw new p.EN(p.H9.NeverReach);return r._parent._getAgregagtePhysicalPage(e,n,s)})()}databaseType(){var e=this;return(0,m.Z)(function*(){if(e._databaseType===O.Bj.NotEvaluated){if(null!==I.Z.applicationCache){const n=I.Z.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==n)return n}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==I.Z.applicationCache&&I.Z.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(n){throw null!==I.Z.applicationCache&&I.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),n}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,m.Z)(function*(){const n=[{thetype:O.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:O.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:O.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const s of n)if(!0===(yield e._runDatabaseProbe(s.testwhere)))return s.thetype;return O.Bj.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var n=this;return(0,m.Z)(function*(){if(null!==n._parent)return n._parent._runDatabaseProbe(e);throw new p.EN(p.H9.NotImplemented)})()}isTable(){return this._parent?.isTable()??!1}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return O.dj.Unknown}_getSet(e){throw new p.EN(p.H9.NotImplemented)}_getFeature(e,n,s){var r=this;return(0,m.Z)(function*(){if(r._checkCancelled(s),void 0!==r._featureFromCache(n)||(yield r._getFeatures(e,n,r._maxProcessingRate(),s),r._checkCancelled(s),void 0!==r._featureFromCache(n)))return r._featureFromCache(n);throw new p.EN(p.H9.MissingFeatures)})()}_getFeatureBatch(e,n){var s=this;return(0,m.Z)(function*(){s._checkCancelled(n);const r=new A.Z([],e,!1,null),o=[];yield s._getFeatures(r,-1,e.length,n),s._checkCancelled(n);for(const c of e)void 0!==s._featureFromCache(c)&&o.push(s._featureFromCache(c));return o})()}_getFeatures(e,n,s,r){return(0,m.Z)(function*(){return"success"})()}_getFilteredSet(e,n,s,r,o){throw new p.EN(p.H9.NotImplemented)}_refineSetBlock(e,n,s){var r=this;return(0,m.Z)(function*(){if(!0===r._checkIfNeedToExpandCandidatePage(e,r._maxQueryRate()))return yield r._expandPagedSet(e,r._maxQueryRate(),0,0,s),r._refineSetBlock(e,n,s);r._checkCancelled(s);const o=e._candidates.length;r._refineKnowns(e,n);let c=o-e._candidates.length;if(0===e._candidates.length||c>=n)return e;if(yield r._refineIfParentKnown(e,n-c,s),r._checkCancelled(s),r._refineKnowns(e,n-c),c=o-e._candidates.length,c<n&&e._candidates.length>0){const D=n-c,x=r._prepareFetchAndRefineSet(e._candidates);return yield r._fetchAndRefineFeatures(x,x.length>D?D:e._candidates.length,s),r._checkCancelled(s),r._refineKnowns(e,n-c),e}return e})()}_fetchAndRefineFeatures(e,n,s){return null}_prepareFetchAndRefineSet(e){const n=[];for(let s=0;s<e.length;s++)this._isPhysicalFeature(e[s])&&n.push(e[s]);return n}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,n){let s=0,r=null;const o=[];n=this._maxQueryRate();for(let c=0;c<e._candidates.length&&"GETPAGES"!==e._candidates[c];c++){let D=!1;const x=this._candidateIdTransform(e._candidates[c]);x!==e._candidates[c]&&(D=!0);const L=this._isInFeatureSet(x);if(L===O.dj.InFeatureSet)!0===D?e._known.includes(x)||(e._known.push(x),s+=1):(e._known.push(e._candidates[c]),s+=1),null===r?r={start:c,end:c}:r.end===c-1?r.end=c:(o.push(r),r={start:c,end:c});else if(L===O.dj.NotInFeatureSet)null===r?r={start:c,end:c}:r.end===c-1?r.end=c:(o.push(r),r={start:c,end:c}),s+=1;else if(L===O.dj.Unknown&&(s+=1,!0===e._ordered))break;if(s>=n)break}null!==r&&o.push(r);for(let c=o.length-1;c>=0;c--)e._candidates.splice(o[c].start,o[c].end-o[c].start+1)}_refineIfParentKnown(e,n,s){const r=new A.Z([],[],e._ordered,null);return r._candidates=e._candidates.slice(0),this._parent._refineSetBlock(r,n,s)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,n){if(null===e.pagesDefinition)return!1;let s=0;for(let r=e._lastFetchedIndex;r<e._known.length;r++){if("GETPAGES"===e._known[r])return!0;if(void 0===this._featureCache[e._known[r]]&&(s+=1,s>=n))break}return!1}_checkIfNeedToExpandCandidatePage(e,n){if(null===e.pagesDefinition)return!1;let s=0;for(let r=0;r<e._candidates.length;r++){if("GETPAGES"===e._candidates[r])return!0;if(s+=1,s>=n)break}return!1}_expandPagedSet(e,n,s,r,o){var c=this;return(0,m.Z)(function*(){if(null===c._parent)throw new p.EN(p.H9.NotImplemented);return c._parent._expandPagedSet(e,n,s,r,o)})()}_expandPagedSetFeatureSet(e,n,s,r,o){var c=this;return(0,m.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(r=1),0===r&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(r=2),0===r)return"finished";const D=yield c._getPage(e,r,o);return s+D<n?c._expandPagedSet(e,n,s+D,0,o):"success"})()}_getPage(e,n,s){var r=this;return(0,m.Z)(function*(){const o=1===n?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){o.length=o.length-1;let c=0;for(let x=0;x<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+x>=e.pagesDefinition.internal.set.length);x++)o[o.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+x],c++;e.pagesDefinition.resultOffset+=c;let D=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(D=!0),!1===D&&o.push("GETPAGES"),c}return yield r._getPhysicalPage(e,n,s),r._getPage(e,n,s)})()}_getPhysicalPage(e,n,s){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,n,s,r){var o=this;return(0,m.Z)(function*(){yield o._ensureLoaded();let c=yield o._stat(e,n,"",null,null,s,r);return!1===c.calculated&&(c=yield o._manualStat(e,n,s,r)),c.result})()}_manualStat(e,n,s,r){var o=this;return(0,m.Z)(function*(){let c=null;switch(e.toLowerCase()){case"count":return c=yield(0,C.QX)(o,r),{calculated:!0,result:c};case"distinct":return c=yield(0,C.EB)(o,n,s,r),{calculated:!0,result:c};case"avg":case"mean":return c=yield(0,C.J6)(o,n,r),{calculated:!0,result:c};case"stdev":return c=yield(0,C.m)(o,n,r),{calculated:!0,result:c};case"variance":return c=yield(0,C.CA)(o,n,r),{calculated:!0,result:c};case"sum":return c=yield(0,C.Sm)(o,n,r),{calculated:!0,result:c};case"min":return c=yield(0,C.VV)(o,n,r),{calculated:!0,result:c};case"max":return c=yield(0,C.Fp)(o,n,r),{calculated:!0,result:c};default:return{calculated:!0,result:0}}})()}_stat(e,n,s,r,o,c,D){var x=this;return(0,m.Z)(function*(){const L=yield x._parent._stat(e,n,s,r,o,c,D);return!1===L.calculated?null===o&&""===s&&null===r?x._manualStat(e,n,c,D):{calculated:!1}:L})()}_unionAllGeomSelf(e){const n=this.iterator(this._defaultTracker(e)),s=[];return new Promise((r,o)=>{this._unionShapeInBatches(s,n,r,o)})}_unionAllGeom(e){return new Promise((n,s)=>{const r=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],r,n,s)})}_unionShapeInBatches(e,n,s,r){n.next().then(o=>{try{null!==o&&null!==o.geometry&&e.push(o.geometry),e.length>30||null===o&&e.length>1?(0,h.G0)(e).then(c=>{try{null===o?s(c):this._unionShapeInBatches(e=[c],n,s,r)}catch(D){r(D)}},r):null===o?s(1===e.length?e[0]:null):this._unionShapeInBatches(e,n,s,r)}catch(c){r(c)}},r)}iterator(e){return new k(this,e)}intersection(e,n=!1){return v._featuresetFunctions.intersection.bind(this)(e,n)}difference(e,n=!1,s=!0){return v._featuresetFunctions.difference.bind(this)(e,n,s)}symmetricDifference(e,n=!1,s=!0){return v._featuresetFunctions.symmetricDifference.bind(this)(e,n,s)}morphShape(e,n,s="unknown",r=null){return v._featuresetFunctions.morphShape.bind(this)(e,n,s,r)}morphShapeAndAttributes(e,n,s="unknown"){return v._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,n,s)}union(e,n=!1){return v._featuresetFunctions.union.bind(this)(e,n)}intersects(e){return v._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return v._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return v._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return v._featuresetFunctions.overlaps.bind(this)(e)}relate(e,n){return v._featuresetFunctions.relate.bind(this)(e,n)}within(e){return v._featuresetFunctions.within.bind(this)(e)}touches(e){return v._featuresetFunctions.touches.bind(this)(e)}top(e){return v._featuresetFunctions.top.bind(this)(e)}crosses(e){return v._featuresetFunctions.crosses.bind(this)(e)}buffer(e,n,s,r=!0){return v._featuresetFunctions.buffer.bind(this)(e,n,s,r)}filter(e,n=null){return v._featuresetFunctions.filter.bind(this)(e,n)}orderBy(e){return v._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,n){return v._featuresetFunctions.dissolve.bind(this)(e,n)}groupby(e,n){return v._featuresetFunctions.groupby.bind(this)(e,n)}reduce(e,n=null,s){return new Promise((r,o)=>{this._reduceImpl(this.iterator(this._defaultTracker(s)),e,n,0,r,o,0)})}_reduceImpl(e,n,s,r,o,c,D){try{if(++D>1e3)return void setTimeout(()=>{this._reduceImpl(e,n,s,r,o,c,D=0)});e.next().then(x=>{try{if(null===x)o(s);else{const L=n(s,x,r,this);(0,J.y8)(L)?L.then(Y=>{this._reduceImpl(e,n,Y,r+1,o,c,D)},c):this._reduceImpl(e,n,L,r+1,o,c,D)}}catch(L){c(L)}},c)}catch(x){c(x)}}removeField(e){return v._featuresetFunctions.removeField.bind(this)(e)}addField(e,n,s=null){return v._featuresetFunctions.addField.bind(this)(e,n,s)}sumArea(e,n=!1,s){const r=(0,O.EI)(e);return this.reduce((o,c)=>null===c.geometry?0:n?(0,h.Y4)(c.geometry,r).then(D=>o+D):(0,h.CJ)(c.geometry,r).then(D=>o+D),0,s)}sumLength(e,n=!1,s){const r=(0,O.Lz)(e);return this.reduce((o,c)=>null===c.geometry?0:n?(0,h.kQ)(c.geometry,r).then(D=>o+D):(0,h.sz)(c.geometry,r).then(D=>o+D),0,s)}_substituteVars(e,n){if(null!==n){const s={};for(const r in n)s[r.toLowerCase()]=n[r];e.parameters=s}}distinct(e,n=1e3,s=null,r){var o=this;return(0,m.Z)(function*(){yield o.load();const c=g.WhereClause.create(e,o.getFieldsIndex(),o.dateFieldsTimeZoneDefaultUTC);return o._substituteVars(c,s),o.calculateStatistic("distinct",c,n,o._defaultTracker(r))})()}min(e,n=null,s){var r=this;return(0,m.Z)(function*(){yield r.load();const o=g.WhereClause.create(e,r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC);return r._substituteVars(o,n),r.calculateStatistic("min",o,-1,r._defaultTracker(s))})()}max(e,n=null,s){var r=this;return(0,m.Z)(function*(){yield r.load();const o=g.WhereClause.create(e,r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC);return r._substituteVars(o,n),r.calculateStatistic("max",o,-1,r._defaultTracker(s))})()}avg(e,n=null,s){var r=this;return(0,m.Z)(function*(){yield r.load();const o=g.WhereClause.create(e,r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC);return r._substituteVars(o,n),r.calculateStatistic("avg",o,-1,r._defaultTracker(s))})()}sum(e,n=null,s){var r=this;return(0,m.Z)(function*(){yield r.load();const o=g.WhereClause.create(e,r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC);return r._substituteVars(o,n),r.calculateStatistic("sum",o,-1,r._defaultTracker(s))})()}stdev(e,n=null,s){var r=this;return(0,m.Z)(function*(){yield r.load();const o=g.WhereClause.create(e,r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC);return r._substituteVars(o,n),r.calculateStatistic("stdev",o,-1,r._defaultTracker(s))})()}variance(e,n=null,s){var r=this;return(0,m.Z)(function*(){yield r.load();const o=g.WhereClause.create(e,r.getFieldsIndex(),r.dateFieldsTimeZoneDefaultUTC);return r._substituteVars(o,n),r.calculateStatistic("variance",o,-1,r._defaultTracker(s))})()}count(e){var n=this;return(0,m.Z)(function*(){return yield n.load(),n.calculateStatistic("count",g.WhereClause.create("1",n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC),-1,n._defaultTracker(e))})()}_defaultTracker(e){return e??{aborted:!1}}forEach(e,n){return new Promise((s,r)=>{this._forEachImpl(this.iterator(this._defaultTracker(n)),e,this,s,r,0)})}_forEachImpl(e,n,s,r,o,c){try{if(++c>1e3)return void setTimeout(()=>{this._forEachImpl(e,n,s,r,o,c=0)},0);e.next().then(D=>{try{if(null===D)r(s);else{const x=n(D);null==x?this._forEachImpl(e,n,s,r,o,c):(0,J.y8)(x)?x.then(()=>{try{this._forEachImpl(e,n,s,r,o,c)}catch(L){o(L)}},o):this._forEachImpl(e,n,s,r,o,c)}}catch(x){o(x)}},o)}catch(D){o(D)}}convertToJSON(e){const n={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let s=0;s<this.fields.length;s++)n.layerDefinition.fields.push((0,O.Sh)(this.fields[s]));return this.reduce((s,r)=>{const o={geometry:r.geometry?.toJSON(),attributes:{}};for(const c in r.attributes)o.attributes[c]=r.attributes[c];return n.featureSet.features.push(o),1},0,e).then(()=>n)}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,n,s,r,o){return this._parent.queryAttachments(e,n,s,r,o)}serviceUrl(){return this._parent.serviceUrl()}subtypes(){return this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const n of this.fields)e.push((0,O.Sh)(n));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===O.q2[this.geometryType]?"esriGeometryNull":O.q2[this.geometryType],fields:e}}convertToText(e,n){var s=this;return(0,m.Z)(function*(){if("schema"===e)return yield s._ensureLoaded(),JSON.stringify(s.schema());if("featureset"===e){yield s._ensureLoaded();const r=[];yield s.reduce((c,D)=>{const x={geometry:D.geometry?D.geometry.toJSON():null,attributes:D.attributes};return null!==x.geometry&&x.geometry.spatialReference&&delete x.geometry.spatialReference,r.push(x),1},0,n);const o=s.schema();return o.features=r,o.spatialReference=s.spatialReference.toJSON(),JSON.stringify(o)}return s.castToText()})()}getFeatureByObjectId(e,n){return this._parent.getFeatureByObjectId(e,n)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,n=null){var s=this;return(0,m.Z)(function*(){if("keeptype"===n?.featureset)return s;if("schema"===n?.featureset)return yield s._ensureLoaded(),JSON.parse(JSON.stringify(s.schema()));if("none"===n?.featureset)return null;yield s._ensureLoaded();const r=[];yield s.reduce((c,D)=>{const x={geometry:D.geometry?!0===n?.keepGeometryType?D.geometry:D.geometry.toJSON():null,attributes:D.attributes};return null!==x.geometry&&x.geometry.spatialReference&&!0!==n?.keepGeometryType&&delete x.geometry.spatialReference,r.push(x),1},0,e);const o=s.schema();return o.features=r,o.spatialReference=!0===n?.keepGeometryType?s.spatialReference:s.spatialReference?.toJSON(),o})()}fieldTimeZone(e){return this.getFieldsIndex().getTimeZone(e)}get preferredTimeZone(){return this._parent?.preferredTimeZone??null}get dateFieldsTimeZone(){return this._parent?.dateFieldsTimeZone??null}get dateFieldsTimeZoneDefaultUTC(){if(this.datesInUnknownTimezone)return"unknown";const e=this.dateFieldsTimeZone??"UTC";return""===e?"UTC":e}get datesInUnknownTimezone(){return this._parent.datesInUnknownTimezone}get editFieldsInfo(){return this._parent?.editFieldsInfo??null}get timeInfo(){return this._parent?.timeInfo??null}set featureSetInfo(e){this.fsetInfo=e}getFeatureSetInfo(){var e=this;return(0,m.Z)(function*(){return e.fsetInfo??(yield e._parent?.getFeatureSetInfo())??null})()}}return v._featuresetFunctions={},v})()},58446:(X,H,w)=>{w.d(H,{Z:()=>m});class m{constructor(p,R,k,A){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=p,this._known=R,this._ordered=k,this.pagesDefinition=A}}},19104:(X,H,w)=>{w.d(H,{Z:()=>m});let m=(()=>{class I{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(R){void 0===this._databaseTypeMetaData[R]&&delete this._databaseTypeMetaData[R]}getDatabaseType(R){return"MUSTBESET"===R||void 0===this._databaseTypeMetaData[R]?null:this._databaseTypeMetaData[R]}setDatabaseType(R,k){this._databaseTypeMetaData[R]=k}getLayerInfo(R){return void 0===this._layerInfo[R]?null:this._layerInfo[R]}setLayerInfo(R,k){this._layerInfo[R]=k}clearLayerInfo(R){void 0!==this._layerInfo[R]&&delete this._layerInfo[R]}}return I.applicationCache=null,I})()},77023:(X,H,w)=>{w.d(H,{$e:()=>g,DT:()=>n,TE:()=>Y,XF:()=>C,av:()=>j,bB:()=>J,fz:()=>Z,hq:()=>c,mA:()=>E,vR:()=>e,vn:()=>T,wF:()=>v,y5:()=>D,zR:()=>O});var m=w(93630),I=w(70930),p=w(76961),R=w(81429),k=w(85904),A=w(25037);function O(u,a){return h(u?.parseTree,a,u?.parameters)}function C(u,a,d){return h(u,a,d)}function J(u,a,d,l){return k.WhereClause.create(h(u.parseTree,p.Bj.Standardised,u.parameters,a,d),l,u.timeZone)}function g(u,a,d="AND"){return k.WhereClause.create("(("+O(u,p.Bj.Standardised)+")"+d+"("+O(a,p.Bj.Standardised)+"))",u.fieldsIndex,u.timeZone)}function h(u,a,d,l=null,S=null){let B,N,y,F;switch(u.type){case"interval":return Y(h(u.value,a,d,l,S),u.qualifier,u.op);case"case-expression":{let f=" CASE ";"simple"===u.format&&(f+=h(u.operand,a,d,l,S));for(let P=0;P<u.clauses.length;P++)f+=" WHEN "+h(u.clauses[P].operand,a,d,l,S)+" THEN "+h(u.clauses[P].value,a,d,l,S);return null!==u.else&&(f+=" ELSE "+h(u.else,a,d,l,S)),f+=" END ",f}case"parameter":{const f=d[u.value.toLowerCase()];if("string"==typeof f)return"'"+d[u.value.toLowerCase()].toString().replaceAll("'","''")+"'";if((0,p.J_)(f)||(0,p.T4)(f))return T(f,a);if((0,p._U)(f))return v(f,a);if((0,p.NP)(f))return E(f,a);if((0,p.$A)(f))return j(f,a);if(f instanceof Array){const P=[];for(let M=0;M<f.length;M++)"string"==typeof f[M]?P.push("'"+f[M].toString().replaceAll("'","''")+"'"):(0,p.J_)(f[M])||(0,p.T4)(f[M])?P.push(T(f[M],a)):(0,p._U)(f[M])?P.push(v(f[M],a)):(0,p.NP)(f[M])?P.push(E(f[M],a)):(0,p.$A)(f[M])?P.push(j(f[M],a)):P.push(f[M].toString());return P}return f.toString()}case"expression-list":N=[];for(const f of u.value)N.push(h(f,a,d,l,S));return N;case"unary-expression":return" ( NOT "+h(u.expr,a,d,l,S)+" ) ";case"binary-expression":switch(u.operator){case"AND":return" ("+h(u.left,a,d,l,S)+" AND "+h(u.right,a,d,l,S)+") ";case"OR":return" ("+h(u.left,a,d,l,S)+" OR "+h(u.right,a,d,l,S)+") ";case"IS":if("null"!==u.right.type)throw new I.eS(I.f.UnsupportedIsRhs);return" ("+h(u.left,a,d,l,S)+" IS NULL )";case"ISNOT":if("null"!==u.right.type)throw new I.eS(I.f.UnsupportedIsRhs);return" ("+h(u.left,a,d,l,S)+" IS NOT NULL )";case"IN":return B=[],"expression-list"===u.right.type?(B=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" IN ("+B.join(",")+")) "):(F=h(u.right,a,d,l,S),F instanceof Array?" ("+h(u.left,a,d,l,S)+" IN ("+F.join(",")+")) ":" ("+h(u.left,a,d,l,S)+" IN ("+F+")) ");case"NOT IN":return B=[],"expression-list"===u.right.type?(B=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" NOT IN ("+B.join(",")+")) "):(F=h(u.right,a,d,l,S),F instanceof Array?" ("+h(u.left,a,d,l,S)+" NOT IN ("+F.join(",")+")) ":" ("+h(u.left,a,d,l,S)+" NOT IN ("+F+")) ");case"BETWEEN":return y=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" BETWEEN "+y[0]+" AND "+y[1]+" ) ";case"NOTBETWEEN":return y=h(u.right,a,d,l,S)," ("+h(u.left,a,d,l,S)+" NOT BETWEEN "+y[0]+" AND "+y[1]+" ) ";case"LIKE":return""!==u.escape?" ("+h(u.left,a,d,l,S)+" LIKE "+h(u.right,a,d,l,S)+" ESCAPE '"+u.escape+"') ":" ("+h(u.left,a,d,l,S)+" LIKE "+h(u.right,a,d,l,S)+") ";case"NOT LIKE":return""!==u.escape?" ("+h(u.left,a,d,l,S)+" NOT LIKE "+h(u.right,a,d,l,S)+" ESCAPE '"+u.escape+"') ":" ("+h(u.left,a,d,l,S)+" NOT LIKE "+h(u.right,a,d,l,S)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+h(u.left,a,d,l,S)+" "+u.operator+" "+h(u.right,a,d,l,S)+") ";case"||":return" ("+h(u.left,a,d,l,S)+" "+(a===p.Bj.SqlServer?"+":u.operator)+" "+h(u.right,a,d,l,S)+") "}throw new I.eS(I.f.UnsupportedOperator,{operator:u.operator});case"null":return"null";case"boolean":return!0===u.value?"1":"0";case"string":return"'"+u.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${u.value}'`;case"date":return`date '${u.value}'`;case"time":return`time '${u.value}'`;case"number":return u.value.toString();case"current-time":return e("date"===u.mode,a);case"column-reference":return l?l.toLowerCase()===u.column.toLowerCase()?"("+S+")":!0===u.delimited?`"${u.column.split('"').join('""')}"`:u.column:u.column;case"data-type":return u.value;case"function":{const f=h(u.args,a,d,l,S);return Z(u.name,f,a)}}throw new I.eS(I.f.UnsupportedSyntax,{node:u.type})}function Z(u,a,d){switch(u.toLowerCase().trim()){case"cos":case"sin":case"tan":case"cosh":case"tanh":case"sinh":case"acos":case"asin":case"atan":case"floor":case"log10":case"log":case"abs":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:u.toLowerCase().trim()});return`${u.toUpperCase().trim()}(${a[0]})`;case"ceiling":case"ceil":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"ceiling"});return"CEILING("+a[0]+")";case"mod":case"power":case"nullif":if(2!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:u.toLowerCase().trim()});return`${u.toUpperCase().trim()}(${a[0]},${a[1]})`;case"round":if(2===a.length)return"ROUND("+a[0]+","+a[1]+")";if(1===a.length)return"ROUND("+a[0]+")";throw new I.eS(I.f.InvalidFunctionParameters,{function:"round"});case"truncate":if(a.length<1||a.length>2)throw new I.eS(I.f.InvalidFunctionParameters,{function:"truncate"});return d===p.Bj.SqlServer?"ROUND("+a[0]+(1===a.length?"0":","+a[1])+",1)":"TRUNCATE("+a[0]+(1===a.length?")":","+a[1]+")");case"char_length":case"len":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"char_length"});switch(d){case p.Bj.SqlServer:return"LEN("+a[0]+")";case p.Bj.Oracle:return"LENGTH("+a[0]+")";default:return"CHAR_LENGTH("+a[0]+")"}case"coalesce":case"concat":{if(a.length<1)throw new I.eS(I.f.InvalidFunctionParameters,{function:u.toLowerCase()});let l=u.toUpperCase().trim()+"(";for(let S=0;S<a.length;S++)0!==S&&(l+=","),l+=a[S];return l+=")",l}case"lower":case"lcase":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"lower"});return"LOWER("+a[0]+")";case"upper":case"ucase":if(1!==a.length)throw new I.eS(I.f.InvalidFunctionParameters,{function:"upper"});return"UPPER("+a[0]+")";case"substring":{let l="";switch(d){case p.Bj.Oracle:return l="SUBSTR("+a[0]+","+a[1],3===a.length&&(l+=","+a[2]),l+=")",l;case p.Bj.SqlServer:return l=3===a.length?"SUBSTRING("+a[0]+","+a[1]+","+a[2]+")":"SUBSTRING("+a[0]+",  "+a[1]+", LEN("+a[0]+") - "+a[1]+")",l;default:return l="SUBSTRING("+a[0]+" FROM "+a[1],3===a.length&&(l+=" FOR "+a[2]),l+=")",l}}case"extract":return"EXTRACT("+a[0].replaceAll("'","")+" FROM "+a[1]+")";case"cast":{let l="";switch(d){case p.Bj.Oracle:switch(a[1].type){case"date":l="DATE";break;case"float":l="DOUBLE";break;case"integer":l="INTEGER";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="TIMESTAMP";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`;case p.Bj.Postgres:switch(a[1].type){case"date":l="DATE";break;case"float":l="DOUBLE PRECISION";break;case"integer":l="INT";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="TIMESTAMP";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`;case p.Bj.SqlServer:switch(a[1].type){case"date":l="DATE";break;case"float":l="FLOAT";break;case"integer":l="INT";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="DATETIME";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`;default:switch(a[1].type){case"date":l="DATE";break;case"float":l="FLOAT";break;case"integer":l="INTEGER";break;case"real":l="REAL";break;case"smallint":l="SMALLINT";break;case"timestamp":l="TIMESTAMP";break;case"varchar":l="VARCHAR("+a[1].size.toString()+")"}return`CAST(${a[0]} AS ${l})`}}}throw new I.eS(I.f.InvalidFunctionParameters,{function:u})}function E(u,a){const d=u.toDateTime(),l=0===d.hour&&0===d.minute&&0===d.second&&0===d.millisecond;switch(a){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:return l?`date '${d.toFormat("yyyy-LL-dd")}'`:`timestamp '${d.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case p.Bj.Oracle:return l?`TO_DATE('${d.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${d.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case p.Bj.SqlServer:return`'${d.toFormat(l?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case p.Bj.PGDB:return`#${d.toFormat(l?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case p.Bj.Postgres:return`TIMESTAMP '${d.toFormat(l?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`timestamp '${d.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function j(u,a){switch(a){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:return u.toSQLWithKeyword();case p.Bj.Oracle:return`TO_DATE('${u.toFormat("Y-MM-DD")}'`;case p.Bj.SqlServer:return`'${u.toFormat("Y-MM-DD")}'`;case p.Bj.PGDB:return`#${u.toFormat("Y-MM-DD")}#`;case p.Bj.Postgres:return`TIMESTAMP '${u.toFormat("Y-MM-DD")}'`;default:return u.toSQLWithKeyword()}}function v(u,a){switch(u instanceof R.n&&(u=u.toStorageString()),a){case p.Bj.Oracle:return`TO_DATE('${u}', 'HH24:MI:SS')`;case p.Bj.SqlServer:return`'${u}'`;default:return`time '${u}'`}}function T(u,a){return E(m.iG.dateTimeToArcadeDate((0,p.T4)(u)?u:A.ou.fromJSDate(u)),a)}function e(u,a){switch(a){case p.Bj.FILEGDB:case p.Bj.Standardised:case p.Bj.StandardisedNoInterval:case p.Bj.Oracle:return u?"CURRENT_DATE":"CURRENT_TIMESTAMP";case p.Bj.SqlServer:return u?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return u?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function n(u,a,d={}){const l={},S={},B={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeBigInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeTimeOnly:"time-only",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimestampOffset:"timestamp-offset",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"guid",oid:"integer",long:"integer","small-integer":"integer",integer:"integer","big-integer":"integer",single:"double","time-only":"time-only","date-only":"date-only","timestamp-offset":"timestemp-offset",double:"double",date:"date",guid:"guid","global-id":"guid",string:"string"};for(const N of a){const y=N.type?B[N.type]:void 0;l[N.name.toLowerCase()]=void 0===y?"":y}for(const N in d){const y=B[d[N]];S[N.toLowerCase()]=void 0===y?"":y}switch(s(l,u.parseTree,u.parameters,S)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"date-only":return"date-only";case"time-only":return"time-only";case"timestamp-offset":return"timestamp-offset";case"string":return"string";case"global-id":case"guid":return"guid"}return""}function s(u,a,d,l){let S;switch(a.type){case"interval":return"integer";case"case-expression":{const B=[];if("simple"===a.format){for(let N=0;N<a.clauses.length;N++)B.push(s(u,a.clauses[N].value,d,l));null!==a.else&&B.push(s(u,a.else,d,l))}else{for(let N=0;N<a.clauses.length;N++)B.push(s(u,a.else,d,l));null!==a.else&&B.push(s(u,a.else,d,l))}return o(B)}case"parameter":{const B=l[a.value.toLowerCase()];if(void 0===B&&d){const N=d[a.value.toLowerCase()];if(null==N)return"";if("string"==typeof N||N instanceof String)return"string";if("boolean"==typeof N)return"boolean";if((0,p.J_)(N)||(0,p.NP)(N))return"date";if((0,p.$A)(N))return"date-only";if((0,p._U)(N))return"time-only";if("number"==typeof N)return N%1==0?"integer":"double"}return void 0===B?"":B}case"expression-list":{const B=[];for(const N of a.value)B.push(s(u,N,d,l));return B}case"unary-expression":return"boolean";case"binary-expression":switch(a.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==a.right.type)throw new I.eS(I.f.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return o([s(u,a.left,d,l),s(u,a.right,d,l)]);case"||":return"string";default:throw new I.eS(I.f.UnsupportedOperator,{operator:a.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===a.value?"":a.value%1==0?"integer":"double";case"date":return"date";case"timestamp":return a.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"current-time":return"date";case"column-reference":{const B=u[a.column.toLowerCase()];return void 0===B?"":B}case"function":switch(a.name.toLowerCase()){case"cast":switch(a.args?.value[1]?.value.type??""){case"integer":case"smallint":return"integer";case"real":case"float":return"double";case"date":case"timestamp":return!0===a.args?.value[1]?.value?.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"varchar":return"string";default:return""}case"position":case"extract":case"char_length":case"mod":return"integer";case"round":if(S=s(u,a.args,d,l),S instanceof Array){if(S.length<=0)return"double";S=S[0]}return S;case"sign":return"integer";case"ceiling":case"floor":case"abs":return S=s(u,a.args,d,l),S instanceof Array&&(S=o(S)),"integer"===S||"double"===S?S:"double";case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"cosh":case"sinh":case"tanh":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"nullif":case"coalesce":return S=s(u,a.args,d,l),S instanceof Array?S.length>0?S[0]:"":S}return""}throw new I.eS(I.f.UnsupportedSyntax,{node:a.type})}const r={boolean:1,string:2,integer:3,double:4,date:5};function o(u){if(u){let a="";for(const d of u)""!==d&&(a=""===a||r[a]<r[d]?d:a);return a}return""}function c(u,a){return x(u.parseTree,a)}function D(u){return"column-reference"===u?.parseTree.type}function x(u,a){if(null==u)return!1;switch(u.type){case"when-clause":return x(u.operand,a)||x(u.value,a);case"case-expression":for(const d of u.clauses)if(x(d,a))return!0;return!("simple"!==u.format||!x(u.operand,a))||!(null===u.else||!x(u.else,a));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"time":case"string":case"number":return!1;case"expression-list":for(const d of u.value)if(x(d,a))return!0;return!1;case"unary-expression":return x(u.expr,a);case"binary-expression":return x(u.left,a)||x(u.right,a);case"column-reference":return a.toLowerCase()===u.column.toLowerCase();case"function":return x(u.args,a)}return!1}function L(u){let a="";return a+=u.period.toUpperCase(),a}function Y(u,a,d){let l="";return l="interval-period"===a.type?L(a):L(a.start)+" TO "+L(a.end),"INTERVAL "+d+" "+u+" "+l}},80389:(X,H,w)=>{w.d(H,{CA:()=>c,EB:()=>B,Fp:()=>n,J6:()=>r,QX:()=>a,Sm:()=>Y,VV:()=>T,g3:()=>j,m:()=>x,tj:()=>v});var m=w(15861),I=w(70930),p=w(76961),R=w(77023),k=w(88781),A=w(80458),O=w(81429);function J(y){let F=0;for(let f=0;f<y.length;f++)F+=y[f];return F/y.length}function g(y){const F=J(y);let f=0;for(let P=0;P<y.length;P++)f+=(F-y[P])**2;return f/y.length}function h(y){const F=J(y);let f=0;for(let P=0;P<y.length;P++)f+=(F-y[P])**2;return f/(y.length-1)}function Z(y){let F=0;for(let f=0;f<y.length;f++)F+=y[f];return F}function j(y){switch(y.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function v(y,F,f=1e3){switch(y.toLowerCase()){case"distinct":return function E(y,F){const f=[],P={},M=[];for(let G=0;G<y.length;G++){if(null!=y[G]){const K=y[G];if((0,p.hj)(K)||(0,p.HD)(K))void 0===P[K]&&(f.push(K),P[K]=1);else{let Q=!1;for(let W=0;W<M.length;W++)!0===(0,p.tt)(M[W],K)&&(Q=!0);!1===Q&&(M.push(K),f.push(K))}}if(f.length>=F&&-1!==F)return f}return f}(F,f);case"avg":case"mean":return J(F);case"min":return Math.min.apply(Math,F);case"sum":return Z(F);case"max":return Math.max.apply(Math,F);case"stdev":case"stddev":return Math.sqrt(g(F));case"var":case"variance":return g(F);case"count":return F.length}return 0}function T(y,F,f){return e.apply(this,arguments)}function e(){return(e=(0,m.Z)(function*(y,F,f){const P=yield l(y,F,f,!0);return 0===P.length?null:Math.min.apply(Math,P)})).apply(this,arguments)}function n(y,F,f){return s.apply(this,arguments)}function s(){return(s=(0,m.Z)(function*(y,F,f){const P=yield l(y,F,f,!0);return 0===P.length?null:Math.max.apply(Math,P)})).apply(this,arguments)}function r(y,F,f){return o.apply(this,arguments)}function o(){return(o=(0,m.Z)(function*(y,F,f){let P="";F&&!(0,R.y5)(F)&&(P=(0,R.DT)(F,y.fields));const M=yield l(y,F,f,!0);if(0===M.length)return null;const G=J(M);return null===G?G:"integer"===P?function C(y){return y=+y,isFinite(y)?y-y%1||(y<0?-0:0===y?y:0):y}(G):G})).apply(this,arguments)}function c(y,F,f){return D.apply(this,arguments)}function D(){return(D=(0,m.Z)(function*(y,F,f){const P=yield l(y,F,f,!0);return 0===P.length?null:h(P)})).apply(this,arguments)}function x(y,F,f){return L.apply(this,arguments)}function L(){return(L=(0,m.Z)(function*(y,F,f){const P=yield l(y,F,f,!0);return 0===P.length?null:Math.sqrt(h(P))})).apply(this,arguments)}function Y(y,F,f){return u.apply(this,arguments)}function u(){return(u=(0,m.Z)(function*(y,F,f){const P=yield l(y,F,f,!0);return 0===P.length?null:Z(P)})).apply(this,arguments)}function a(y,F){return d.apply(this,arguments)}function d(){return(d=(0,m.Z)(function*(y,F){return y.iterator(F).count()})).apply(this,arguments)}function l(y,F,f){return S.apply(this,arguments)}function S(){return(S=(0,m.Z)(function*(y,F,f,P=!1){const M=y.iterator(f),G=[],K={ticker:0};let Q=yield M.next();for(;null!==Q;){if(K.ticker++,f.aborted)throw new I.EN(I.H9.Cancelled);K.ticker%100==0&&(K.ticker=0,yield new Promise($=>{setTimeout($,0)}));const W=F?.calculateValue(Q);null===W?!1===P&&(G[G.length]=W):G[G.length]=W instanceof k.u||W instanceof O.n?W.toNumber():W instanceof A.H?W.toMilliseconds():W,Q=yield M.next()}return G})).apply(this,arguments)}function B(y,F){return N.apply(this,arguments)}function N(){return(N=(0,m.Z)(function*(y,F,f=1e3,P=null){const M=y.iterator(P),G=[],K={},Q={ticker:0};let W=yield M.next();for(;null!==W;){if(Q.ticker++,P&&P.aborted)throw new I.EN(I.H9.Cancelled);Q.ticker%100==0&&(Q.ticker=0,yield new Promise(te=>{setTimeout(te,0)}));const $=F?.calculateValue(W);let z=$;if($ instanceof k.u?z="!!DATEONLY!!-"+$.toString():$ instanceof A.H?z="!!TSOFFSETONLY!!-"+$.toString():$ instanceof O.n?z="!!TIMEONLY!!-"+$.toString():$ instanceof Date&&(z="!!DATE!!-"+$.toString()),null!=$&&void 0===K[z]&&(G.push($),K[z]=1),G.length>=f&&-1!==f)return G;W=yield M.next()}return G})).apply(this,arguments)}},23686:(X,H,w)=>{w.d(H,{CJ:()=>we,Cz:()=>Fe,D$:()=>ve,ED:()=>d,FH:()=>Te,G0:()=>$,Gg:()=>B,JI:()=>F,LV:()=>S,Nm:()=>l,Sp:()=>G,TE:()=>x,U1:()=>Ee,W4:()=>u,Y4:()=>be,_L:()=>Ie,cv:()=>te,e5:()=>P,f3:()=>ye,fS:()=>L,j2:()=>De,jU:()=>D,kK:()=>Y,kQ:()=>Ae,og:()=>N,oq:()=>n,r3:()=>c,rd:()=>Se,sz:()=>xe,uh:()=>a,wf:()=>Q,z7:()=>r});var m=w(15861),p=(w(2189),w(36885)),R=w(85039),k=w(40637);function A(i){return Array.isArray(i)?i[0]?.spatialReference:i?.spatialReference}function O(i){return i&&(Array.isArray(i)?i.map(O):i.toJSON?i.toJSON():i)}function C(i){return Array.isArray(i)?i.map(_=>(0,k.im)(_)):(0,k.im)(i)}let g;function Z(){return(Z=(0,m.Z)(function*(){return g||(g=(0,p.bA)("geometryEngineWorker",{strategy:"distributed"})),g})).apply(this,arguments)}function E(i,_){return j.apply(this,arguments)}function j(){return(j=(0,m.Z)(function*(i,_){return(yield function h(){return Z.apply(this,arguments)}()).invoke("executeGEOperation",{operation:i,parameters:O(_)})})).apply(this,arguments)}function n(i,_){return s.apply(this,arguments)}function s(){return(s=(0,m.Z)(function*(i,_){return C(yield E("clip",[A(i),i,_]))})).apply(this,arguments)}function r(i,_){return o.apply(this,arguments)}function o(){return(o=(0,m.Z)(function*(i,_){return C(yield E("cut",[A(i),i,_]))})).apply(this,arguments)}function c(i,_){return E("contains",[A(i),i,_])}function D(i,_){return E("crosses",[A(i),i,_])}function x(i,_,b){return E("distance",[A(i),i,_,b])}function L(i,_){return E("equals",[A(i),i,_])}function Y(i,_){return E("intersects",[A(i),i,_])}function u(i,_){return E("touches",[A(i),i,_])}function a(i,_){return E("within",[A(i),i,_])}function d(i,_){return E("disjoint",[A(i),i,_])}function l(i,_){return E("overlaps",[A(i),i,_])}function S(i,_,b){return E("relate",[A(i),i,_,b])}function B(i){return E("isSimple",[A(i),i])}function N(i){return y.apply(this,arguments)}function y(){return(y=(0,m.Z)(function*(i){return C(yield E("simplify",[A(i),i]))})).apply(this,arguments)}function F(i){return f.apply(this,arguments)}function f(){return(f=(0,m.Z)(function*(i,_=!1){return C(yield E("convexHull",[A(i),i,_]))})).apply(this,arguments)}function P(i,_){return M.apply(this,arguments)}function M(){return(M=(0,m.Z)(function*(i,_){return C(yield E("difference",[A(i),i,_]))})).apply(this,arguments)}function G(i,_){return K.apply(this,arguments)}function K(){return(K=(0,m.Z)(function*(i,_){return C(yield E("symmetricDifference",[A(i),i,_]))})).apply(this,arguments)}function Q(i,_){return W.apply(this,arguments)}function W(){return(W=(0,m.Z)(function*(i,_){return C(yield E("intersect",[A(i),i,_]))})).apply(this,arguments)}function $(i){return z.apply(this,arguments)}function z(){return(z=(0,m.Z)(function*(i,_=null){const b=function J(i,_){let b;return Array.isArray(i)?b=i:(b=[],b.push(i),null!=_&&b.push(_)),b}(i,_);return C(yield E("union",[A(b),b]))})).apply(this,arguments)}function te(i,_,b,U,V,ee){return re.apply(this,arguments)}function re(){return(re=(0,m.Z)(function*(i,_,b,U,V,ee){return C(yield E("offset",[A(i),i,_,b,U,V,ee]))})).apply(this,arguments)}function ye(i,_,b){return ne.apply(this,arguments)}function ne(){return(ne=(0,m.Z)(function*(i,_,b,U=!1){const V=[A(i),i,_,b,U];return C(yield E("buffer",V))})).apply(this,arguments)}function Se(i,_,b,U,V,ee){return ae.apply(this,arguments)}function ae(){return(ae=(0,m.Z)(function*(i,_,b,U,V,ee){const Pe=[A(i),i,_,b,U,V,ee];return C(yield E("geodesicBuffer",Pe))})).apply(this,arguments)}function Te(i,_){return se.apply(this,arguments)}function se(){return(se=(0,m.Z)(function*(i,_,b=!0){const U=yield E("nearestCoordinate",[A(i),i,_,b]);return{...U,coordinate:R.Z.fromJSON(U.coordinate)}})).apply(this,arguments)}function Ie(i,_){return ie.apply(this,arguments)}function ie(){return(ie=(0,m.Z)(function*(i,_){const b=yield E("nearestVertex",[A(i),i,_]);return{...b,coordinate:R.Z.fromJSON(b.coordinate)}})).apply(this,arguments)}function Ee(i,_,b){return le.apply(this,arguments)}function le(){return(le=(0,m.Z)(function*(i,_,b){if(null==i)throw new q;const U=i.spatialReference;if(null==(b=b??function oe(i){return"xmin"in i?i.center:"x"in i?i:i.extent?.center}(i)))throw new q;const V=i.constructor.fromJSON(yield E("rotate",[U,i,_,b]));return V.spatialReference=U,V})).apply(this,arguments)}function ve(i,_,b,U){return _e.apply(this,arguments)}function _e(){return(_e=(0,m.Z)(function*(i,_,b,U){return C(yield E("generalize",[A(i),i,_,b,U]))})).apply(this,arguments)}function Fe(i,_,b){return de.apply(this,arguments)}function de(){return(de=(0,m.Z)(function*(i,_,b){return C(yield E("densify",[A(i),i,_,b]))})).apply(this,arguments)}function De(i,_,b){return pe.apply(this,arguments)}function pe(){return(pe=(0,m.Z)(function*(i,_,b,U=0){return C(yield E("geodesicDensify",[A(i),i,_,b,U]))})).apply(this,arguments)}function we(i,_){return E("planarArea",[A(i),i,_])}function xe(i,_){return E("planarLength",[A(i),i,_])}function be(i,_,b){return E("geodesicArea",[A(i),i,_,b])}function Ae(i,_,b){return E("geodesicLength",[A(i),i,_,b])}class q extends Error{constructor(){super("Illegal Argument Exception")}}}}]);