"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[5390],{40408:(x,I,r)=>{r.d(I,{dp:()=>u,o2:()=>l,yZ:()=>O});var v=r(55117),o=r(49602);const h=96;function O(i,d){const M=d||i.extent,T=i.width,g=(0,o.c9)(M?.spatialReference);return M&&T?M.width/T*g*o.hd*h:0}function u(i,d){return i/((0,o.c9)(d)*o.hd*h)}function l(i,d,M){return function j(i,d){return 0===d||(0,v.W8)(i,d)||i<d}(i,d)&&function B(i,d){return 0===d||(0,v.W8)(i,d)||i>d}(i,M)}},37803:(x,I,r)=>{r.r(I),r.d(I,{default:()=>se});var v=r(15861),o=r(50484),h=r(66476),O=r(34411),u=r(57964),L=r(30352),C=r(3233),U=r(79412),l=r(80543),j=r(1535),d=(r(57678),r(14007),r(62185)),M=r(10141),T=r(7547),g=r(60301),K=r(26894),b=r(40408),Z=r(33721),F=r(95060),N=r(29674),J=r(71413),V=r(4257),$=r(19855),G=r(27426),z=r(80099),H=r(70509),Q=r(25836),Y=r(29717),X=r(22921),w=r(12522),k=r(8966),q=r(61793),ee=r(53715),re=r(25740),W=r(45859),te=r(83739),S=r(764);let a=class extends((0,$.h)((0,w.n)((0,Y.M)((0,X.x)((0,J.O)((0,V.Y)((0,z.q)((0,H.I)((0,C.R)((0,Q.Q)((0,N.V)((0,G.N)(F.Z))))))))))))){constructor(...t){super(...t),this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.preferredTimeZone=null,this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(t,s){return"string"==typeof t?{url:t,...s}:t}load(t){const s=null!=t?t.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},t).catch(U.r9).then(()=>this._fetchService(s))),Promise.resolve(this)}readImageFormat(t,s){const c=s.supportedImageFormatTypes;return c&&c.includes("PNG32")?"png32":"png24"}writeSublayers(t,s,c,p){if(!this.loaded||!t)return;const m=t.slice().reverse().flatten(({sublayers:E})=>E&&E.toArray().reverse()).toArray();let _=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap?.supportsDynamicLayers){const E=(0,g.M9)(p.origin);if(E===g.s3.PORTAL_ITEM){const D=this.createSublayersForOrigin("service").sublayers;_=(0,W.QV)(m,D,g.s3.SERVICE)}else if(E>g.s3.PORTAL_ITEM){const D=this.createSublayersForOrigin("portal-item");_=(0,W.QV)(m,D.sublayers,(0,g.M9)(D.origin))}}const y=[],f={writeSublayerStructure:_,...p};let P=_;m.forEach(E=>{const D=E.write({},f);y.push(D),P=P||"user"===E.originOf("visible")}),y.some(E=>Object.keys(E).length>1)&&(s.layers=y),P&&(s.visibleLayers=m.filter(E=>E.visible).map(E=>E.id))}createExportImageParameters(t,s,c,p){const m=p?.pixelRatio||1;t&&this.version>=10&&(t=t.clone().shiftCentralMeridian());const _=new q.R({layer:this,floors:p?.floors,scale:(0,b.yZ)({extent:t,width:s})*m}),y=_.toJSON();_.destroy();const f=!p?.rotation||this.version<10.3?{}:{rotation:-p.rotation},P=t?.spatialReference,E=(0,Z.B9)(P);y.dpi*=m;const D={};if(p?.timeExtent){const{start:R,end:A}=p.timeExtent.toJSON();D.time=R&&A&&R===A?""+R:`${R??"null"},${A??"null"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(D.time="null,null");return{bbox:t&&t.xmin+","+t.ymin+","+t.xmax+","+t.ymax,bboxSR:E,imageSR:E,size:s+","+c,...y,...f,...D}}fetchImage(t,s,c,p){var m=this;return(0,v.Z)(function*(){const{data:_}=yield m._fetchImage("image",t,s,c,p);return _})()}fetchImageBitmap(t,s,c,p){var m=this;return(0,v.Z)(function*(){const{data:_,url:y}=yield m._fetchImage("blob",t,s,c,p);return(0,ee.g)(_,y,p?.signal)})()}fetchRecomputedExtents(t={}){var s=this;return(0,v.Z)(function*(){const c={...t,query:{returnUpdates:!0,f:"json",...s.customParameters,token:s.apiKey}},{data:p}=yield(0,h.Z)(s.url,c),{extent:m,fullExtent:_,timeExtent:y}=p,f=m||_;return{fullExtent:f&&K.Z.fromJSON(f),timeExtent:y&&O.Z.fromJSON({start:y[0],end:y[1]})}})()}loadAll(){return(0,L.G)(this,t=>{t(this.allSublayers)})}serviceSupportsSpatialReference(t){return(0,te.D)(this,t)}_fetchImage(t,s,c,p,m){var _=this;return(0,v.Z)(function*(){const y={responseType:t,signal:m?.signal??null,query:{..._.parsedUrl.query,..._.createExportImageParameters(s,c,p,m),f:"image",..._.refreshParameters,..._.customParameters,token:_.apiKey}},f=_.parsedUrl.path+"/export";if(null!=y.query?.dynamicLayers&&!_.capabilities?.exportMap?.supportsDynamicLayers)throw new u.Z("mapimagelayer:dynamiclayer-not-supported",`service ${_.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:y.query});try{const{data:P}=yield(0,h.Z)(f,y);return{data:P,url:f}}catch(P){throw(0,U.D_)(P)?P:new u.Z("mapimagelayer:image-fetch-error",`Unable to load image: ${f}`,{error:P})}})()}_fetchService(t){var s=this;return(0,v.Z)(function*(){if(s.sourceJSON)return void s.read(s.sourceJSON,{origin:"service",url:s.parsedUrl});const{data:c,ssl:p}=yield(0,h.Z)(s.parsedUrl.path,{query:{f:"json",...s.parsedUrl.query,...s.customParameters,token:s.apiKey},signal:t});p&&(s.url=s.url.replace(/^http:/i,"https:")),s.sourceJSON=c,s.read(c,{origin:"service",url:s.parsedUrl})})()}};(0,o._)([(0,l.Cb)((0,S.mi)("dateFieldsTimeReference"))],a.prototype,"dateFieldsTimeZone",void 0),(0,o._)([(0,l.Cb)({type:Boolean})],a.prototype,"datesInUnknownTimezone",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"dpi",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"gdbVersion",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"imageFormat",void 0),(0,o._)([(0,d.r)("imageFormat",["supportedImageFormatTypes"])],a.prototype,"readImageFormat",null),(0,o._)([(0,l.Cb)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],a.prototype,"imageMaxHeight",void 0),(0,o._)([(0,l.Cb)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],a.prototype,"imageMaxWidth",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"imageTransparency",void 0),(0,o._)([(0,l.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],a.prototype,"isReference",void 0),(0,o._)([(0,l.Cb)({json:{read:!1,write:!1}})],a.prototype,"labelsVisible",void 0),(0,o._)([(0,l.Cb)({type:["ArcGISMapServiceLayer"]})],a.prototype,"operationalLayerType",void 0),(0,o._)([(0,l.Cb)({json:{read:!1,write:!1}})],a.prototype,"popupEnabled",void 0),(0,o._)([(0,l.Cb)((0,S.mi)("preferredTimeReference"))],a.prototype,"preferredTimeZone",void 0),(0,o._)([(0,l.Cb)()],a.prototype,"sourceJSON",void 0),(0,o._)([(0,l.Cb)({json:{write:{ignoreOrigin:!0}}})],a.prototype,"sublayers",void 0),(0,o._)([(0,T.c)("sublayers",{layers:{type:[re.Z]},visibleLayers:{type:[j.z8]}})],a.prototype,"writeSublayers",null),(0,o._)([(0,l.Cb)({type:["show","hide","hide-children"]})],a.prototype,"listMode",void 0),(0,o._)([(0,l.Cb)({json:{read:!1},readOnly:!0,value:"map-image"})],a.prototype,"type",void 0),(0,o._)([(0,l.Cb)(k.HQ)],a.prototype,"url",void 0),a=(0,o._)([(0,M.j)("esri.layers.MapImageLayer")],a);const se=a},1865:(x,I,r)=>{function v(O){const u=O.layer;return"floorInfo"in u&&u.floorInfo?.floorField&&"floors"in O.view?h(O.view.floors,u.floorInfo.floorField):null}function o(O,u){return"floorInfo"in u&&u.floorInfo?.floorField?h(O,u.floorInfo.floorField):null}function h(O,u){if(!O?.length)return null;const L=O.filter(C=>""!==C).map(C=>`'${C}'`);return L.push("''"),`${u} IN (${L.join(",")}) OR ${u} IS NULL`}r.d(I,{c:()=>v,f:()=>o})}}]);