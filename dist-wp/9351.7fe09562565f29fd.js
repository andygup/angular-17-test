"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[9351,3715],{59211:($,W,e)=>{e.d(W,{Z:()=>c});var b=e(15861),d=e(50484),F=e(73514),B=e(57964),U=e(14007),P=e(79412),I=e(6785),E=e(80543),M=(e(1535),e(57678),e(10141)),x=e(11642),L=e(46054),Z=e(15462),J=e(24859),w=(e(2189),e(82784)),j=e(91866),G=e(26894);function O(){return(O=(0,b.Z)(function*(y,u,f){const v=(0,Z.en)(y);return(0,w.Vr)(v,j.Z.from(u),{...f}).then(R=>({count:R.data.count,extent:G.Z.fromJSON(R.data.extent)}))})).apply(this,arguments)}var n=e(61375),r=e(46708),i=e(36026),p=e(93792);let _=class extends F.Z{constructor(y){super(y),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.url=null}get parsedUrl(){return(0,I.mN)(this.url)}execute(y,u){var f=this;return(0,b.Z)(function*(){const v=yield f.executeJSON(y,u);return f.featureSetFromJSON(y,v,u)})()}executeJSON(y,u){var f=this;return(0,b.Z)(function*(){const v=f._normalizeQuery(y),R=null!=y.outStatistics?.[0],T=(0,U.Z)("featurelayer-pbf-statistics"),V=!R||T;let C;if(f.pbfSupported&&V)try{C=yield(0,i.t)(f.url,v,u)}catch(K){if("query:parsing-pbf"!==K.name)throw K;f.pbfSupported=!1}return f.pbfSupported&&V||(C=yield(0,r.F)(f.url,v,u)),f._normalizeFields(C.fields),C})()}featureSetFromJSON(y,u,f){var v=this;return(0,b.Z)(function*(){if(!v._queryIs3DObjectFormat(y)||null==v.infoFor3D||!u.features)return p.Z.fromJSON(u);const{meshFeatureSetFromJSON:R}=yield(0,P.Hl)(Promise.all([e.e(1716),e.e(4612),e.e(2859),e.e(6215),e.e(8592),e.e(7045)]).then(e.bind(e,17045)),f);return R(y,v.infoFor3D,u)})()}executeForCount(y,u){return(0,J.P)(this.url,this._normalizeQuery(y),u)}executeForExtent(y,u){return function z(y,u,f){return O.apply(this,arguments)}(this.url,this._normalizeQuery(y),u)}executeForIds(y,u){return(0,n.G)(this.url,this._normalizeQuery(y),u)}executeRelationshipQuery(y,u){var f=this;return(0,b.Z)(function*(){const[{default:v},{executeRelationshipQuery:R}]=yield(0,P.Hl)(Promise.all([Promise.resolve().then(e.bind(e,46556)),e.e(3005).then(e.bind(e,83005))]),u);return y=v.from(y),(f.gdbVersion||f.dynamicDataSource)&&((y=y.clone()).gdbVersion=y.gdbVersion||f.gdbVersion,y.dynamicDataSource=y.dynamicDataSource||f.dynamicDataSource),R(f.url,y,u)})()}executeRelationshipQueryForCount(y,u){var f=this;return(0,b.Z)(function*(){const[{default:v},{executeRelationshipQueryForCount:R}]=yield(0,P.Hl)(Promise.all([Promise.resolve().then(e.bind(e,46556)),e.e(3005).then(e.bind(e,83005))]),u);return y=v.from(y),(f.gdbVersion||f.dynamicDataSource)&&((y=y.clone()).gdbVersion=y.gdbVersion||f.gdbVersion,y.dynamicDataSource=y.dynamicDataSource||f.dynamicDataSource),R(f.url,y,u)})()}executeAttachmentQuery(y,u){var f=this;return(0,b.Z)(function*(){const{executeAttachmentQuery:v,fetchAttachments:R,processAttachmentQueryResult:T}=yield(0,P.Hl)(e.e(4662).then(e.bind(e,4662)),u),V=(0,Z.en)(f.url);return T(V,yield f.queryAttachmentsSupported?v(V,y,u):R(V,y,u))})()}executeTopFeaturesQuery(y,u){var f=this;return(0,b.Z)(function*(){const{executeTopFeaturesQuery:v}=yield(0,P.Hl)(Promise.all([e.e(8592),e.e(8778)]).then(e.bind(e,38778)),u);return v(f.parsedUrl,y,f.sourceSpatialReference,u)})()}executeForTopIds(y,u){var f=this;return(0,b.Z)(function*(){const{executeForTopIds:v}=yield(0,P.Hl)(Promise.all([e.e(8592),e.e(8009)]).then(e.bind(e,98009)),u);return v(f.parsedUrl,y,u)})()}executeForTopExtents(y,u){var f=this;return(0,b.Z)(function*(){const{executeForTopExtents:v}=yield(0,P.Hl)(Promise.all([e.e(8592),e.e(8080)]).then(e.bind(e,78080)),u);return v(f.parsedUrl,y,u)})()}executeForTopCount(y,u){var f=this;return(0,b.Z)(function*(){const{executeForTopCount:v}=yield(0,P.Hl)(Promise.all([e.e(8592),e.e(4032)]).then(e.bind(e,34032)),u);return v(f.parsedUrl,y,u)})()}_normalizeQuery(y){let u=j.Z.from(y);u.sourceSpatialReference=u.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(u=u===y?u.clone():u,u.gdbVersion=y.gdbVersion||this.gdbVersion,u.dynamicDataSource=y.dynamicDataSource?L.n.from(y.dynamicDataSource):this.dynamicDataSource);const{infoFor3D:f}=this;if(null!=f&&this._queryIs3DObjectFormat(y)){u=u===y?u.clone():u,u.formatOf3DObjects=null;const{supportedFormats:v,queryFormats:R}=f,T=(0,x.S0)("model/gltf-binary",v)??(0,x.Ow)("glb",v),V=(0,x.S0)("model/gltf+json",v)??(0,x.Ow)("gtlf",v);for(const C of R){if(C===T){u.formatOf3DObjects=C;break}C!==V||u.formatOf3DObjects||(u.formatOf3DObjects=C)}if(!u.formatOf3DObjects)throw new B.Z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(null==u.outFields||!u.outFields.includes("*")){u=u===y?u.clone():u,null==u.outFields&&(u.outFields=[]);const{originX:C,originY:K,originZ:X,translationX:Y,translationY:ee,translationZ:ne,scaleX:ie,scaleY:ae,scaleZ:re,rotationX:te,rotationY:le,rotationZ:ue,rotationDeg:de}=f.transformFieldRoles;u.outFields.push(C,K,X,Y,ee,ne,ie,ae,re,te,le,ue,de)}}return u}_normalizeFields(y){if(null!=this.fieldsIndex&&null!=y)for(const u of y){const f=this.fieldsIndex.get(u.name);f&&Object.assign(u,f.toJSON())}}_queryIs3DObjectFormat(y){return null!=this.infoFor3D&&!0===y.returnGeometry&&"xyFootprint"!==y.multipatchOption&&!y.outStatistics}};(0,d._)([(0,E.Cb)({type:L.n})],_.prototype,"dynamicDataSource",void 0),(0,d._)([(0,E.Cb)()],_.prototype,"fieldsIndex",void 0),(0,d._)([(0,E.Cb)()],_.prototype,"gdbVersion",void 0),(0,d._)([(0,E.Cb)()],_.prototype,"infoFor3D",void 0),(0,d._)([(0,E.Cb)({readOnly:!0})],_.prototype,"parsedUrl",null),(0,d._)([(0,E.Cb)()],_.prototype,"pbfSupported",void 0),(0,d._)([(0,E.Cb)()],_.prototype,"queryAttachmentsSupported",void 0),(0,d._)([(0,E.Cb)()],_.prototype,"sourceSpatialReference",void 0),(0,d._)([(0,E.Cb)({type:String})],_.prototype,"url",void 0),_=(0,d._)([(0,M.j)("esri.tasks.QueryTask")],_);const c=_},71413:($,W,e)=>{e.d(W,{O:()=>z});var b=e(15861),d=e(50484),F=e(66476),B=e(8611),U=e(79412),P=e(6785),I=e(93960),E=e(80543),x=(e(1535),e(57678),e(14007),e(62185)),L=e(10141),Z=e(60301),J=e(26894),H=e(43814),w=e(89713),j=e(8966),G=e(50318);const z=O=>{let n=class extends O{constructor(){super(...arguments),this.capabilities=void 0,this.copyright=null,this.fullExtent=null,this.legendEnabled=!0,this.spatialReference=null,this.version=void 0,this._allLayersAndTablesMap=null}readCapabilities(r,i){const p=i.capabilities&&i.capabilities.split(",").map(ee=>ee.toLowerCase().trim());if(!p)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};const _=this.type,c="tile"!==_&&!!i.supportsDynamicLayers,y=p.includes("query"),u=p.includes("map"),f=!!i.exportTilesAllowed,v=p.includes("tilemap"),R=p.includes("data"),T="tile"!==_&&(!i.tileInfo||c),V="tile"!==_&&(!i.tileInfo||c),C="tile"!==_,K=i.cimVersion&&I.G.parse(i.cimVersion),X=K?.since(1,4)??!1,Y=K?.since(2,0)??!1;return{operations:{supportsExportMap:u,supportsExportTiles:f,supportsIdentify:y,supportsQuery:R,supportsTileMap:v},exportMap:u?{supportsArcadeExpressionForLabeling:X,supportsSublayersChanges:C,supportsDynamicLayers:c,supportsSublayerVisibility:T,supportsSublayerDefinitionExpression:V,supportsCIMSymbols:Y}:null,exportTiles:f?{maxExportTilesCount:+i.maxExportTilesCount}:null}}readVersion(r,i){let p=i.currentVersion;return p||(p=i.hasOwnProperty("capabilities")||i.hasOwnProperty("tables")?10:i.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),p}fetchRelatedService(r){var i=this;return(0,b.Z)(function*(){const p=i.portalItem;if(!p||!(0,G.Fj)(p))return null;i._relatedFeatureServicePromise||(i._relatedFeatureServicePromise=p.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},r).then(c=>c.find(y=>"Feature Service"===y.type)??null,()=>null));const _=yield i._relatedFeatureServicePromise;return(0,U.k_)(r),_?{itemId:_.id,url:_.url}:null})()}fetchSublayerInfo(r,i){var p=this;return(0,b.Z)(function*(){const{source:_}=r;if(p?.portalItem&&"tile"===p.type&&"map-layer"===_?.type&&(0,G.Fj)(p.portalItem)&&r.originIdOf("url")<Z.s3.SERVICE){const u=yield p.fetchRelatedService(i);u&&(r.url=(0,P.v_)(u.url,_.mapLayerId.toString()),r.layerItemId=u.itemId)}const{url:c}=r;let y;if("data-layer"===_.type)y=(yield(0,F.Z)(c,{responseType:"json",query:{f:"json",...p.customParameters,token:p.apiKey},...i})).data;else if(c&&r.originIdOf("url")>Z.s3.SERVICE)try{const u=yield p._fetchAllLayersAndTablesFromService(c),f=(0,w.Qc)(c)?.sublayer??_.mapLayerId;y=u.get(f)}catch{}else{let u=r.id;"map-layer"===_?.type&&(u=_.mapLayerId);try{y=(yield p.fetchAllLayersAndTables(i)).get(u)}catch{}}return y})()}fetchAllLayersAndTables(r){var i=this;return(0,b.Z)(function*(){return i._fetchAllLayersAndTablesFromService(i.parsedUrl?.path,r)})()}_fetchAllLayersAndTablesFromService(r,i){var p=this;return(0,b.Z)(function*(){yield p.load(i),p._allLayersAndTablesMap||=new Map;const _=(0,w.Qc)(r),c=(0,B.s1)(p._allLayersAndTablesMap,_?.url.path,()=>(0,F.Z)((0,P.v_)(_?.url.path,"/layers"),{responseType:"json",query:{f:"json",...p.customParameters,token:p.apiKey}}).then(u=>{const f=new Map;for(const v of u.data.layers)f.set(v.id,v);return{result:f}},u=>({error:u}))),y=yield c;if((0,U.k_)(i),"result"in y)return y.result;throw y.error})()}};return(0,d._)([(0,E.Cb)({readOnly:!0})],n.prototype,"capabilities",void 0),(0,d._)([(0,x.r)("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],n.prototype,"readCapabilities",null),(0,d._)([(0,E.Cb)({json:{read:{source:"copyrightText"}}})],n.prototype,"copyright",void 0),(0,d._)([(0,E.Cb)({type:J.Z})],n.prototype,"fullExtent",void 0),(0,d._)([(0,E.Cb)(j.id)],n.prototype,"id",void 0),(0,d._)([(0,E.Cb)({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],n.prototype,"legendEnabled",void 0),(0,d._)([(0,E.Cb)(j.C_)],n.prototype,"popupEnabled",void 0),(0,d._)([(0,E.Cb)({type:H.Z})],n.prototype,"spatialReference",void 0),(0,d._)([(0,E.Cb)({readOnly:!0})],n.prototype,"version",void 0),(0,d._)([(0,x.r)("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],n.prototype,"readVersion",null),n=(0,d._)([(0,L.j)("esri.layers.mixins.ArcGISMapService")],n),n}},22921:($,W,e)=>{e.d(W,{x:()=>z});var b=e(50484),d=e(83944),F=e(5603),B=e(57964),U=e(4703),P=e(77675),I=e(80543),M=(e(1535),e(57678),e(14007),e(49301)),x=e(10141),L=e(60301),Z=e(25740),J=e(45859);const H=U.Z.getLogger("esri.layers.TileLayer"),j=d.Z.ofType(Z.Z);function G(O,n){O&&O.forEach(r=>{n(r),r.sublayers&&r.sublayers.length&&G(r.sublayers,n)})}const z=O=>{let n=class extends O{constructor(...r){super(...r),this.allSublayers=new F.Z({getCollections:()=>[this.sublayers],getChildrenFunction:i=>i.sublayers}),this.sublayersSourceJSON={[L.s3.SERVICE]:{},[L.s3.PORTAL_ITEM]:{},[L.s3.WEB_SCENE]:{},[L.s3.WEB_MAP]:{}},this.addHandles((0,P.YP)(()=>this.sublayers,(i,p)=>this._handleSublayersChange(i,p),P.Z_))}destroy(){this.allSublayers.destroy()}readSublayers(r,i){if(!i||!r)return;const{sublayersSourceJSON:p}=this,_=(0,L.M9)(i.origin);if(_<L.s3.SERVICE||(p[_]={context:i,visibleLayers:r.visibleLayers||p[_].visibleLayers,layers:r.layers||p[_].layers},_>L.s3.SERVICE))return;this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);const{sublayers:c,origin:y}=this.createSublayersForOrigin("web-document"),u=(0,M.vw)(this);u.setDefaultOrigin(y),this._set("sublayers",new j(c)),u.setDefaultOrigin("user")}findSublayerById(r){return this.allSublayers.find(i=>i.id===r)}createServiceSublayers(){return this.createSublayersForOrigin("service").sublayers}createSublayersForOrigin(r){const i=(0,L.M9)("web-document"===r?"web-map":r);let p=L.s3.SERVICE,_=this.sublayersSourceJSON[L.s3.SERVICE].layers,c=this.sublayersSourceJSON[L.s3.SERVICE].context,y=null;const u=[L.s3.PORTAL_ITEM,L.s3.WEB_SCENE,L.s3.WEB_MAP].filter(C=>C<=i);for(const C of u){const K=this.sublayersSourceJSON[C];(0,J.ac)(K.layers)&&(p=C,_=K.layers,c=K.context,K.visibleLayers&&(y={visibleLayers:K.visibleLayers,context:K.context}))}const f=[L.s3.PORTAL_ITEM,L.s3.WEB_SCENE,L.s3.WEB_MAP].filter(C=>C>p&&C<=i);let v=null;for(const C of f){const{layers:K,visibleLayers:X,context:Y}=this.sublayersSourceJSON[C];K&&(v={layers:K,context:Y}),X&&(y={visibleLayers:X,context:Y})}const R=function w(O,n){const r=[],i={};return O&&O.forEach(p=>{const _=new Z.Z;if(_.read(p,n),i[_.id]=_,null!=p.parentLayerId&&-1!==p.parentLayerId){const c=i[p.parentLayerId];c.sublayers||(c.sublayers=[]),c.sublayers.unshift(_)}else r.unshift(_)}),r}(_,c),T=new Map,V=new Set;if(v)for(const C of v.layers)T.set(C.id,C);if(y?.visibleLayers)for(const C of y.visibleLayers)V.add(C);return G(R,C=>{v&&C.read(T.get(C.id),v.context),y&&C.read({defaultVisibility:V.has(C.id)},y.context)}),{origin:(0,L.x3)(p),sublayers:new j({items:R})}}read(r,i){super.read(r,i),this.readSublayers(r,i)}_handleSublayersChange(r,i){i&&(i.forEach(p=>{p.parent=null,p.layer=null}),this.removeHandles("sublayers-owner")),r&&(r.forEach(p=>{p.parent=this,p.layer=this}),this.addHandles([r.on("after-add",({item:p})=>{p.parent=this,p.layer=this}),r.on("after-remove",({item:p})=>{p.parent=null,p.layer=null})],"sublayers-owner"),"tile"===this.type&&this.addHandles(r.on("before-changes",p=>{H.error(new B.Z("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:this})),p.preventDefault()}),"sublayers-owner"))}};return(0,b._)([(0,I.Cb)({readOnly:!0})],n.prototype,"allSublayers",void 0),(0,b._)([(0,I.Cb)({readOnly:!0,type:d.Z.ofType(Z.Z)})],n.prototype,"serviceSublayers",void 0),(0,b._)([(0,I.Cb)({value:null,type:j,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],n.prototype,"sublayers",void 0),(0,b._)([(0,I.Cb)({readOnly:!0})],n.prototype,"sublayersSourceJSON",void 0),n=(0,b._)([(0,x.j)("esri.layers.mixins.SublayersOwner")],n),n}},25740:($,W,e)=>{e.d(W,{Z:()=>Ee});var se,b=e(15861),d=e(50484),B=(e(2189),e(62691)),Z=(e(36699),e(15212),e(53722),e(82752),e(28999),e(38748),e(50923),e(42212),e(91963),e(41007)),J=e(66476),H=e(71950),w=e(83944),j=e(57964),G=e(14007),z=e(84373),O=e(34222),n=e(67016),r=e(4703),i=e(3233),p=e(38955),_=e(6785),c=e(80543),y=e(73018),u=e(62185),f=e(10141),v=e(7547),R=e(1535),T=e(60301),V=e(49301),C=e(59211),K=e(50243),X=e(81247),Y=e(40100),ee=e(40591),ne=e(75421),ie=e(39557),ae=e(37556),re=e(46054),te=e(59341),le=e(12768),ue=e(91866),de=e(33331),he=e(26894),ye=e(31709);function pe(t){return null!=t&&"esriSMS"===t.type}function ce(t,s,l){const g=this.originIdOf(s)>=(0,T.M9)(l.origin);return{ignoreOrigin:!0,allowNull:g,enabled:!!l&&"map-image"===l.layer?.type&&(l.writeSublayerStructure||g)}}function _e(t,s,l){return{enabled:!!l&&"tile"===l.layer?.type&&(l.origin&&this.originIdOf(s)>=(0,T.M9)(l.origin)||this._isOverridden(s))}}function Q(t,s,l){return{ignoreOrigin:!0,enabled:l&&l.writeSublayerStructure||!1}}function oe(t,s,l){return{ignoreOrigin:!0,enabled:!!l&&(l.writeSublayerStructure||this.originIdOf(s)>=(0,T.M9)(l.origin))}}let me=0;const k=new Set;k.add("layer"),k.add("parent"),k.add("loaded"),k.add("loadStatus"),k.add("loadError"),k.add("loadWarnings");let h=se=class extends((0,i.R)((0,z.IG)(n.Z))){constructor(t){super(t),this.capabilities=void 0,this.maxScaleRange={minScale:0,maxScale:0},this.fields=null,this.fullExtent=null,this.geometryType=null,this.globalIdField=null,this.legendEnabled=!0,this.objectIdField=null,this.parent=null,this.popupEnabled=!0,this.popupTemplate=null,this.sourceJSON=null,this.title=null,this.typeIdField=null,this.type="sublayer",this.types=null,this._lastParsedUrl=null}load(t){var s=this;return(0,b.Z)(function*(){return s.addResolvingPromise((0,b.Z)(function*(){const{layer:l,url:g}=s;if(!l&&!g)throw new j.Z("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:s});const m=l?yield l.fetchSublayerInfo(s,t):(yield(0,J.Z)(g,{responseType:"json",query:{f:"json"},...t})).data;m&&(s.sourceJSON=m,s.read({layerDefinition:m},{origin:"service"}))})()),s})()}readCapabilities(t,s){s=s.layerDefinition||s;const{operations:{supportsQuery:l,supportsQueryAttachments:g},query:{supportsFormatPBF:m},data:{supportsAttachment:A}}=(0,ae.h)(s,this.url);return{exportMap:{supportsModification:!!s.canModifyLayer},operations:{supportsQuery:l,supportsQueryAttachments:g},data:{supportsAttachment:A},query:{supportsFormatPBF:m}}}get defaultPopupTemplate(){return this.createPopupTemplate()}set definitionExpression(t){this._setAndNotifyLayer("definitionExpression",t)}get effectiveScaleRange(){const{minScale:t,maxScale:s}=this;return{minScale:t,maxScale:s}}readMaxScaleRange(t,s){return{minScale:(s=s.layerDefinition||s).minScale??0,maxScale:s.maxScale??0}}get fieldsIndex(){return new Y.Z(this.fields||[])}set floorInfo(t){this._setAndNotifyLayer("floorInfo",t)}readGlobalIdFieldFromService(t,s){if((s=s.layerDefinition||s).globalIdField)return s.globalIdField;if(s.fields)for(const l of s.fields)if("esriFieldTypeGlobalID"===l.type)return l.name}get id(){return this._get("id")??me++}set id(t){this._get("id")!==t&&(!1!==this.layer?.capabilities?.exportMap?.supportsDynamicLayers?this._set("id",t):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"))}set labelingInfo(t){this._setAndNotifyLayer("labelingInfo",t)}writeLabelingInfo(t,s,l,g){t&&t.length&&(s.layerDefinition={drawingInfo:{labelingInfo:t.map(m=>m.write({},g))}})}set labelsVisible(t){this._setAndNotifyLayer("labelsVisible",t)}set layer(t){this._set("layer",t),this.sublayers&&this.sublayers.forEach(s=>s.layer=t)}set listMode(t){this._set("listMode",t)}set minScale(t){this._setAndNotifyLayer("minScale",t)}readMinScale(t,s){return s.minScale||s.layerDefinition?.minScale||0}set maxScale(t){this._setAndNotifyLayer("maxScale",t)}readMaxScale(t,s){return s.maxScale||s.layerDefinition?.maxScale||0}readObjectIdFieldFromService(t,s){if((s=s.layerDefinition||s).objectIdField)return s.objectIdField;if(s.fields)for(const l of s.fields)if("esriFieldTypeOID"===l.type)return l.name}set opacity(t){this._setAndNotifyLayer("opacity",t)}readOpacity(t,s){const l=s.layerDefinition;return 1-.01*((null!=l?.transparency?l.transparency:l?.drawingInfo?.transparency)??0)}writeOpacity(t,s,l,g){s.layerDefinition={drawingInfo:{transparency:100-100*t}}}writeParent(t,s){s.parentLayerId=this.parent&&this.parent!==this.layer?(0,R.vU)(this.parent.id):-1}get queryTask(){if(!this.layer)return null;const{spatialReference:t}=this.layer,s="gdbVersion"in this.layer?this.layer.gdbVersion:void 0,{capabilities:l,fieldsIndex:g}=this,m=(0,G.Z)("featurelayer-pbf")&&l?.query.supportsFormatPBF;return new C.Z({url:this.url,pbfSupported:m,fieldsIndex:g,gdbVersion:s,sourceSpatialReference:t,queryAttachmentsSupported:l?.operations?.supportsQueryAttachments??!1})}set renderer(t){if(t)for(const s of t.getSymbols())if((0,H.dU)(s)){r.Z.getLogger(this).warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",t)}get source(){return this._get("source")||new te.R({mapLayerId:this.id})}set source(t){this._setAndNotifyLayer("source",t)}set sublayers(t){this._handleSublayersChange(t,this._get("sublayers")),this._set("sublayers",t)}castSublayers(t){return(0,R.se)(w.Z.ofType(se),t)}writeSublayers(t,s,l){this.sublayers?.length&&(s[l]=this.sublayers.map(g=>g.id).toArray().reverse())}readTitle(t,s){return s.layerDefinition?.name??s.name}readTypeIdField(t,s){let l=(s=s.layerDefinition||s).typeIdField;if(l&&s.fields){l=l.toLowerCase();const g=s.fields.find(m=>m.name.toLowerCase()===l);g&&(l=g.name)}return l}get url(){const t=this.layer?.parsedUrl??this._lastParsedUrl,s=this.source;if(!t)return null;if(this._lastParsedUrl=t,"map-layer"===s?.type)return`${t.path}/${s.mapLayerId}`;const l={layer:JSON.stringify({source:this.source})};return`${t.path}/dynamicLayer?${(0,_.B7)(l)}`}set url(t){this._overrideIfSome("url",t)}set visible(t){this._setAndNotifyLayer("visible",t)}writeVisible(t,s,l,g){s[l]=this.getAtOrigin("defaultVisibility","service")||t}clone(){const{store:t}=(0,V.vw)(this),s=new se;return(0,V.vw)(s).store=t.clone(k),this.commitProperty("url"),s._lastParsedUrl=this._lastParsedUrl,s}createPopupTemplate(t){return(0,de.eZ)(this,t)}createQuery(){return new ue.Z({returnGeometry:!0,where:this.definitionExpression||"1=1"})}createFeatureLayer(){var t=this;return(0,b.Z)(function*(){if(t.hasOwnProperty("sublayers"))return null;const s=(yield Promise.resolve().then(e.bind(e,90373))).default,{layer:l,url:g}=t;let m;if(g&&t.originIdOf("url")>T.s3.SERVICE)m=new s({url:g});else{if(!l?.parsedUrl)throw new j.Z("createFeatureLayer:missing-information","Cannot create a FeatureLayer without a url or a parent layer");{const A=l.parsedUrl;m=new s({url:A.path}),A&&t.source&&("map-layer"===t.source.type?m.layerId=t.source.mapLayerId:m.dynamicDataSource=t.source)}}return null!=l?.refreshInterval&&(m.refreshInterval=l.refreshInterval),t.definitionExpression&&(m.definitionExpression=t.definitionExpression),t.floorInfo&&(m.floorInfo=(0,O.d9)(t.floorInfo)),t.originIdOf("labelingInfo")>T.s3.SERVICE&&(m.labelingInfo=(0,O.d9)(t.labelingInfo)),t.originIdOf("labelsVisible")>T.s3.DEFAULTS&&(m.labelsVisible=t.labelsVisible),t.originIdOf("legendEnabled")>T.s3.DEFAULTS&&(m.legendEnabled=t.legendEnabled),t.originIdOf("visible")>T.s3.DEFAULTS&&(m.visible=t.visible),t.originIdOf("minScale")>T.s3.DEFAULTS&&(m.minScale=t.minScale),t.originIdOf("maxScale")>T.s3.DEFAULTS&&(m.maxScale=t.maxScale),t.originIdOf("opacity")>T.s3.DEFAULTS&&(m.opacity=t.opacity),t.originIdOf("popupTemplate")>T.s3.DEFAULTS&&(m.popupTemplate=(0,O.d9)(t.popupTemplate)),t.originIdOf("renderer")>T.s3.SERVICE&&(m.renderer=(0,O.d9)(t.renderer)),"data-layer"===t.source?.type&&(m.dynamicDataSource=t.source.clone()),t.originIdOf("title")>T.s3.DEFAULTS&&(m.title=t.title),"map-image"===l?.type&&l.originIdOf("customParameters")>T.s3.DEFAULTS&&(m.customParameters=l.customParameters),"tile"===l?.type&&l.originIdOf("customParameters")>T.s3.DEFAULTS&&(m.customParameters=l.customParameters),m})()}getField(t){return this.fieldsIndex.get(t)}getFeatureType(t){const{typeIdField:s,types:l}=this;if(!s||!t)return null;const g=t.attributes?t.attributes[s]:void 0;if(null==g)return null;let m=null;return l?.some(A=>{const{id:N}=A;return null!=N&&(N.toString()===g.toString()&&(m=A),!!m)}),m}getFieldDomain(t,s){const l=s?.feature,g=this.getFeatureType(l);if(g){const m=g.domains&&g.domains[t];if(m&&"inherited"!==m.type)return m}return this._getLayerDomain(t)}queryAttachments(t,s){var l=this;return(0,b.Z)(function*(){yield l.load(),t=le.Z.from(t);const g=l.capabilities;if(!g?.data?.supportsAttachment)throw new j.Z("queryAttachments:not-supported","this layer doesn't support attachments");const{attachmentTypes:m,objectIds:A,globalIds:N,num:q,size:ge,start:ve,where:fe}=t;if(!g?.operations?.supportsQueryAttachments&&(m?.length>0||N?.length>0||ge?.length>0||q||ve||fe))throw new j.Z("queryAttachments:option-not-supported","when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",t);if(!(A?.length||N?.length||fe))throw new j.Z("queryAttachments:invalid-query","'objectIds', 'globalIds', or 'where' are required to perform attachment query",t);return l.queryTask.executeAttachmentQuery(t,s)})()}queryFeatures(t=this.createQuery(),s){var l=this;return(0,b.Z)(function*(){if(yield l.load(),!l.capabilities.operations.supportsQuery)throw new j.Z("queryFeatures:not-supported","this layer doesn't support queries.");if(!l.url)throw new j.Z("queryFeatures:not-supported","this layer has no url.");const g=yield l.queryTask.execute(t,{...s,query:{...l.layer?.customParameters,token:l.layer?.apiKey}});if(g?.features)for(const m of g.features)m.sourceLayer=l;return g})()}toExportImageJSON(t){const s={id:this.id,source:this.source?.toJSON()||{mapLayerId:this.id,type:"mapLayer"}},l=(0,p._)(t,this.definitionExpression);null!=l&&(s.definitionExpression=l);const g=["renderer","labelingInfo","opacity","labelsVisible"].reduce((A,N)=>(A[N]=this.originIdOf(N),A),{});if(Object.keys(g).some(A=>g[A]>T.s3.SERVICE)){const A=s.drawingInfo={};if(g.renderer>T.s3.SERVICE&&(A.renderer=this.renderer?this.renderer.toJSON():null),g.labelsVisible>T.s3.SERVICE&&(A.showLabels=this.labelsVisible),this.labelsVisible&&g.labelingInfo>T.s3.SERVICE)if(this.labelingInfo){!this.loaded&&this.labelingInfo?.some(q=>!q.labelPlacement)&&r.Z.getLogger(this).warnOnce(`A Sublayer (title: ${this.title}, id: ${this.id}) has an undefined 'labelPlacement' and so labels cannot be displayed. Either define a valid 'labelPlacement' or call Sublayer.load() to use a default value based on geometry type.`,{sublayer:this});let N=this.labelingInfo;null!=this.geometryType&&(N=(0,ne.a)(this.labelingInfo,ye.M.toJSON(this.geometryType))),A.showLabels=!0,A.labelingInfo=N.filter(q=>q.labelPlacement).map(q=>q.toJSON({origin:"service",layer:this.layer}))}else A.showLabels=!1;g.opacity>T.s3.SERVICE&&(A.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(A.renderer)}return s}_assignDefaultSymbolColors(t){this._forEachSimpleMarkerSymbols(t,s=>{s.color||"esriSMSX"!==s.style&&"esriSMSCross"!==s.style||(s.color=s.outline?.color?s.outline.color:[0,0,0,0])})}_forEachSimpleMarkerSymbols(t,s){if(t){const l=("uniqueValueInfos"in t?t.uniqueValueInfos:"classBreakInfos"in t?t.classBreakInfos:null)??[];for(const g of l)pe(g.symbol)&&s(g.symbol);"symbol"in t&&pe(t.symbol)&&s(t.symbol),"defaultSymbol"in t&&pe(t.defaultSymbol)&&s(t.defaultSymbol)}}_setAndNotifyLayer(t,s){const l=this.layer,g=this._get(t);let m,A;switch(t){case"definitionExpression":case"floorInfo":m="supportsSublayerDefinitionExpression";break;case"minScale":case"maxScale":case"visible":m="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":m="supportsDynamicLayers",A="supportsModification"}const N=(0,V.vw)(this).getDefaultOrigin();if("service"!==N){if(m&&!1===this.layer?.capabilities?.exportMap?.[m])return void this._logLockedError(t,`capability not available 'layer.capabilities.exportMap.${m}'`);if(A&&!1===this.capabilities?.exportMap[A])return void this._logLockedError(t,`capability not available 'capabilities.exportMap.${A}'`)}"source"!==t||"not-loaded"===this.loadStatus?(this._set(t,s),"service"!==N&&g!==s&&l&&l.emit&&l.emit("sublayer-update",{propertyName:t,target:this})):this._logLockedError(t,"'source' can't be changed after calling sublayer.load()")}_handleSublayersChange(t,s){s&&(s.forEach(l=>{l.parent=null,l.layer=null}),this.removeAllHandles()),t&&(t.forEach(l=>{l.parent=this,l.layer=this.layer}),this.addHandles([t.on("after-add",({item:l})=>{l.parent=this,l.layer=this.layer}),t.on("after-remove",({item:l})=>{l.parent=null,l.layer=null}),t.on("before-changes",l=>{const g=this.layer?.capabilities?.exportMap?.supportsSublayersChanges;null==g||g||(r.Z.getLogger(this).error(new j.Z("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),l.preventDefault())})]))}_logLockedError(t,s){const{layer:l,declaredClass:g}=this;r.Z.getLogger(g).error(new j.Z("sublayer:locked",`Property '${String(t)}' can't be changed on Sublayer from the layer '${l?.id}'`,{reason:s,sublayer:this,layer:l}))}_getLayerDomain(t){const s=this.fieldsIndex.get(t);return s?s.domain:null}};h.test={isMapImageLayerOverridePolicy:t=>t===Q||t===ce,isTileImageLayerOverridePolicy:t=>t===_e},(0,d._)([(0,c.Cb)({readOnly:!0})],h.prototype,"capabilities",void 0),(0,d._)([(0,u.r)("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],h.prototype,"readCapabilities",null),(0,d._)([(0,c.Cb)()],h.prototype,"defaultPopupTemplate",null),(0,d._)([(0,c.Cb)({type:String,value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:ce}}})],h.prototype,"definitionExpression",null),(0,d._)([(0,c.Cb)({readOnly:!0})],h.prototype,"effectiveScaleRange",null),(0,d._)([(0,u.r)("service","maxScaleRange",["minScale","maxScale"])],h.prototype,"readMaxScaleRange",null),(0,d._)([(0,c.Cb)({type:[X.Z],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],h.prototype,"fields",void 0),(0,d._)([(0,c.Cb)({readOnly:!0})],h.prototype,"fieldsIndex",null),(0,d._)([(0,c.Cb)({type:ie.Z,value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",overridePolicy:ce},origins:{"web-scene":{read:!1,write:!1}}}})],h.prototype,"floorInfo",null),(0,d._)([(0,c.Cb)({type:he.Z,json:{read:{source:"layerDefinition.extent"}}})],h.prototype,"fullExtent",void 0),(0,d._)([(0,c.Cb)({type:ye.M.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:ye.M.read}}}}})],h.prototype,"geometryType",void 0),(0,d._)([(0,c.Cb)({type:String})],h.prototype,"globalIdField",void 0),(0,d._)([(0,u.r)("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],h.prototype,"readGlobalIdFieldFromService",null),(0,d._)([(0,c.Cb)({type:R.z8,json:{write:{ignoreOrigin:!0}}})],h.prototype,"id",null),(0,d._)([(0,c.Cb)({value:null,type:[ee.Z],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:Q}}})],h.prototype,"labelingInfo",null),(0,d._)([(0,v.c)("labelingInfo")],h.prototype,"writeLabelingInfo",null),(0,d._)([(0,c.Cb)({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:Q}}})],h.prototype,"labelsVisible",null),(0,d._)([(0,c.Cb)({value:null})],h.prototype,"layer",null),(0,d._)([(0,c.Cb)({type:String,json:{write:{overridePolicy:_e}}})],h.prototype,"layerItemId",void 0),(0,d._)([(0,c.Cb)({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:oe}}})],h.prototype,"legendEnabled",void 0),(0,d._)([(0,c.Cb)({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],h.prototype,"listMode",null),(0,d._)([(0,c.Cb)({type:Number,value:0,json:{write:{overridePolicy:Q}}})],h.prototype,"minScale",null),(0,d._)([(0,u.r)("minScale",["minScale","layerDefinition.minScale"])],h.prototype,"readMinScale",null),(0,d._)([(0,c.Cb)({type:Number,value:0,json:{write:{overridePolicy:Q}}})],h.prototype,"maxScale",null),(0,d._)([(0,u.r)("maxScale",["maxScale","layerDefinition.maxScale"])],h.prototype,"readMaxScale",null),(0,d._)([(0,c.Cb)({type:String})],h.prototype,"objectIdField",void 0),(0,d._)([(0,u.r)("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],h.prototype,"readObjectIdFieldFromService",null),(0,d._)([(0,c.Cb)({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:Q}}})],h.prototype,"opacity",null),(0,d._)([(0,u.r)("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],h.prototype,"readOpacity",null),(0,d._)([(0,v.c)("opacity")],h.prototype,"writeOpacity",null),(0,d._)([(0,c.Cb)({json:{type:R.z8,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:Q}}})],h.prototype,"parent",void 0),(0,d._)([(0,v.c)("parent")],h.prototype,"writeParent",null),(0,d._)([(0,c.Cb)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(t,s)=>!s.disablePopup},write:{target:"disablePopup",overridePolicy:oe,writer(t,s,l){s[l]=!t}}}})],h.prototype,"popupEnabled",void 0),(0,d._)([(0,c.Cb)({type:B.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:oe}}})],h.prototype,"popupTemplate",void 0),(0,d._)([(0,c.Cb)({readOnly:!0})],h.prototype,"queryTask",null),(0,d._)([(0,c.Cb)({types:Z.A,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Q},origins:{"web-scene":{types:Z.o,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Q}}}}})],h.prototype,"renderer",null),(0,d._)([(0,c.Cb)({types:{key:"type",base:null,typeMap:{"data-layer":re.n,"map-layer":te.R}},cast(t){if(t){if("mapLayerId"in t)return(0,R.TJ)(te.R,t);if("dataSource"in t)return(0,R.TJ)(re.n,t)}return t},json:{name:"layerDefinition.source",write:{overridePolicy:Q}}})],h.prototype,"source",null),(0,d._)([(0,c.Cb)()],h.prototype,"sourceJSON",void 0),(0,d._)([(0,c.Cb)({value:null,json:{type:[R.z8],write:{target:"subLayerIds",allowNull:!0,overridePolicy:Q}}})],h.prototype,"sublayers",null),(0,d._)([(0,y.p)("sublayers")],h.prototype,"castSublayers",null),(0,d._)([(0,v.c)("sublayers")],h.prototype,"writeSublayers",null),(0,d._)([(0,c.Cb)({type:String,json:{name:"name",write:{overridePolicy:oe}}})],h.prototype,"title",void 0),(0,d._)([(0,u.r)("service","title",["name","layerDefinition.name"])],h.prototype,"readTitle",null),(0,d._)([(0,c.Cb)({type:String})],h.prototype,"typeIdField",void 0),(0,d._)([(0,c.Cb)({json:{read:!1},readOnly:!0,value:"sublayer"})],h.prototype,"type",void 0),(0,d._)([(0,u.r)("typeIdField",["layerDefinition.typeIdField"])],h.prototype,"readTypeIdField",null),(0,d._)([(0,c.Cb)({type:[K.Z],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],h.prototype,"types",void 0),(0,d._)([(0,c.Cb)({type:String,json:{name:"layerUrl",write:{overridePolicy:_e}}})],h.prototype,"url",null),(0,d._)([(0,c.Cb)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:Q}}})],h.prototype,"visible",null),(0,d._)([(0,v.c)("visible")],h.prototype,"writeVisible",null),h=se=(0,d._)([(0,f.j)("esri.layers.support.Sublayer")],h);const Ee=h},53715:($,W,e)=>{e.d(W,{V:()=>P,g:()=>B});var b=e(15861),d=e(57964),F=e(79412);function B(E,S,D){return U.apply(this,arguments)}function U(){return(U=(0,b.Z)(function*(E,S,D){let M;try{M=yield createImageBitmap(E)}catch(x){throw new d.Z("request:server",`Unable to load ${S}`,{url:S,error:x})}return(0,F.k_)(D),M})).apply(this,arguments)}function P(E,S,D,M,x){return I.apply(this,arguments)}function I(){return(I=(0,b.Z)(function*(E,S,D,M,x){let L;try{L=yield createImageBitmap(E)}catch(Z){throw new d.Z("request:server",`Unable to load tile ${S}/${D}/${M}`,{error:Z,level:S,row:D,col:M})}return(0,F.k_)(x),L})).apply(this,arguments)}},45859:($,W,e)=>{e.d(W,{FN:()=>F,QV:()=>d,ac:()=>U});var b=e(60301);function d(P,I,E){return I.flatten(({sublayers:D})=>D).length!==P.length||!!P.some(D=>D.originIdOf("minScale")>E||D.originIdOf("maxScale")>E||D.originIdOf("renderer")>E||D.originIdOf("labelingInfo")>E||D.originIdOf("opacity")>E||D.originIdOf("labelsVisible")>E||D.originIdOf("source")>E)||!B(P,I)}function F(P,I,E){return!!P.some(S=>{const D=S.source;return!(!D||"map-layer"===D.type&&D.mapLayerId===S.id&&(null==D.gdbVersion||D.gdbVersion===E))||S.originIdOf("renderer")>b.s3.SERVICE||S.originIdOf("labelingInfo")>b.s3.SERVICE||S.originIdOf("opacity")>b.s3.SERVICE||S.originIdOf("labelsVisible")>b.s3.SERVICE})||!B(P,I)}function B(P,I){if(!P?.length||null==I)return!0;const E=I.slice().reverse().flatten(({sublayers:M})=>M&&M.toArray().reverse()).map(M=>M.id).toArray();if(P.length>E.length)return!1;let S=0;const D=E.length;for(const{id:M}of P){for(;S<D&&E[S]!==M;)S++;if(S>=D)return!1}return!0}function U(P){return!!P&&P.some(I=>null!=I.minScale||null!=I.layerDefinition?.minScale)}},24859:($,W,e)=>{e.d(W,{P:()=>U});var b=e(15861),d=e(15462),F=e(82784),B=e(91866);function U(I,E,S){return P.apply(this,arguments)}function P(){return(P=(0,b.Z)(function*(I,E,S){const D=(0,d.en)(I);return(0,F.hH)(D,B.Z.from(E),{...S}).then(M=>M.data.count)})).apply(this,arguments)}},61375:($,W,e)=>{e.d(W,{G:()=>U});var b=e(15861),d=e(15462),F=e(82784),B=e(91866);function U(I,E,S){return P.apply(this,arguments)}function P(){return(P=(0,b.Z)(function*(I,E,S){const D=(0,d.en)(I);return(0,F.Ev)(D,B.Z.from(E),{...S}).then(M=>M.data.objectIds)})).apply(this,arguments)}},46708:($,W,e)=>{e.d(W,{F:()=>E,e:()=>P});var b=e(15861),d=e(15462),F=e(82784),B=e(93792),U=e(91866);function P(D,M,x){return I.apply(this,arguments)}function I(){return(I=(0,b.Z)(function*(D,M,x){const L=yield E(D,M,x);return B.Z.fromJSON(L)})).apply(this,arguments)}function E(D,M,x){return S.apply(this,arguments)}function S(){return(S=(0,b.Z)(function*(D,M,x){const L=(0,d.en)(D),Z={...x},J=U.Z.from(M),{data:H}=yield(0,F.JT)(L,J,J.sourceSpatialReference,Z);return H})).apply(this,arguments)}},36026:($,W,e)=>{e.d(W,{t:()=>G});var b=e(15861),d=e(15462),F=e(51172),B=e(53456),U=e(10842);function P(O,n){return n}function I(O,n,r,i){switch(r){case 0:return M(O,n+i,0);case 1:return"lowerLeft"===O.originPosition?M(O,n+i,1):function x({translate:O,scale:n},r,i){return O[i]-r*n[i]}(O,n+i,1)}}function E(O,n,r,i){return 2===r?M(O,n,2):I(O,n,r,i)}function S(O,n,r,i){return 2===r?M(O,n,3):I(O,n,r,i)}function D(O,n,r,i){return 3===r?M(O,n,3):E(O,n,r,i)}function M({translate:O,scale:n},r,i){return O[i]+r*n[i]}class L{constructor(n){this._options=n,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=P,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(n){if(this._options.applyTransform&&(n.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!n.hasZ)return;const r=(0,B.k)(n.geometryType,this._options.sourceSpatialReference,n.spatialReference);if(null!=r)for(const i of n.features)r(i.geometry)}createSpatialReference(){return{}}addField(n,r){const i=n.fields;(0,F.O3)(i),i.push(r);const p=i.map(_=>_.name);this._attributesConstructor=function(){for(const _ of p)this[_]=null}}addFeature(n,r){n.features.push(r)}prepareFeatures(n){switch(this._transform=n.transform,this._options.applyTransform&&n.transform&&(this._applyTransform=this._deriveApplyTransform(n)),this._vertexDimension=2,n.hasZ&&this._vertexDimension++,n.hasM&&this._vertexDimension++,n.geometryType){case"esriGeometryPoint":this.addCoordinate=(r,i,p)=>this.addCoordinatePoint(r,i,p),this.createGeometry=r=>this.createPointGeometry(r);break;case"esriGeometryPolygon":this.addCoordinate=(r,i,p)=>this._addCoordinatePolygon(r,i,p),this.createGeometry=r=>this._createPolygonGeometry(r);break;case"esriGeometryPolyline":this.addCoordinate=(r,i,p)=>this._addCoordinatePolyline(r,i,p),this.createGeometry=r=>this._createPolylineGeometry(r);break;case"esriGeometryMultipoint":this.addCoordinate=(r,i,p)=>this._addCoordinateMultipoint(r,i,p),this.createGeometry=r=>this._createMultipointGeometry(r)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(n,r,i){0===this._lengths.length&&(this._toAddInCurrentPath=r),this._lengths.push(r)}addQueryGeometry(n,r){const{queryGeometry:i,queryGeometryType:p}=r,_=(0,U.$g)(i.clone(),i,!1,!1,this._transform),c=(0,U.di)(_,p,!1,!1);n.queryGeometryType=p,n.queryGeometry={...c}}createPointGeometry(n){const r={x:0,y:0,spatialReference:n.spatialReference};return n.hasZ&&(r.z=0),n.hasM&&(r.m=0),r}addCoordinatePoint(n,r,i){switch(r=this._applyTransform(this._transform,r,i,0),i){case 0:n.x=r;break;case 1:n.y=r;break;case 2:"z"in n?n.z=r:n.m=r;break;case 3:n.m=r}}_transformPathLikeValue(n,r){let i=0;return r<=1&&(i=this._previousCoordinate[r],this._previousCoordinate[r]+=n),this._applyTransform(this._transform,n,r,i)}_addCoordinatePolyline(n,r,i){this._dehydratedAddPointsCoordinate(n.paths,r,i)}_addCoordinatePolygon(n,r,i){this._dehydratedAddPointsCoordinate(n.rings,r,i)}_addCoordinateMultipoint(n,r,i){0===i&&n.points.push([]);const p=this._transformPathLikeValue(r,i);n.points[n.points.length-1].push(p)}_createPolygonGeometry(n){return{rings:[[]],spatialReference:n.spatialReference,hasZ:!!n.hasZ,hasM:!!n.hasM}}_createPolylineGeometry(n){return{paths:[[]],spatialReference:n.spatialReference,hasZ:!!n.hasZ,hasM:!!n.hasM}}_createMultipointGeometry(n){return{points:[],spatialReference:n.spatialReference,hasZ:!!n.hasZ,hasM:!!n.hasM}}_dehydratedAddPointsCoordinate(n,r,i){0===i&&0==this._toAddInCurrentPath--&&(n.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const p=this._transformPathLikeValue(r,i),_=n[n.length-1];0===i&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),_.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=p}_deriveApplyTransform(n){const{hasZ:r,hasM:i}=n;return r&&i?D:r?E:i?S:I}}var Z=e(82784),H=(e(93792),e(91866));function G(O,n,r){return z.apply(this,arguments)}function z(){return(z=(0,b.Z)(function*(O,n,r){const i=(0,d.en)(O),p={...r},_=H.Z.from(n),c=!_.quantizationParameters,{data:y}=yield(0,Z.qp)(i,_,new L({sourceSpatialReference:_.sourceSpatialReference,applyTransform:c}),p);return y})).apply(this,arguments)}}}]);