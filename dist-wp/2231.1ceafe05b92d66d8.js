"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[2231],{90295:(C,A,s)=>{s.d(A,{Z:()=>d});class d{constructor(y){this.size=0,this._start=0,this.maxSize=y,this._buffer=new Array(y)}get entries(){return this._buffer}enqueue(y){if(this.size===this.maxSize){const T=this._buffer[this._start];return this._buffer[this._start]=y,this._start=(this._start+1)%this.maxSize,T}return this._buffer[(this._start+this.size++)%this.maxSize]=y,null}dequeue(){if(0===this.size)return null;const y=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,y}peek(){return 0===this.size?null:this._buffer[this._start]}find(y){if(0===this.size)return null;for(const T of this._buffer)if(null!=T&&y(T))return T;return null}clear(y){let T=this.dequeue();for(;null!=T;)y&&y(T),T=this.dequeue()}}},29085:(C,A,s)=>{s.d(A,{EG:()=>D,Op:()=>c,S2:()=>_});var d=s(10842),G=s(62209);const y=new G.Z,T=new G.Z,F=new G.Z,I={esriGeometryPoint:d.fQ,esriGeometryPolyline:d.J6,esriGeometryPolygon:d.eG,esriGeometryMultipoint:d.Iv};function D(l,o,a,h=l.hasZ,O=l.hasM){if(null==o)return null;const R=l.hasZ&&h,b=l.hasM&&O;if(a){const P=(0,d.Nh)(F,o,l.hasZ,l.hasM,"esriGeometryPoint",a,h,O);return(0,d.fQ)(P,R,b)}return(0,d.fQ)(o,R,b)}function c(l,o,a,h,O,R,b=o,P=a){const i=o&&b,n=a&&P,t=null!=h?"coords"in h?h:h.geometry:null;if(null==t)return null;if(O){let u=(0,d.zj)(T,t,o,a,l,O,b,P);return R&&(u=(0,d.Nh)(F,u,i,n,l,R)),I[l]?.(u,i,n)??null}if(R){const u=(0,d.Nh)(F,t,o,a,l,R,b,P);return I[l]?.(u,i,n)??null}return(0,d.hY)(y,t,o,a,b,P),I[l]?.(y,i,n)??null}function _(l){return l&&m in l?JSON.parse(JSON.stringify(l,f)):l}const m="_geVersion",f=(l,o)=>l!==m?o:void 0},44452:(C,A,s)=>{s.d(A,{Ti:()=>f,Up:()=>l,j6:()=>a});var d=s(15861),G=s(84303),y=s(49602),T=s(83821),F=s(14138),I=s(40637),D=s(93566),c=s(33721),_=s(58829);const m=new G.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),f=Object.freeze({});function l(t,u,v){return o.apply(this,arguments)}function o(){return(o=(0,d.Z)(function*(t,u,v){const{outFields:S,orderByFields:p,groupByFieldsForStatistics:U,outStatistics:r}=t;if(S)for(let e=0;e<S.length;e++)S[e]=S[e].trim();if(p)for(let e=0;e<p.length;e++)p[e]=p[e].trim();if(U)for(let e=0;e<U.length;e++)U[e]=U[e].trim();if(r)for(let e=0;e<r.length;e++)r[e].onStatisticField&&(r[e].onStatisticField=r[e].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),a(t,u,v)})).apply(this,arguments)}function a(t,u,v){return h.apply(this,arguments)}function h(){return h=(0,d.Z)(function*(t,u,v){if(!t)return null;let{where:S}=t;if(t.where=S=S?.trim(),(!S||/^1 *= *1$/.test(S)||u&&u===S)&&(t.where=null),!t.geometry)return t;let p=yield function b(t){return P.apply(this,arguments)}(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:U}=t.geometry;p=(0,F.aO)(p),p.spatialReference=U}if(p){yield(0,_._W)(p.spatialReference,v),p=function R(t,u){const v=t.spatialReference;return O(t,u)&&(0,I.YX)(t)?{spatialReference:v,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:t}(p,v);const U=(yield(0,D.aX)((0,I.im)(p)))[0];if(null==U)throw f;const r="quantizationParameters"in t&&t.quantizationParameters?.tolerance||"maxAllowableOffset"in t&&t.maxAllowableOffset||0,e=r&&O(p,v)?{densificationStep:8*r}:void 0,g=U.toJSON(),E=(0,_.iV)(g,g.spatialReference,v,e);if(!E)throw f;E.spatialReference=v,t.geometry=E}return t}),h.apply(this,arguments)}function O(t,u){if(!t)return!1;const v=t.spatialReference;return((0,I.YX)(t)||(0,I.oU)(t)||(0,I.l9)(t))&&!(0,c.fS)(v,u)&&!(0,T.canProjectWithoutEngine)(v,u)}function P(){return P=(0,d.Z)(function*(t){const{distance:u,units:v}=t,S=t.geometry;if(null==u||"vertexAttributes"in S)return S;const p=S.spatialReference,U=v?m.fromJSON(v):(0,y.qE)(p),r=p&&((0,c.sT)(p)||(0,c.sS)(p))?S:yield(0,_._W)(p,c.Zn).then(()=>(0,_.iV)(S,c.Zn));return(yield function i(){return n.apply(this,arguments)}())(r.spatialReference,r,u,U)}),P.apply(this,arguments)}function n(){return(n=(0,d.Z)(function*(){return(yield Promise.all([s.e(9465),s.e(8592)]).then(s.bind(s,49574))).geodesicBuffer})).apply(this,arguments)}},51089:(C,A,s)=>{s.d(A,{hN:()=>U,P0:()=>S,cW:()=>v});var d=s(15861),G=s(57964),y=s(5825),T=s(26230),I=s(40637),D=s(33721);function c(r,e){return r?e?4:3:e?3:2}function f(r,e,g,E,j){if(!r)return!1;const x=c(e,g),{coords:M,lengths:w}=r;let Z=!1,B=0;for(const N of w)Z=l(Z,M,x,B,N,E,j),B+=N*x;return Z}function l(r,e,g,E,j,x,M){let w=r,Z=E;for(let B=E,N=E+j*g;B<N;B+=g){Z=B+g,Z===N&&(Z=E);const L=e[B],z=e[B+1],W=e[Z+1];(z<M&&W>=M||W<M&&z>=M)&&L+(M-z)/(W-z)*(e[Z]-L)<x&&(w=!w)}return w}var o=s(10842),a=s(62209),h=s(29085),O=s(58829);const R="unsupported-query",b={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},P={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function v(r,e,g,E,j){if((0,I.oU)(e)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r)){const x=(0,o.Uy)(new a.Z,e,!1,!1);return Promise.resolve(M=>function _(r,e,g,E){return f(r,e,g,E.coords[0],E.coords[1])}(x,!1,!1,M))}if((0,I.oU)(e)&&"esriGeometryMultipoint"===g){const x=(0,o.Uy)(new a.Z,e,!1,!1);if("esriSpatialRelContains"===r)return Promise.resolve(M=>function m(r,e,g,E,j,x){const M=c(j,x),{coords:w,lengths:Z}=E;if(!Z)return!1;for(let B=0,N=0;B<Z.length;B++,N+=M)if(!f(r,e,g,w[N],w[N+1]))return!1;return!0}(x,!1,!1,M,E,j))}if((0,I.YX)(e)&&"esriGeometryPoint"===g&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r))return Promise.resolve(x=>(0,y.aV)(e,(0,h.Op)(g,E,j,x)));if((0,I.YX)(e)&&"esriGeometryMultipoint"===g&&"esriSpatialRelContains"===r)return Promise.resolve(x=>(0,y.lQ)(e,(0,h.Op)(g,E,j,x)));if((0,I.YX)(e)&&"esriSpatialRelIntersects"===r){const x=function F(r){return"mesh"===r?T.h_:(0,T.IY)(r)}(g);return Promise.resolve(M=>x(e,(0,h.Op)(g,E,j,M)))}return function u(){return Promise.all([s.e(9465),s.e(8592)]).then(s.bind(s,49574))}().then(x=>{const M=x[b[r]].bind(null,e.spatialReference,e);return w=>M((0,h.Op)(g,E,j,w))})}function S(r,e,g){return p.apply(this,arguments)}function p(){return(p=(0,d.Z)(function*(r,e,g){const{spatialRel:E,geometry:j}=r;if(j){if(!function i(r){return null!=r&&!0===P.spatialRelationship[r]}(E))throw new G.Z(R,"Unsupported query spatial relationship",{query:r});if((0,D.JY)(j.spatialReference)&&(0,D.JY)(g)){if(!function n(r){return null!=r&&!0===P.queryGeometry[(0,I.Ji)(r)]}(j))throw new G.Z(R,"Unsupported query geometry type",{query:r});if(!function t(r){return null!=r&&!0===P.layerGeometry[r]}(e))throw new G.Z(R,"Unsupported layer geometry type",{query:r});if(r.outSR)return(0,O._W)(r.geometry?.spatialReference,r.outSR)}}})).apply(this,arguments)}function U(r){if((0,I.YX)(r))return!0;if((0,I.oU)(r)){for(const e of r.rings)if(5!==e.length||e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1;return!0}return!1}},21418:(C,A,s)=>{s.d(A,{R:()=>G,y:()=>T});var d=s(15861);function G(c,_){return y.apply(this,arguments)}function y(){return(y=(0,d.Z)(function*(c,_){if(!c)return null;const m=_.featureAdapter,{startTimeField:f,endTimeField:l}=c;let o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(f&&l)yield _.forEach(h=>{const O=m.getAttribute(h,f),R=m.getAttribute(h,l);null==O||isNaN(O)||(o=Math.min(o,O)),null==R||isNaN(R)||(a=Math.max(a,R))});else{const h=f||l;yield _.forEach(O=>{const R=m.getAttribute(O,h);null==R||isNaN(R)||(o=Math.min(o,R),a=Math.max(a,R))})}return{start:o,end:a}})).apply(this,arguments)}function T(c,_,m){if(!_||!c)return null;const{startTimeField:f,endTimeField:l}=c;if(!f&&!l)return null;const{start:o,end:a}=_;if(null===o&&null===a)return null;if(void 0===o&&void 0===a)return()=>!1;const h=m.getAttributeAsTimestamp?.bind(m)??m.getAttribute.bind(m);return f&&l?function F(c,_,m,f,l){return null!=f&&null!=l?o=>{const a=c(o,_),h=c(o,m);return(null==a||a<=l)&&(null==h||h>=f)}:null!=f?o=>{const a=c(o,m);return null==a||a>=f}:null!=l?o=>{const a=c(o,_);return null==a||a<=l}:void 0}(h,f,l,o,a):function I(c,_,m,f){return null!=m&&null!=f&&m===f?l=>c(l,_)===m:null!=m&&null!=f?l=>{const o=c(l,_);return null!=o&&o>=m&&o<=f}:null!=m?l=>{const o=c(l,_);return null!=o&&o>=m}:null!=f?l=>{const o=c(l,_);return null!=o&&o<=f}:void 0}(h,f||l,o,a)}},95251:(C,A,s)=>{s.r(A),s.d(A,{default:()=>b});var d=s(15861),G=s(57964),y=s(4703),T=s(45425),F=s(43585),I=s(44452),D=s(51089),c=s(21418),_=s(91866),m=s(12915),f=s(38955);const l=y.Z.getLogger("esri.views.2d.layers.features.support.whereUtils"),o={getAttribute:(P,i)=>P.readAttribute(i)};function h(){return(h=(0,d.Z)(function*(P,i){try{const n=yield(0,f.E)(P,i);if(!n.isStandardized){const t=new G.Z("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",n);l.error(t)}return t=>{const u=t.readArcadeFeature();return n.testFeature(u,o)}}catch{return l.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",P),t=>!0}})).apply(this,arguments)}class b{constructor(i){this._geometryBounds=(0,T.Ue)(),this._idToVisibility=new Map,this._serviceInfo=i}get hash(){return this._hash}check(i){return this._applyFilter(i)}clear(){const i=this._resetAllHiddenIds();return this.update(),{show:i,hide:[]}}invalidate(){this._idToVisibility.forEach((i,n)=>{this._idToVisibility.set(n,0)})}setKnownIds(i){for(const n of i)this._idToVisibility.set(n,1)}setTrue(i){const n=[],t=[],u=new Set(i);return this._idToVisibility.forEach((v,S)=>{const p=!!(1&this._idToVisibility.get(S)),U=u.has(S);!p&&U?n.push(S):p&&!U&&t.push(S),this._idToVisibility.set(S,U?3:0)}),{show:n,hide:t}}createQuery(){const{geometry:i,spatialRel:n,where:t,timeExtent:u,objectIds:v}=this;return _.Z.fromJSON({geometry:i,spatialRel:n,where:t,timeExtent:u,objectIds:v})}update(i,n){var t=this;return(0,d.Z)(function*(){t._hash=JSON.stringify(i);const u=yield(0,I.j6)(i,null,n);yield Promise.all([t._setGeometryFilter(u),t._setIdFilter(u),t._setAttributeFilter(u),t._setTimeFilter(u)])})()}_setAttributeFilter(i){var n=this;return(0,d.Z)(function*(){if(!i?.where)return n._clause=null,void(n.where=null);n._clause=yield function a(P,i){return h.apply(this,arguments)}(i.where,n._serviceInfo.fieldsIndex),n.where=i.where})()}_setIdFilter(i){this._idsToShow=i?.objectIds&&new Set(i.objectIds),this._idsToHide=i?.hiddenIds&&new Set(i.hiddenIds),this.objectIds=i?.objectIds}_setGeometryFilter(i){var n=this;return(0,d.Z)(function*(){if(!i?.geometry)return n._spatialQueryOperator=null,n.geometry=null,void(n.spatialRel=null);const t=i.geometry,u=i.spatialRel||"esriSpatialRelIntersects",v=yield(0,D.cW)(u,t,n._serviceInfo.geometryType,n._serviceInfo.hasZ,n._serviceInfo.hasM);(0,F.$P)(n._geometryBounds,t),n._spatialQueryOperator=v,n.geometry=t,n.spatialRel=u})()}_setTimeFilter(i){if(this.timeExtent=this._timeOperator=null,i?.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=i.timeExtent,this._timeOperator=(0,c.y)(this._serviceInfo.timeInfo,i.timeExtent,m.k);else{const n=new G.Z("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",i.timeExtent);y.Z.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter").error(n)}}_applyFilter(i){return this._filterByGeometry(i)&&this._filterById(i)&&this._filterByTime(i)&&this._filterByExpression(i)}_filterByExpression(i){return!this.where||this._clause(i)}_filterById(i){return(!this._idsToHide?.size||!this._idsToHide.has(i.getObjectId()))&&(!this._idsToShow?.size||this._idsToShow.has(i.getObjectId()))}_filterByGeometry(i){if(!this.geometry)return!0;const n=i.readHydratedGeometry();return!!n&&this._spatialQueryOperator(n)}_filterByTime(i){return null==this._timeOperator||this._timeOperator(i)}_resetAllHiddenIds(){const i=[];return this._idToVisibility.forEach((n,t)=>{1&n||(this._idToVisibility.set(t,1),i.push(t))}),i}}}}]);