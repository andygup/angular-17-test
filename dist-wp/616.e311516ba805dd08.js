"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[616,3715],{40408:(de,W,u)=>{u.d(W,{dp:()=>L,o2:()=>N,yZ:()=>J});var P=u(55117),l=u(49602);const U=96;function J(v,g){const w=g||v.extent,p=v.width,D=(0,l.c9)(w?.spatialReference);return w&&p?w.width/p*D*l.hd*U:0}function L(v,g){return v/((0,l.c9)(g)*l.hd*U)}function N(v,g,w){return function O(v,g){return 0===g||(0,P.W8)(v,g)||v<g}(v,g)&&function F(v,g){return 0===g||(0,P.W8)(v,g)||v>g}(v,w)}},10616:(de,W,u)=>{u.r(W),u.d(W,{default:()=>ot});var k,P=u(15861),l=u(50484),U=u(11931),J=u(35458),L=u(62691),B=u(66476),M=u(83944),A=u(5603),N=u(84303),O=u(34222),F=u(3233),v=u(79412),g=u(77675),w=u(6785),p=u(80543),D=u(1535),$=u(62185),ce=u(10141),re=u(7547),Ze=u(82206),V=u(26894),j=u(43814),me=u(40408),We=u(33721),Be=u(95060),De=u(19855),$e=u(80099),Ve=u(70509),Ge=u(25836),Xe=u(29717),He=u(12522),ne=u(74623),Je=u(89713),fe=u(8966),ye=u(6523),Ke=u(53715),Qe=u(84373),Ye=u(73018),K=u(57678);u(14007);let ze=0,x=k=class extends((0,Qe.IG)(F.w)){constructor(t){super(t),this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.legendUrl=null,this.legendEnabled=!0,this.layer=null,this.maxScale=0,this.minScale=0,this.name=null,this.parent=null,this.popupEnabled=!1,this.queryable=!1,this.sublayers=null,this.spatialReferences=null,this.title=null,this.addHandles([(0,g.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=this,r.layer=this.layer},g.Z_),(0,g.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},g.Z_),(0,g.YP)(()=>this.sublayers,(r,s)=>{if(s)for(const i of s)i.layer=i.parent=null;if(r)for(const i of r)i.parent=this,i.layer=this.layer},g.Z_),(0,g.YP)(()=>this.layer,r=>{if(this.sublayers)for(const s of this.sublayers)s.layer=r},g.Z_)])}get id(){return this._get("id")??ze++}set id(t){this._set("id",t)}readLegendUrl(t,r){return r.legendUrl??r.legendURL??null}get effectiveScaleRange(){const{minScale:t,maxScale:r}=this;return{minScale:t,maxScale:r}}castSublayers(t){return(0,D.se)(M.Z.ofType(k),t)}set visible(t){this._setAndNotifyLayer("visible",t)}clone(){const t=new k;return this.hasOwnProperty("description")&&(t.description=this.description),this.hasOwnProperty("fullExtent")&&(t.fullExtent=this.fullExtent.clone()),this.hasOwnProperty("fullExtents")&&(t.fullExtents=this.fullExtents?.map(r=>r.clone())??null),this.hasOwnProperty("legendUrl")&&(t.legendUrl=this.legendUrl),this.hasOwnProperty("legendEnabled")&&(t.legendEnabled=this.legendEnabled),this.hasOwnProperty("layer")&&(t.layer=this.layer),this.hasOwnProperty("name")&&(t.name=this.name),this.hasOwnProperty("parent")&&(t.parent=this.parent),this.hasOwnProperty("queryable")&&(t.queryable=this.queryable),this.hasOwnProperty("sublayers")&&(t.sublayers=this.sublayers?.map(r=>r.clone())),this.hasOwnProperty("spatialReferences")&&(t.spatialReferences=this.spatialReferences?.map(r=>r)),this.hasOwnProperty("visible")&&(t.visible=this.visible),this.hasOwnProperty("title")&&(t.title=this.title),t}_setAndNotifyLayer(t,r){const s=this.layer;this._get(t)!==r&&(this._set(t,r),s&&s.emit("wms-sublayer-update",{propertyName:t,id:this.id}))}};(0,l._)([(0,p.Cb)()],x.prototype,"description",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],x.prototype,"dimensions",void 0),(0,l._)([(0,p.Cb)({type:V.Z,json:{name:"extent"}})],x.prototype,"fullExtent",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"fullExtents",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{write:{enabled:!1,overridePolicy:()=>({ignoreOrigin:!0,enabled:!0})}}})],x.prototype,"id",null),(0,l._)([(0,p.Cb)({type:String,json:{name:"legendUrl",write:{ignoreOrigin:!0}}})],x.prototype,"legendUrl",void 0),(0,l._)([(0,$.r)("legendUrl",["legendUrl","legendURL"])],x.prototype,"readLegendUrl",null),(0,l._)([(0,p.Cb)({type:Boolean,json:{name:"showLegend",origins:{"web-map":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],x.prototype,"legendEnabled",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"layer",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"maxScale",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"minScale",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],x.prototype,"effectiveScaleRange",null),(0,l._)([(0,p.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],x.prototype,"name",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"parent",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{read:{source:"showPopup"},write:{ignoreOrigin:!0,target:"showPopup"}}})],x.prototype,"popupEnabled",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:{ignoreOrigin:!0}}})],x.prototype,"queryable",void 0),(0,l._)([(0,p.Cb)()],x.prototype,"sublayers",void 0),(0,l._)([(0,Ye.p)("sublayers")],x.prototype,"castSublayers",null),(0,l._)([(0,p.Cb)({type:[Number],json:{read:{source:"spatialReferences"}}})],x.prototype,"spatialReferences",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],x.prototype,"title",void 0),(0,l._)([(0,p.Cb)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"}}})],x.prototype,"visible",null),x=k=(0,l._)([(0,ce.j)("esri.layers.support.WMSSublayer")],x);const se=x;var qe=u(57964);const he={84:4326,83:4269,27:4267};function ke(t){if(!t)return null;const r={idCounter:-1};"string"==typeof t&&(t=(new DOMParser).parseFromString(t,"text/xml"));const s=t.documentElement;if("ServiceExceptionReport"===s.nodeName){const I=Array.prototype.slice.call(s.childNodes).map(q=>q.textContent).join("\r\n");throw new qe.Z("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",I)}const i=C("Capability",s),a=C("Service",s),c=i&&C("Request",i);if(!i||!a||!c)return null;const o=C("Layer",i);if(!o)return null;const m="WMS_Capabilities"===s.nodeName||"WMT_MS_Capabilities"===s.nodeName?s.getAttribute("version"):"1.3.0",d=R("Title",a,"")||R("Name",a,""),f=R("AccessConstraints",a,""),b=/^none$/i.test(f)?"":f,h=R("Abstract",a,""),E=parseInt(R("MaxWidth",a,"5000"),10),T=parseInt(R("MaxHeight",a,"5000"),10),Z=xe(c,"GetMap"),z=ve(c,"GetMap"),S=Y(o,m,r);if(!S)return null;let Ue,oe=0;const lt=Array.prototype.slice.call(i.childNodes),ut=S.sublayers??[],le=I=>{null!=I&&ut.push(I)};lt.forEach(I=>{"Layer"===I.nodeName&&(0===oe?Ue=I:(1===oe&&S.name&&(S.name="",le(Y(Ue,m,r))),le(Y(I,m,r))),oe++)});let H=S.sublayers,ue=S.extent;const pt=S.fullExtents??[];if(H||(H=[]),0===H.length&&H.push(S),!ue){const I=new V.Z(H[0].extent);S.extent=I.toJSON(),ue=S.extent}const dt=S.spatialReferences.length>0?S.spatialReferences:ge(S),Le=ve(c,"GetFeatureInfo"),ct=Le?xe(c,"GetFeatureInfo"):null,Me=be(H),mt=S.minScale||0,ft=S.maxScale||0,Ae=S.dimensions??[],yt=Me.reduce((I,q)=>I.concat(q.dimensions??[]),[]),je=Ae.concat(yt).filter(ie);let Te=null;if(je.length){const I=je.map(q=>{const{extent:pe}=q;return function tt(t){return Array.isArray(t)&&t.length>0&&t[0]instanceof Date}(pe)?pe.map(te=>te.getTime()):pe?.map(te=>[te.min.getTime(),te.max.getTime()])}).flat(2).filter(K.pC);Te={startTimeField:null,endTimeField:null,trackIdField:void 0,timeExtent:[Math.min(...I),Math.max(...I)]}}return{copyright:b,description:h,dimensions:Ae,extent:ue,fullExtents:pt,featureInfoFormats:ct,featureInfoUrl:Le,mapUrl:z,maxWidth:E,maxHeight:T,maxScale:ft,minScale:mt,layers:Me,spatialReferences:dt,supportedImageFormatTypes:Z,timeInfo:Te,title:d,version:m}}function ge(t){if(t.spatialReferences.length>0)return t.spatialReferences;if(t.sublayers)for(const r of t.sublayers){const s=ge(r);if(s.length>0)return s}return[]}function be(t){let r=[];for(const s of t)r.push(s),s.sublayers?.length&&(r=r.concat(be(s.sublayers)),delete s.sublayers);return r}function _(t,r,s){return r.getAttribute(t)??s}function C(t,r){for(let s=0;s<r.childNodes.length;s++){const i=r.childNodes[s];if(Se(i)&&i.nodeName===t)return i}return null}function ee(t,r){if(null==r)return[];const s=[];for(let i=0;i<r.childNodes.length;i++){const a=r.childNodes[i];Se(a)&&a.nodeName===t&&s.push(a)}return s}function R(t,r,s){return C(t,r)?.textContent??s}function Q(t,r,s){if(!t)return null;const i=parseFloat(t.getAttribute("minx")),a=parseFloat(t.getAttribute("miny")),c=parseFloat(t.getAttribute("maxx")),o=parseFloat(t.getAttribute("maxy"));let m,d,f,b;s?(m=isNaN(a)?-Number.MAX_VALUE:a,d=isNaN(i)?-Number.MAX_VALUE:i,f=isNaN(o)?Number.MAX_VALUE:o,b=isNaN(c)?Number.MAX_VALUE:c):(m=isNaN(i)?-Number.MAX_VALUE:i,d=isNaN(a)?-Number.MAX_VALUE:a,f=isNaN(c)?Number.MAX_VALUE:c,b=isNaN(o)?Number.MAX_VALUE:o);const h=new j.Z({wkid:r});return new V.Z({xmin:m,ymin:d,xmax:f,ymax:b,spatialReference:h})}function ve(t,r){const s=C(r,t);if(s){const i=C("DCPType",s);if(i){const a=C("HTTP",i);if(a){const c=C("Get",a);if(c){let o=function et(t,r,s,i){const a=C(t,s);return a?_(r,a,i):i}("OnlineResource","xlink:href",c,null);if(o)return o.indexOf("&")===o.length-1&&(o=o.substring(0,o.length-1)),function rt(t,r){const s=[],i=(0,w.mN)(t);for(const a in i.query)i.query.hasOwnProperty(a)&&(r.includes(a.toLowerCase())||s.push(a+"="+i.query[a]));return i.path+(s.length?"?"+s.join("&"):"")}(o,["service","request"])}}}}return null}function xe(t,r){const s=ee("Operation",t);if(!s.length)return ee("Format",C(r,t)).map(({textContent:a})=>a).filter(K.pC);const i=[];for(const a of s)if(a.getAttribute("name")===r){const c=ee("Format",a);for(const{textContent:o}of c)null!=o&&i.push(o)}return i}function we(t,r,s){const i=C(r,t);if(!i)return s;const{textContent:a}=i;if(null==a||""===a)return s;const c=Number(a);return isNaN(c)?s:c}function Y(t,r,s){if(!t)return null;const i={id:s.idCounter++,fullExtents:[],parentLayerId:null,queryable:"1"===t.getAttribute("queryable"),spatialReferences:[],sublayers:null},a=C("LatLonBoundingBox",t),c=C("EX_GeographicBoundingBox",t);let o=null;a&&(o=Q(a,4326)),c&&(o=new V.Z(0,0,0,0,new j.Z({wkid:4326})),o.xmin=parseFloat(R("westBoundLongitude",c,"0")),o.ymin=parseFloat(R("southBoundLatitude",c,"0")),o.xmax=parseFloat(R("eastBoundLongitude",c,"0")),o.ymax=parseFloat(R("northBoundLatitude",c,"0"))),a||c||(o=new V.Z(-180,-90,180,90,new j.Z({wkid:4326}))),i.minScale=we(t,"MaxScaleDenominator",0),i.maxScale=we(t,"MinScaleDenominator",0);const m=["1.0.0","1.1.0","1.1.1"].includes(r)?"SRS":"CRS";return Array.prototype.slice.call(t.childNodes).forEach(d=>{if("Name"===d.nodeName)i.name=d.textContent||"";else if("Title"===d.nodeName)i.title=d.textContent||"";else if("Abstract"===d.nodeName)i.description=d.textContent||"";else if("BoundingBox"===d.nodeName){const f=d.getAttribute(m);if(f&&0===f.indexOf("EPSG:")){const h=parseInt(f.substring(5),10);0===h||isNaN(h)||o||(o="1.3.0"===r?Q(d,h,(0,ne.A)(h)):Q(d,h))}const b=f&&f.indexOf(":");if(b&&b>-1){let h=parseInt(f.substring(b+1,f.length),10);0===h||isNaN(h)||(h=he[h]??h);const E="1.3.0"===r?Q(d,h,(0,ne.A)(h)):Q(d,h);E&&i.fullExtents&&i.fullExtents.push(E)}}else if(d.nodeName===m)(d.textContent?.split(" ")??[]).forEach(f=>{const b=f.includes(":")?parseInt(f.split(":")[1],10):parseInt(f,10);if(0!==b&&!isNaN(b)){const h=he[b]??b;i.spatialReferences.includes(h)||i.spatialReferences.push(h)}});else if("Style"!==d.nodeName||i.legendUrl){if("Layer"===d.nodeName){const f=Y(d,r,s);f&&(f.parentLayerId=i.id,i.sublayers||(i.sublayers=[]),i.sublayers.push(f))}}else{const f=C("LegendURL",d);if(f){const b=C("OnlineResource",f);b&&(i.legendUrl=b.getAttribute("xlink:href"))}}}),i.extent=o?.toJSON(),i.dimensions=ee("Dimension",t).filter(d=>d.getAttribute("name")&&d.getAttribute("units")&&d.textContent).map(d=>{const f=d.getAttribute("name"),b=d.getAttribute("units"),h=d.textContent,E=d.getAttribute("unitSymbol")??void 0,T=d.getAttribute("default")??void 0,Z="0"!==_("default",d,"0"),z="0"!==_("nearestValue",d,"0"),S="0"!==_("current",d,"0");return ie({name:f,units:b})?{name:"time",units:"ISO8601",extent:Ne(h),default:Ne(T),multipleValues:Z,nearestValue:z,current:S}:function Ce(t){return/^elevation$/i.test(t.name)&&/^(epsg|crs):\d+$/i.test(t.units)}({name:f,units:b})?{name:"elevation",units:b,extent:Ee(h),unitSymbol:E,default:Ee(T),multipleValues:Z,nearestValue:z}:{name:f,units:b,extent:Ie(h),unitSymbol:E,default:Ie(T),multipleValues:Z,nearestValue:z}}),i}function Se(t){return t.nodeType===Node.ELEMENT_NODE}function ie(t){return/^time$/i.test(t.name)&&/^iso8601$/i.test(t.units)}function Ee(t){if(!t)return;const r=t.includes("/"),s=t.split(",");return r?s.map(i=>{const a=i.split("/");return a.length<2?null:{min:parseFloat(a[0]),max:parseFloat(a[1]),resolution:a.length>=3&&"0"!==a[2]?parseFloat(a[2]):void 0}}).filter(K.pC):s.map(i=>parseFloat(i))}function Ie(t){if(!t)return;const r=t.includes("/"),s=t.split(",");return r?s.map(i=>{const a=i.split("/");return a.length<2?null:{min:a[0],max:a[1],resolution:a.length>=3&&"0"!==a[2]?a[2]:void 0}}).filter(K.pC):s}function Ne(t){if(!t)return;const r=t.includes("/"),s=t.split(",");return r?s.map(i=>{const a=i.split("/");return a.length<2?null:{min:new Date(a[0]),max:new Date(a[1]),resolution:a.length>=3&&"0"!==a[2]?nt(a[2]):void 0}}).filter(K.pC):s.map(i=>new Date(i))}function nt(t){const s=t.match(/(?:p(\d+y|\d+(?:\.|,)\d+y)?(\d+m|\d+(?:\.|,)\d+m)?(\d+d|\d+(?:\.|,)\d+d)?)?(?:t(\d+h|\d+(?:\.|,)\d+h)?(\d+m|\d+(?:\.|,)\d+m)?(\d+s|\d+(?:\.|,)\d+s)?)?/i);return s?{years:G(s[1]),months:G(s[2]),days:G(s[3]),hours:G(s[4]),minutes:G(s[5]),seconds:G(s[6])}:null}function G(t){if(!t)return 0;const s=t.match(/(?:\d+(?:\.|,)\d+|\d+)/);if(!s)return 0;const i=s[0].replace(",",".");return Number(i)}function X(t){return t.toISOString().replace(/\.[0-9]{3}/,"")}const Fe=new Set([102100,3857,102113,900913]),st=new Set([3395,54004]),ae=new N.X({bmp:"image/bmp",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml"},{ignoreUnknown:!1});function Oe(t){return"text/html"===t}function Re(t){return"text/plain"===t}let y=class extends((0,De.h)((0,He.n)((0,Ge.Q)((0,Xe.M)((0,$e.q)((0,Ve.I)((0,F.R)(Be.Z)))))))){constructor(...t){super(...t),this.allSublayers=new A.Z({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormats=null,this.featureInfoUrl=null,this.fetchFeatureInfoFunction=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType="WMS",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type="wms",this.version=null,this.addHandles([(0,g.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=r.layer=this},g.Z_),(0,g.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},g.Z_),(0,g.YP)(()=>this.sublayers,(r,s)=>{if(s)for(const i of s)i.layer=i.parent=null;if(r)for(const i of r)i.parent=i.layer=this},g.Z_)])}normalizeCtorArgs(t,r){return"string"==typeof t?{url:t,...r}:t}destroy(){this.allSublayers.destroy()}load(t){const r=null!=t?t.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMS"]},t).catch(v.r9).then(()=>this._fetchService(r))),Promise.resolve(this)}readFullExtentFromItemOrMap(t,r){const s=r.extent;return s?new V.Z({xmin:s[0][0],ymin:s[0][1],xmax:s[1][0],ymax:s[1][1]}):null}writeFullExtent(t,r){r.extent=[[t.xmin,t.ymin],[t.xmax,t.ymax]]}get featureInfoFormat(){return null==this.featureInfoFormats?null:this.featureInfoFormats.find(Oe)??this.featureInfoFormats.find(Re)??null}set featureInfoFormat(t){null==t?(this.revert("featureInfoFormat","service"),this._clearOverride("featureInfoFormat")):(Oe(t)||Re(t))&&this._override("featureInfoFormat",t)}readImageFormat(t,r){const s=r.supportedImageFormatTypes;return s&&s.includes("image/png")?"image/png":s&&s[0]}readSpatialReferenceFromItemOrDocument(t,r){return new j.Z(r.spatialReferences[0])}writeSpatialReferences(t,r){const s=this.spatialReference?.wkid;t&&s?(r.spatialReferences=t.filter(i=>i!==s),r.spatialReferences.unshift(s)):r.spatialReferences=t}readSublayersFromItemOrMap(t,r,s){return Pe(r.layers,s,r.visibleLayers)}readSublayers(t,r,s){return Pe(r.layers,s)}writeSublayers(t,r,s,i){r.layers=[];const a=new Map,c=t.flatten(({sublayers:o})=>o??[]);for(const o of c)if("number"==typeof o.parent?.id){const m=a.get(o.parent.id);null!=m?m.push(o.id):a.set(o.parent.id,[o.id])}for(const o of c){const m={sublayer:o,...i},d=o.write({parentLayerId:"number"==typeof o.parent?.id?o.parent.id:-1},m);if(a.has(o.id)&&(d.sublayerIds=a.get(o.id)),!o.sublayers&&o.name){const f=o.write({},m);delete f.id,r.layers.push(f)}}r.visibleLayers=c.filter(({visible:o,sublayers:m})=>o&&!m).map(({name:o})=>o).toArray()}set url(t){if(!t)return void this._set("url",t);const{path:r,query:s}=(0,w.mN)(t);for(const a in s)/^(request|service)$/i.test(a)&&delete s[a];const i=(0,w.fl)(r,s??{});this._set("url",i)}createExportImageParameters(t,r,s,i){const a=i?.pixelRatio??1,c=(0,me.yZ)({extent:t,width:r})*a,o=new ye.j({layer:this,scale:c}),{xmin:m,ymin:d,xmax:f,ymax:b,spatialReference:h}=t,E=function it(t,r){let s=t.wkid;return null==r?s:(null!=s&&r.includes(s)||!t.latestWkid||(s=t.latestWkid),null!=s&&Fe.has(s)?r.find(i=>Fe.has(i))||r.find(i=>st.has(i))||102100:s)}(h,this.spatialReferences),T="1.3.0"===this.version&&(0,ne.A)(E)?`${d},${m},${b},${f}`:`${m},${d},${f},${b}`,Z=o.toJSON();return{bbox:T,["1.3.0"===this.version?"crs":"srs"]:null==E||isNaN(E)?void 0:"EPSG:"+E,...Z}}fetchImage(t,r,s,i){var a=this;return(0,P.Z)(function*(){const c=a.mapUrl,o=a.createExportImageParameters(t,r,s,i);if(!o.layers){const h=document.createElement("canvas");return h.width=r,h.height=s,h}const m=i?.timeExtent?.start,d=i?.timeExtent?.end,f=null!=m&&null!=d?m.getTime()===d.getTime()?X(m):`${X(m)}/${X(d)}`:void 0,b={responseType:"image",query:a._mixCustomParameters({width:r,height:s,...o,time:f,...a.refreshParameters}),signal:i?.signal};return(0,B.Z)(c??"",b).then(h=>h.data)})()}fetchImageBitmap(t,r,s,i){var a=this;return(0,P.Z)(function*(){const c=a.mapUrl??"",o=a.createExportImageParameters(t,r,s,i);if(!o.layers){const E=document.createElement("canvas");return E.width=r,E.height=s,E}const m=i?.timeExtent?.start,d=i?.timeExtent?.end,f=null!=m&&null!=d?m.getTime()===d.getTime()?X(m):`${X(m)}/${X(d)}`:void 0,b={responseType:"blob",query:a._mixCustomParameters({width:r,height:s,...o,time:f,...a.refreshParameters}),signal:i?.signal},{data:h}=yield(0,B.Z)(c,b);return(0,Ke.g)(h,c,i?.signal)})()}fetchFeatureInfo(t,r,s,i,a){const c=(0,me.yZ)({extent:t,width:r}),m=function _e(t){const r=t.filter(s=>s.popupEnabled&&s.name&&s.queryable);return r.length?r.map(({name:s})=>s).join():null}(new ye.j({layer:this,scale:c}).visibleSublayers);if(null==this.featureInfoUrl||null==m)return Promise.resolve([]);if(null==this.fetchFeatureInfoFunction&&null==this.featureInfoFormat)return Promise.resolve([]);const f={query_layers:m,request:"GetFeatureInfo",info_format:this.featureInfoFormat,feature_count:25,width:r,height:s,..."1.3.0"===this.version?{I:i,J:a}:{x:i,y:a}},b={...this.createExportImageParameters(t,r,s),...f},h=this._mixCustomParameters(b);return null!=this.fetchFeatureInfoFunction?this.fetchFeatureInfoFunction(h):this._defaultFetchFeatureInfoFunction((0,w.fl)(this.featureInfoUrl,h))}findSublayerById(t){return this.allSublayers.find(r=>r.id===t)}findSublayerByName(t){return this.allSublayers.find(r=>r.name===t)}serviceSupportsSpatialReference(t){return(0,Je.G)(this.url)||null!=this.spatialReferences&&this.spatialReferences.some(r=>{const s=900913===r?j.Z.WebMercator:new j.Z({wkid:r});return(0,We.fS)(s,t)})}_defaultFetchFeatureInfoFunction(t){const r=document.createElement("iframe");r.src=(0,w.qg)(t),r.style.border="none",r.style.margin="0",r.style.width="100%",r.setAttribute("sandbox","");const s=new L.Z({title:this.title,content:r}),i=new J.Z({sourceLayer:this,popupTemplate:s});return Promise.resolve([i])}_fetchService(t){var r=this;return(0,P.Z)(function*(){if(!r.resourceInfo&&r.parsedUrl?.path){const{path:s,query:i}=r.parsedUrl,{data:a}=yield(0,B.Z)(s,{query:{SERVICE:"WMS",REQUEST:"GetCapabilities",...i,...r.customParameters},responseType:"xml",signal:t});r.resourceInfo=ke(a)}if(r.parsedUrl){const s=new w.R9(r.parsedUrl.path),{httpsDomains:i}=U.default.request;"https"!==s.scheme||s.port&&"443"!==s.port||!s.host||i.includes(s.host)||i.push(s.host)}r.read(r.resourceInfo,{origin:"service"})})()}_mixCustomParameters(t){if(!this.customLayerParameters&&!this.customParameters)return t;const r={...this.customParameters,...this.customLayerParameters};for(const s in r)t[s.toLowerCase()]=r[s];return t}};function Pe(t,r,s){t=t??[];const i=new Map;t.every(c=>null==c.id)&&(t=(0,O.d9)(t)).forEach((c,o)=>c.id=o);for(const c of t){const o=new se;o.read(c,r),s&&!s.includes(o.name)&&(o.visible=!1),i.set(o.id,o)}const a=[];for(const c of t){const o=null!=c.id?i.get(c.id):null;if(o)if(null!=c.parentLayerId&&c.parentLayerId>=0){const m=i.get(c.parentLayerId);if(!m)continue;m.sublayers||(m.sublayers=new M.Z),m.sublayers.push(o)}else a.push(o)}return a}(0,l._)([(0,p.Cb)({readOnly:!0})],y.prototype,"allSublayers",void 0),(0,l._)([(0,p.Cb)({json:{type:Object,write:!0}})],y.prototype,"customParameters",void 0),(0,l._)([(0,p.Cb)({json:{type:Object,write:!0}})],y.prototype,"customLayerParameters",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],y.prototype,"copyright",void 0),(0,l._)([(0,p.Cb)()],y.prototype,"description",void 0),(0,l._)([(0,p.Cb)({readOnly:!0})],y.prototype,"dimensions",void 0),(0,l._)([(0,p.Cb)({json:{type:[[Number]],read:{source:"extent"},write:{target:"extent"},origins:{"web-document":{write:{ignoreOrigin:!0}},"portal-item":{write:{ignoreOrigin:!0}}}}})],y.prototype,"fullExtent",void 0),(0,l._)([(0,$.r)(["web-document","portal-item"],"fullExtent",["extent"])],y.prototype,"readFullExtentFromItemOrMap",null),(0,l._)([(0,re.c)(["web-document","portal-item"],"fullExtent",{extent:{type:[[Number]]}})],y.prototype,"writeFullExtent",null),(0,l._)([(0,p.Cb)()],y.prototype,"fullExtents",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"featureInfoFormat",null),(0,l._)([(0,p.Cb)({type:[String],readOnly:!0})],y.prototype,"featureInfoFormats",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"featureInfoUrl",void 0),(0,l._)([(0,p.Cb)()],y.prototype,"fetchFeatureInfoFunction",void 0),(0,l._)([(0,p.Cb)({type:String,json:{origins:{"web-document":{default:"image/png",type:ae.jsonValues,read:{reader:ae.read,source:"format"},write:{writer:ae.write,target:"format"}}}}})],y.prototype,"imageFormat",void 0),(0,l._)([(0,$.r)("imageFormat",["supportedImageFormatTypes"])],y.prototype,"readImageFormat",null),(0,l._)([(0,p.Cb)({type:Number,json:{read:{source:"maxHeight"},write:{target:"maxHeight"}}})],y.prototype,"imageMaxHeight",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{read:{source:"maxWidth"},write:{target:"maxWidth"}}})],y.prototype,"imageMaxWidth",void 0),(0,l._)([(0,p.Cb)()],y.prototype,"imageTransparency",void 0),(0,l._)([(0,p.Cb)(fe.rn)],y.prototype,"legendEnabled",void 0),(0,l._)([(0,p.Cb)({type:["show","hide","hide-children"]})],y.prototype,"listMode",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"mapUrl",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],y.prototype,"isReference",void 0),(0,l._)([(0,p.Cb)({type:["WMS"]})],y.prototype,"operationalLayerType",void 0),(0,l._)([(0,p.Cb)()],y.prototype,"resourceInfo",void 0),(0,l._)([(0,p.Cb)({type:j.Z,json:{origins:{service:{read:{source:"extent.spatialReference"}}},write:!1}})],y.prototype,"spatialReference",void 0),(0,l._)([(0,$.r)(["web-document","portal-item"],"spatialReference",["spatialReferences"])],y.prototype,"readSpatialReferenceFromItemOrDocument",null),(0,l._)([(0,p.Cb)({type:[D.z8],json:{read:!1,origins:{service:{read:!0},"web-document":{read:!1,write:{ignoreOrigin:!0}},"portal-item":{read:!1,write:{ignoreOrigin:!0}}}}})],y.prototype,"spatialReferences",void 0),(0,l._)([(0,re.c)(["web-document","portal-item"],"spatialReferences")],y.prototype,"writeSpatialReferences",null),(0,l._)([(0,p.Cb)({type:M.Z.ofType(se),json:{write:{target:"layers",overridePolicy(t,r,s){if(function at(t,r){return t.some(s=>{for(const i in s)if((0,Ze.d)(s,i,null,r))return!0;return!1})}(this.allSublayers,s))return{ignoreOrigin:!0}}}}})],y.prototype,"sublayers",void 0),(0,l._)([(0,$.r)(["web-document","portal-item"],"sublayers",["layers","visibleLayers"])],y.prototype,"readSublayersFromItemOrMap",null),(0,l._)([(0,$.r)("service","sublayers",["layers"])],y.prototype,"readSublayers",null),(0,l._)([(0,re.c)("sublayers",{layers:{type:[se]},visibleLayers:{type:[String]}})],y.prototype,"writeSublayers",null),(0,l._)([(0,p.Cb)({json:{read:!1},readOnly:!0,value:"wms"})],y.prototype,"type",void 0),(0,l._)([(0,p.Cb)(fe.HQ)],y.prototype,"url",null),(0,l._)([(0,p.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],y.prototype,"version",void 0),y=(0,l._)([(0,ce.j)("esri.layers.WMSLayer")],y);const ot=y},53715:(de,W,u)=>{u.d(W,{V:()=>B,g:()=>J});var P=u(15861),l=u(57964),U=u(79412);function J(A,N,O){return L.apply(this,arguments)}function L(){return(L=(0,P.Z)(function*(A,N,O){let F;try{F=yield createImageBitmap(A)}catch(v){throw new l.Z("request:server",`Unable to load ${N}`,{url:N,error:v})}return(0,U.k_)(O),F})).apply(this,arguments)}function B(A,N,O,F,v){return M.apply(this,arguments)}function M(){return(M=(0,P.Z)(function*(A,N,O,F,v){let g;try{g=yield createImageBitmap(A)}catch(w){throw new l.Z("request:server",`Unable to load tile ${N}/${O}/${F}`,{error:w,level:N,row:O,col:F})}return(0,U.k_)(v),g})).apply(this,arguments)}}}]);