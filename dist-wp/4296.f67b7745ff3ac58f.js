"use strict";(self.webpackChunkangular_17_test=self.webpackChunkangular_17_test||[]).push([[4296],{6118:(m,d,t)=>{t.d(d,{JZ:()=>u,RL:()=>P,eY:()=>p});var l=t(15861),o=t(79412),i=t(51006),h=t(71602),_=t(7077),x=t(64456),D=t(98634),R=t(99273),E=t(39237),O=t(17091),v=t(22784);function u(a){return a&&"render"in a}function P(a){const e=document.createElement("canvas");return e.width=a.width,e.height=a.height,a.render(e.getContext("2d")),e}class p extends x.s{constructor(e=null,r=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=r,this.source=e,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){null==e&&null==this._source||(this._source=e,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(e){this._width=e}beforeRender(e){super.beforeRender(e),this.updateTexture(e)}setSourceAsync(e,r){var s=this;return(0,l.Z)(function*(){null!=s._uploadStatus&&s._uploadStatus.controller.abort();const c=new AbortController,n=(0,o.hh)();return(0,o.$F)(r,()=>c.abort()),(0,o.$F)(c,g=>n.reject(g)),s._uploadStatus={controller:c,resolver:n},s.source=e,n.promise})()}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(e,r){e>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(e,r)}setTransform(e){const r=(0,i.g)(this.transforms.dvs),[s,c]=e.toScreenNoRotation([0,0],[this.x,this.y]),n=this.resolution/this.pixelRatio/e.resolution,g=n*this.width,B=n*this.height,T=Math.PI*this.rotation/180;(0,i.h)(r,r,(0,_.f)(s,c)),(0,i.h)(r,r,(0,_.f)(g/2,B/2)),(0,i.r)(r,r,-T),(0,i.h)(r,r,(0,_.f)(-g/2,-B/2)),(0,i.l)(r,r,(0,_.f)(g,B)),(0,i.m)(this.transforms.dvs,e.displayViewMat3,r)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind(e,r){this._texture&&e.bindTexture(this._texture,r)}updateTexture({context:e,painter:r}){var s=this;return(0,l.Z)(function*(){if(!s._textureInvalidated)return;if(s._textureInvalidated=!1,s._texture||(s._texture=s._createTexture(e)),!s.source)return void s._texture.setData(null);s._texture.resize(s._sourceWidth,s._sourceHeight);const c=function M(a){return u(a)?a instanceof D.Z?a.getRenderedRasterPixels()?.renderedRasterPixels:P(a):a}(s.source);try{if(null!=s._uploadStatus){const{controller:n,resolver:g}=s._uploadStatus,B={signal:n.signal},{width:T,height:C}=s,y=s._texture;yield r.textureUploadManager.enqueueTextureUpdate({data:c,texture:y,width:T,height:C},B),g.resolve(),s._uploadStatus=null}else s._texture.setData(c);s.ready()}catch(n){(0,o.H9)(n)}})()}onDetach(){this.destroy()}_createTransforms(){return{dvs:(0,h.c)()}}_createTexture(e){const r=this.immutable&&e.type===R.zO.WEBGL2,s=new v.X;return s.internalFormat=r?E.lP.RGBA8:E.VI.RGBA,s.wrapMode=E.e8.CLAMP_TO_EDGE,s.isImmutable=r,s.width=this._sourceWidth,s.height=this._sourceHeight,new O.x(e,s)}}},98634:(m,d,t)=>{t.d(d,{Z:()=>l});class l{constructor(i,h,_){this.pixelBlock=i,this.extent=h,this.originalPixelBlock=_}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(i){const h=this.pixelBlock;if(null==h)return;const _=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??h});if(null==_.pixelBlock)return;_.pixelBlock.maskIsAlpha&&(_.pixelBlock.premultiplyAlpha=!0);const x=_.pixelBlock.getAsRGBA(),D=i.createImageData(_.pixelBlock.width,_.pixelBlock.height);D.data.set(x),i.putImageData(D,0,0)}getRenderedRasterPixels(){const i=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==i.pixelBlock?null:(i.pixelBlock.maskIsAlpha&&(i.pixelBlock.premultiplyAlpha=!0),{width:i.pixelBlock.width,height:i.pixelBlock.height,renderedRasterPixels:new Uint8Array(i.pixelBlock.getAsRGBA().buffer)})}}},16773:(m,d,t)=>{t.r(d),t.d(d,{default:()=>a});var l=t(15861),o=t(50484),i=t(4703),h=t(79412),_=t(80543),E=(t(1535),t(57678),t(14007),t(10141)),O=t(81065),v=t(93509),u=t(87653),P=t(50145),M=t(32126);let p=class extends((0,M.Z)((0,v.y)(P.Z))){update(e){this._strategy.update(e).catch(r=>{(0,h.D_)(r)||i.Z.getLogger(this).error(r)}),this.notifyChange("updating")}attach(){this._bitmapContainer=new O.c,this.container.addChild(this._bitmapContainer),this._strategy=new u.Z({container:this._bitmapContainer,fetchSource:this.fetchBitmapData.bind(this),requestUpdate:this.requestUpdate.bind(this)})}detach(){this._strategy.destroy(),this._strategy=null,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}fetchBitmapData(e,r,s){return this.layer.fetchImageBitmap(e,r,s)}doRefresh(){var e=this;return(0,l.Z)(function*(){e.requestUpdate()})()}isUpdating(){return this._strategy.updating||this.updateRequested}};(0,o._)([(0,_.Cb)()],p.prototype,"_strategy",void 0),(0,o._)([(0,_.Cb)()],p.prototype,"updating",void 0),p=(0,o._)([(0,E.j)("esri.views.2d.layers.BaseDynamicLayerView2D")],p);const a=p},32126:(m,d,t)=>{t.d(d,{Z:()=>O});var l=t(50484),o=t(4703),i=t(79412),h=t(77675),_=t(80543),E=(t(1535),t(57678),t(14007),t(10141));const O=v=>{let u=class extends v{initialize(){this.addHandles((0,h.on)(()=>this.layer,"refresh",P=>{this.doRefresh(P.dataChanged).catch(M=>{(0,i.D_)(M)||o.Z.getLogger(this).error(M)})}),"RefreshableLayerView")}};return(0,l._)([(0,_.Cb)()],u.prototype,"layer",void 0),u=(0,l._)([(0,E.j)("esri.layers.mixins.RefreshableLayerView")],u),u}}}]);