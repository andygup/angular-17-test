import{g as re}from"./chunk-FNDPIYNC.js";import{h as ee,j,m as me,p as he}from"./chunk-PT7S6WNL.js";import{b as pe,j as g,p as de,r as P}from"./chunk-465DRXTW.js";import{a as x,p as fe}from"./chunk-AC62Z3FX.js";import{a as y,g as m}from"./chunk-ESDYQQXO.js";var He=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Ne={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function te(e){let r=e?.match(He);if(!r)return null;let[,t,n,s]=r;if(!t)return null;let o=null,a=null,i=null,{devext:u,qaext:l,www:f}=Ne;if(n)if(o=t,s)switch(s.toLowerCase()){case"devext":({customBaseUrl:a,portalHostname:i}=u);break;case"qa":({customBaseUrl:a,portalHostname:i}=l);break;default:return null}else({customBaseUrl:a,portalHostname:i}=f);else switch(t.toLowerCase()){case"devext":({customBaseUrl:a,portalHostname:i}=u);break;case"qaext":({customBaseUrl:a,portalHostname:i}=l);break;case"www":({customBaseUrl:a,portalHostname:i}=f);break;default:return null}return{customBaseUrl:a,isPortal:!1,portalHostname:i,urlKey:o}}function ye(e){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(e)}function ge(e){let r=atob(e),t=new Uint8Array(r.length);for(let n=0;n<r.length;n++)t[n]=r.charCodeAt(n);return t.buffer}function we(e){let r=new Uint8Array(e),t="";for(let n=0;n<r.length;n++)t+=String.fromCharCode(r[n]);return btoa(t)}var Fe=de.getLogger("esri.core.urlUtils"),A=g.request,be="esri/config: esriConfig.request.proxyUrl is not set.",xe=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,qe=/^\s*http:/i,_e=/^\s*https:/i,Me=/^\s*file:/i,We=/:\d+$/,Qe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,ze=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),Ke=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$"),S=class{constructor(r=""){this.uri=r,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let t=this.uri.match(ze);this.scheme=t[2]||(t[1]?"":null),this.authority=t[4]||(t[3]?"":null),this.path=t[5],this.query=t[7]||(t[6]?"":null),this.fragment=t[9]||(t[8]?"":null),this.authority!=null&&(t=this.authority.match(Ke),this.user=t[3]||null,this.password=t[4]||null,this.host=t[6]||t[7],this.port=t[9]||null)}toString(){return this.uri}},I={},Ge=new S(g.applicationUrl),p=Ge,Je=Ve(),oe=Je,_=()=>p,Ir=()=>oe;function Ve(){let e=p.path,r=e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]));return`${`${p.scheme}://${p.host}${p.port!=null?`:${p.port}`:""}`}${r}`}function C(e){if(!e)return null;let r={path:null,query:null},t=new S(e),n=e.indexOf("?");return t.query===null?r.path=e:(r.path=e.substring(0,n),r.query=M(t.query)),t.fragment&&(r.hash=t.fragment,t.query===null&&(r.path=r.path.substring(0,r.path.length-(t.fragment.length+1)))),r}function M(e){let r=e.split("&"),t={};for(let n of r){if(!n)continue;let s=n.indexOf("="),o,a;s<0?(o=decodeURIComponent(n),a=""):(o=decodeURIComponent(n.slice(0,s)),a=decodeURIComponent(n.slice(s+1)));let i=t[o];typeof i=="string"&&(i=t[o]=[i]),Array.isArray(i)?i.push(a):t[o]=a}return t}function $(e,r){return e?r&&typeof r=="function"?Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(r(t,e[t]))).join("&"):Object.keys(e).map(t=>{let n=e[t];if(n==null)return"";let s=encodeURIComponent(t)+"=",o=r?.[t];return o?s+encodeURIComponent(o(n)):Array.isArray(n)?n.map(a=>re(a)?s+encodeURIComponent(JSON.stringify(a)):s+encodeURIComponent(a)).join("&"):re(n)?s+encodeURIComponent(JSON.stringify(n)):s+encodeURIComponent(n)}).filter(t=>t).join("&"):""}function Oe(e=!1){let r,t=A.proxyUrl;if(typeof e=="string"){r=tr(e);let n=R(e);n&&(t=n.proxyUrl)}else r=!!e;if(!t)throw Fe.warn(be),new P("urlutils:proxy-not-set",be);return r&&ne()&&(t=K(t)),C(t)}function Hr(e){let r=R(e),t,n;if(r){let s=ae(r.proxyUrl);t=s.path,n=s.query?M(s.query):null}if(t){let s=C(e);e=t+"?"+s.path;let o=$(y(y({},n),s.query));o&&(e=`${e}?${o}`)}return e}var L={path:"",query:""};function ae(e){let r=e.indexOf("?");return r!==-1?(L.path=e.slice(0,r),L.query=e.slice(r+1)):(L.path=e,L.query=null),L}function Te(e){return e=(e=F(e=ir(e=ae(e).path),!0)).toLowerCase()}function Se(e){let r={proxyUrl:e.proxyUrl,urlPrefix:Te(e.urlPrefix)},t=A.proxyRules,n=r.urlPrefix,s=t.length;for(let o=0;o<t.length;o++){let a=t[o].urlPrefix;if(n.indexOf(a)===0){if(n.length===a.length)return-1;s=o;break}a.indexOf(n)===0&&(s=o+1)}return t.splice(s,0,r),s}function R(e){let r=A.proxyRules,t=Te(e);for(let n=0;n<r.length;n++)if(t.indexOf(r[n].urlPrefix)===0)return r[n]}function Nr(e,r){if(!e||!r)return!1;e=H(e),r=H(r);let t=te(e),n=te(r);return t!=null&&n!=null?t.portalHostname===n.portalHostname:t==null&&n==null&&U(e,r,!0)}function Fr(e,r){return e=H(e),r=H(r),F(e)===F(r)}function H(e){let r=(e=k(e)).indexOf("/sharing");return r>0?e.substring(0,r):e.replace(/\/+$/,"")}function Ce(e){let r=n=>n==null||n instanceof RegExp&&n.test(e)||typeof n=="string"&&e.startsWith(n),t=A.interceptors;if(t){for(let n of t)if(Array.isArray(n.urls)){if(n.urls.some(r))return n}else if(r(n.urls))return n}return null}function U(e,r,t=!1){if(!e||!r)return!1;let n=se(e),s=se(r);return!(!t&&n.scheme!==s.scheme)&&n.host!=null&&s.host!=null&&n.host.toLowerCase()===s.host.toLowerCase()&&n.port===s.port}function W(e){if(typeof e=="string"){if(!E(e))return!0;e=se(e)}if(U(e,p))return!0;let r=A.trustedServers||[];for(let t=0;t<r.length;t++){let n=Xe(r[t]);for(let s=0;s<n.length;s++)if(U(e,n[s]))return!0}return!1}function Xe(e){return I[e]||(le(e)||v(e)?I[e]=[new S(ie(e))]:I[e]=[new S(`http://${e}`),new S(`https://${e}`)]),I[e]}function ie(e,r=oe,t){return v(e)?t&&t.preserveProtocolRelative?e:p.scheme==="http"&&p.authority===h(e).slice(2)?`http:${e}`:`https:${e}`:le(e)?e:Ye(e[0]==="/"?ar(r):r,e)}function _r(e,r=oe,t){if(e==null||!E(e))return e;let n=k(e),s=n.toLowerCase(),o=k(r).toLowerCase().replace(/\/+$/,""),a=t?k(t).toLowerCase().replace(/\/+$/,""):null;if(a&&o.indexOf(a)!==0)return e;let i=(T,c,b)=>(b=T.indexOf(c,b))===-1?T.length:b,u=i(s,"/",s.indexOf("//")+2),l=-1;for(;s.slice(0,u+1)===o.slice(0,u)+"/"&&(l=u+1,u!==s.length);)u=i(s,"/",u+1);if(l===-1||a&&l<a.length)return e;e=n.slice(l);let f=o.slice(l-1).replaceAll(/[^/]+/g,"").length;if(f>0)for(let T=0;T<f;T++)e=`../${e}`;else e=`./${e}`;return e}function k(e){return e=cr(e=ur(e=lr(e=ie(e=e.trim()))))}function Ye(...e){let r=e.filter(fe);if(!r?.length)return;let t=[];if(E(r[0])){let s=r[0],o=s.indexOf("//");o!==-1&&(t.push(s.slice(0,o+1)),sr(r[0])&&(t[0]+="/"),r[0]=s.slice(o+2))}else r[0][0]==="/"&&t.push("");let n=r.reduce((s,o)=>o?s.concat(o.split("/")):s,[]);for(let s=0;s<n.length;s++){let o=n[s];o===".."&&t.length>0&&t[t.length-1]!==".."?t.pop():(!o&&s===n.length-1||o&&(o!=="."||t.length===0))&&t.push(o)}return t.join("/")}function h(e,r=!1){if(e==null||Q(e)||z(e))return null;let t=e.indexOf("://");if(t===-1&&v(e))t=2;else{if(t===-1)return null;t+=3}let n=e.indexOf("/",t);return n!==-1&&(e=e.slice(0,n)),r&&(e=F(e,!0)),e}function E(e){return v(e)||le(e)}function Q(e){return e!=null&&e.slice(0,5)==="blob:"}function z(e){return e!=null&&e.slice(0,5)==="data:"}function Ze(e){let r=N(e);return r&&r.isBase64?ge(r.data):null}function Mr(e){return we(e).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}var er=/^data:(.*?)(;base64)?,(.*)$/;function N(e){let r=e.match(er);if(!r)return null;let[,t,n,s]=r;return{mediaType:t,isBase64:!!n,data:s}}function Wr(e){return e.isBase64?`data:${e.mediaType};base64,${e.data}`:`data:${e.mediaType},${e.data}`}function Qr(e){return m(this,null,function*(){return(yield fetch(e)).blob()})}function zr(e){let r=Ze(e);if(!r)return null;let t=N(e);return new Blob([r],{type:t.mediaType})}function Kr(e,r){rr(e,r)}function rr(e,r){if(!e)return!1;let t=document.createElement("a");if(!("download"in t))return!1;let n=URL.createObjectURL(e);return t.download=r,t.href=n,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(n),!0}function v(e){return e!=null&&e[0]==="/"&&e[1]==="/"}function le(e){return e!=null&&xe.test(e)}function tr(e){return e!=null&&_e.test(e)||p.scheme==="https"&&v(e)}function nr(e){return e!=null&&qe.test(e)||p.scheme==="http"&&v(e)}function sr(e){return e!=null&&Me.test(e)}function K(e){return v(e)?`https:${e}`:e.replace(qe,"https:")}function or(){return p.scheme==="http"}function ne(){return p.scheme==="https"}function F(e,r=!1){return v(e)?e.slice(2):(e=e.replace(xe,""),r&&e.length>1&&e[0]==="/"&&e[1]==="/"&&(e=e.slice(2)),e)}function ar(e){let r=e.indexOf("//"),t=e.indexOf("/",r+2);return t===-1?e:e.slice(0,t)}function Gr(e){let r=0;if(E(e)){let n=e.indexOf("//");n!==-1&&(r=n+2)}let t=e.lastIndexOf("/");return t<r?e:e.slice(0,t+1)}function Jr(e,r){if(!e)return"";let t=C(e).path.replace(/\/+$/,""),n=t.substring(t.lastIndexOf("/")+1);if(!r?.length)return n;let s=new RegExp(`.(${r.join("|")})$`,"ig");return n.replace(s,"")}function ir(e){return e.endsWith("/")?e:`${e}/`}function Vr(e){return e.replace(/\/+$/,"")}function lr(e){if(/^https?:\/\//i.test(e)){let r=ae(e);e=(e=r.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),r.query&&(e+=`?${r.query}`)}return e}function ur(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function cr(e){let r=A.httpsDomains;if(!nr(e))return e;let t=e.indexOf("/",7),n;if(n=t===-1?e:e.slice(0,t),n=n.toLowerCase().slice(7),We.test(n)){if(!n.endsWith(":80"))return e;n=n.slice(0,-3),e=e.replace(":80","")}return or()&&n===p.authority&&!Qe.test(e)||(ne()&&n===p.authority||r&&r.some(s=>n===s||n.endsWith(`.${s}`))||ne()&&!R(e))&&(e=K(e)),e}function Xr(e,r,t){if(!(r&&t&&e&&E(e)))return e;let n=e.indexOf("//"),s=e.indexOf("/",n+2),o=e.indexOf(":",n+2),a=Math.min(s<0?e.length:s,o<0?e.length:o);return e.slice(n+2,a).toLowerCase()!==r.toLowerCase()?e:`${e.slice(0,n+2)}${t}${e.slice(a)}`}function se(e){return typeof e=="string"?new S(ie(e)):(e.scheme||(e.scheme=p.scheme),e)}function Yr(e){return fr.test(e)}function Zr(e,r){let t=C(e),n=Object.keys(t.query||{});return n.length>0&&r&&r.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${n.join(", ")}.`),t.path}function G(e,r,t){let n=C(e),s=n.query||{};return s[r]=String(t),`${n.path}?${$(s)}`}function J(e,r){if(!r)return e;let t=C(e),n=t.query||{};for(let[o,a]of Object.entries(r))a!=null&&(n[o]=a);let s=$(n);return s?`${t.path}?${s}`:t.path}function et(e){if(e==null)return null;let r=e.match(ve);return r?r[2]:null}function rt(e){if(e==null)return null;let r=e.match(ve);return r?{path:r[1],extension:r[2]}:{path:e,extension:null}}function tt(e){return m(this,null,function*(){return typeof e=="string"?N(e)??{data:e}:new Promise((r,t)=>{let n=new FileReader;n.readAsDataURL(e),n.onload=()=>r(N(n.result)),n.onerror=s=>t(s)})})}var ve=/([^.]*)\.([^\/]*)$/,fr=/(^data:image\/svg|\.svg$)/i;var pr="20231115",dr="a6fcf2901ef678ef17a528e11b93ffe09e3ec267";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");var mr="4.28",d,hr=mr;hr="4.28.10";function ut(e){d=e}function ct(e){let r=d?.findCredential(e);return r?.token?G(e,"token",r.token):e}x("host-webworker");var yr=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function Ue(e){let r=h(e,!0);return!!r&&r.endsWith(".arcgis.com")&&!yr.has(r)&&!e.endsWith("/sharing/rest/generateToken")}function ke(e,r,t=!1,n){return new Promise((s,o)=>{if(j(n))return void o(Pe());let a=()=>{l(),o(new Error(`Unable to load ${r}`))},i=()=>{let f=e;l(),s(f)},u=()=>{if(!e)return;let f=e;l(),f.src="",o(Pe())},l=()=>{x("esri-image-decode")||(e.removeEventListener("error",a),e.removeEventListener("load",i)),a=null,i=null,e=null,n?.removeEventListener("abort",u),u=null,t&&URL.revokeObjectURL(r)};n?.addEventListener("abort",u),x("esri-image-decode")?e.decode().then(i,a):(e.addEventListener("error",a),e.addEventListener("load",i))})}function Pe(){try{return new DOMException("Aborted","AbortError")}catch{let e=new Error;return e.name="AbortError",e}}var gr="Timeout exceeded";function Ae(){return new Error(gr)}function $e(e){g.request.crossOriginNoCorsDomains||(g.request.crossOriginNoCorsDomains={});let r=g.request.crossOriginNoCorsDomains;for(let t of e)t=t.toLowerCase(),/^https?:\/\//.test(t)?r[h(t)??""]=0:(r[h("http://"+t)??""]=0,r[h("https://"+t)??""]=0)}function Le(e){let r=g.request.crossOriginNoCorsDomains;if(r){let t=h(e);if(t)return t=t.toLowerCase(),!U(t,_())&&r[t]<Date.now()-36e5}return!1}function Re(e){return m(this,null,function*(){let r=g.request.crossOriginNoCorsDomains,t=h(e);r&&t&&(r[t.toLowerCase()]=Date.now());let n=C(e);e=n.path,n.query?.f==="json"&&(e+="?f=json");try{yield fetch(e,{mode:"no-cors",credentials:"include"})}catch{}})}function O(e,r){return m(this,null,function*(){e instanceof URL&&(e=e.toString()),r?.query instanceof URLSearchParams&&(r.query=M(r.query.toString().replaceAll("+"," ")));let t=z(e),n=Q(e);n||t||(e=k(e));let s={url:e,requestOptions:y({},r)},o=Ce(e);if(o){let l=yield Cr(o,s);if(l!=null)return{data:l,getHeader:ce,httpStatus:200,requestOptions:s.requestOptions,url:s.url};o.after||o.error||(o=null)}if(e=s.url,(r=s.requestOptions).responseType==="image"&&(x("host-webworker")||x("host-node")))throw q("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),s);if(r.method==="head"){if(r.body)throw q("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),s);if(t||n)throw q("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),s)}if(yield Or(),V)return V.execute(e,r);let a=new AbortController;me(r,()=>a.abort());let i={controller:a,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:o,params:s,redoRequest:!1,useIdentity:w.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},u=yield Ur(i);return o?.after?.(u),u})}var V,w=g.request,je="FormData"in globalThis,wr=new Set([499,498,403,401]),br=new Set(["COM_0056","COM_0057","SB_0008"]),xr=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],ce=()=>null,X=Symbol();function qr(e){let r=h(e);r&&!O._corsServers.includes(r)&&O._corsServers.push(r)}function Ee(e){let r=h(e);return!r||r.endsWith(".arcgis.com")||O._corsServers.includes(r)||W(r)}function q(e,r,t,n){let s="Error",o={url:t.url,requestOptions:t.requestOptions,getHeader:ce,ssl:!1};if(r instanceof P)return r.details?(r.details=pe(r.details),r.details.url=t.url,r.details.requestOptions=t.requestOptions):r.details=o,r;if(r){let a=n&&(l=>n.headers.get(l)),i=n?.status,u=r.message;u&&(s=u),a&&(o.getHeader=a),o.httpStatus=(r.httpCode!=null?r.httpCode:r.code)||i||0,o.subCode=r.subcode,o.messageCode=r.messageCode,typeof r.details=="string"?o.messages=[r.details]:o.messages=r.details,o.raw=X in r?r[X]:r}return he(r)?ee():new P(e,s,o)}function Or(){return m(this,null,function*(){x("host-webworker")?V||(V=yield import("./chunk-Y332OWHR.js")):O._abortableFetch||(O._abortableFetch=globalThis.fetch.bind(globalThis))})}function ue(){return m(this,null,function*(){d||(yield import("./chunk-LXQVNBQF.js"))})}function Tr(e){return m(this,null,function*(){let r=e.params.url,t=e.params.requestOptions,n=e.controller.signal,s=t.body,o=null,a=null;if(je&&"HTMLFormElement"in globalThis&&(s instanceof FormData?o=s:s instanceof HTMLFormElement&&(o=new FormData(s))),typeof s=="string"&&(a=s),e.fetchOptions={cache:t.cacheBust&&!("polyfill"in O._abortableFetch)?"no-cache":"default",credentials:"same-origin",headers:t.headers||{},method:t.method==="head"?"HEAD":"GET",mode:"cors",priority:w.priority,redirect:"follow",signal:n},(o||a)&&(e.fetchOptions.body=o||a),t.authMode==="anonymous"&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(r)||t.query?.token||o?.get("token")),!e.hasToken&&g.apiKey&&Ue(r)&&(t.query||(t.query={}),t.query.token=g.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!Ie(r)&&!j(n)){let i;t.authMode==="immediate"?(yield ue(),i=yield d.getCredential(r,{signal:n}),e.credential=i):t.authMode==="no-prompt"?(yield ue(),i=yield d.getCredential(r,{prompt:!1,signal:n}).catch(()=>{}),e.credential=i):d&&(i=d.findCredential(r)),i&&(e.credentialToken=i.token,e.useSSL=!!i.ssl)}})}function Ie(e){return xr.some(r=>r.test(e))}function Sr(e){return m(this,null,function*(){let r=e.params.url,t=e.params.requestOptions,n=e.fetchOptions??{},s=Q(r)||z(r),o=t.responseType||"json",a=s?0:t.timeout!=null?t.timeout:w.timeout,i=!1;if(!s){e.useSSL&&(r=K(r)),t.cacheBust&&n.cache==="default"&&(r=G(r,"request.preventCache",Date.now()));let c=y({},t.query);e.credentialToken&&(c.token=e.credentialToken);let b=$(c);x("esri-url-encodes-apostrophe")&&(b=b.replaceAll("'","%27"));let Y=r.length+1+b.length,Z;i=t.method==="delete"||t.method==="post"||t.method==="put"||!!t.body||Y>w.maxUrlLength;let D=t.useProxy||!!R(r);if(D){let B=Oe(r);Z=B.path,!i&&Z.length+1+Y>w.maxUrlLength&&(i=!0),B.query&&(c=y(y({},B.query),c))}if(n.method==="HEAD"&&(i||D)){if(i)throw Y>w.maxUrlLength?q("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params):q("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params);if(D)throw q("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}i?(n.method=t.method==="delete"?"DELETE":t.method==="put"?"PUT":"POST",t.body?r=J(r,c):(n.body=$(c),n.headers||(n.headers={}),n.headers["Content-Type"]="application/x-www-form-urlencoded")):r=J(r,c),D&&(e.useProxy=!0,r=`${Z}?${r}`),c.token&&je&&n.body instanceof FormData&&!ye(r)&&n.body.set("token",c.token),t.hasOwnProperty("withCredentials")?e.withCredentials=t.withCredentials:U(r,_())||(W(r)||d&&d.findServerInfo(r)?.webTierAuth)&&(e.withCredentials=!0),e.withCredentials&&(n.credentials="include",Le(r)&&(yield Re(i?J(r,c):r)))}let u,l,f=0,T=!1;a>0&&(f=setTimeout(()=>{T=!0,e.controller.abort()},a));try{if(t.responseType==="native-request-init")l=n,l.url=r;else if(t.responseType!=="image"||n.cache!=="default"||n.method!=="GET"||i||vr(t.headers)||!s&&!e.useProxy&&w.proxyUrl&&!Ee(r)){if(u=yield O._abortableFetch(r,n),e.useProxy||qr(r),t.responseType==="native")l=u;else if(n.method!=="HEAD")if(u.ok){switch(o){case"array-buffer":l=yield u.arrayBuffer();break;case"blob":case"image":l=yield u.blob();break;default:l=yield u.text()}if(f&&(clearTimeout(f),f=0),o==="json"||o==="xml"||o==="document")if(l)switch(o){case"json":l=JSON.parse(l);break;case"xml":l=De(l,"application/xml");break;case"document":l=De(l,"text/html")}else l=null;if(l){if(o==="array-buffer"||o==="blob"){let c=u.headers.get("Content-Type");if(c&&/application\/json|text\/plain/i.test(c)&&l[o==="blob"?"size":"byteLength"]<=750)try{let b=yield new Response(l).json();b.error&&(l=b)}catch{}}o==="image"&&l instanceof Blob&&(l=yield Be(URL.createObjectURL(l),e,!0))}}else{l=yield u.text();try{l=JSON.parse(l)}catch{}}}else l=yield Be(r,e)}catch(c){if(c.name==="AbortError")throw T?Ae():ee("Request canceled");if(!(!u&&c instanceof TypeError&&w.proxyUrl)||t.body||t.method==="delete"||t.method==="head"||t.method==="post"||t.method==="put"||e.useProxy||Ee(r))throw c;e.redoRequest=!0,Se({proxyUrl:w.proxyUrl,urlPrefix:h(r)??""})}finally{f&&clearTimeout(f)}return[u,l]})}function Cr(e,r){return m(this,null,function*(){if(e.responseData!=null)return e.responseData;if(e.headers&&(r.requestOptions.headers=y(y({},r.requestOptions.headers),e.headers)),e.query&&(r.requestOptions.query=y(y({},r.requestOptions.query),e.query)),e.before){let t,n;try{n=yield e.before(r)}catch(s){t=q("request:interceptor",s,r)}if((n instanceof Error||n instanceof P)&&(t=q("request:interceptor",n,r)),t)throw e.error&&e.error(t),t;return n}})}function vr(e){if(e){for(let r of Object.getOwnPropertyNames(e))if(e[r])return!0}return!1}function De(e,r){let t;try{t=new DOMParser().parseFromString(e,r)}catch{}if(!t||t.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return t}function Ur(e){return m(this,null,function*(){let r,t;yield Tr(e);try{do[r,t]=yield Sr(e);while(!(yield Pr(e,r,t)))}catch(o){let a=q("request:server",o,e.params,r);throw a.details.ssl=e.useSSL,e.interceptor?.error&&e.interceptor.error(a),a}let n=e.params.url;if(t&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(n)){if(!e.hasToken&&!e.credentialToken&&t.user?.username&&!W(n)){let o=h(n,!0);o&&w.trustedServers.push(o)}Array.isArray(t.authorizedCrossOriginNoCorsDomains)&&$e(t.authorizedCrossOriginNoCorsDomains)}let s=e.credential;if(s&&d){let a=d.findServerInfo(s.server)?.owningSystemUrl;if(a){a=a.replace(/\/?$/,"/sharing");let i=d.findCredential(a,s.userId);i&&d._getIdenticalSvcIdx(a,i)===-1&&i.resources.unshift(a)}}return{data:t,getHeader:r?o=>r?.headers.get(o):ce,httpStatus:r?.status??200,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}})}function Pr(e,r,t){return m(this,null,function*(){if(e.redoRequest)return e.redoRequest=!1,!1;let n=e.params.requestOptions;if(!r||n.responseType==="native"||n.responseType==="native-request-init")return!0;let s,o;if(t&&(t.error?s=t.error:t.status==="error"&&Array.isArray(t.messages)&&(s=y({},t),s[X]=t,s.details=t.messages)),!s&&!r.ok)throw s=new Error(`Unable to load ${r.url} status: ${r.status}`),s[X]=t,s;let a,i=null;s&&(o=Number(s.code),i=s.hasOwnProperty("subcode")?Number(s.subcode):null,a=s.messageCode,a=a?.toUpperCase());let u=n.authMode;if(o===403&&(i===4||s.message?.toLowerCase().includes("ssl")&&!s.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&(u!=="no-prompt"||o===498)&&o!==void 0&&wr.has(o)&&!Ie(e.params.url)&&(o!==403||(!a||!br.has(a))&&(i==null||i===2&&e.credentialToken))){yield ue();try{let l=yield d.getCredential(e.params.url,{error:q("request:server",s,e.params),prompt:u!=="no-prompt",signal:e.controller.signal,token:e.credentialToken});return e.credential=l,e.credentialToken=l.token,e.useSSL=e.useSSL||l.ssl,!1}catch(l){if(u==="no-prompt")return e.credential=void 0,e.credentialToken=void 0,!1;s=l}}if(s)throw s;return!0})}function Be(e,r,t=!1){let n=r.controller.signal,s=new Image;return r.withCredentials?s.crossOrigin="use-credentials":s.crossOrigin="anonymous",s.alt="",s.fetchPriority=w.priority,s.src=e,ke(s,e,t,n)}O._abortableFetch=null,O._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];export{te as a,ye as b,ge as c,S as d,_ as e,Ir as f,C as g,M as h,$ as i,Hr as j,R as k,Nr as l,Fr as m,Ce as n,U as o,ie as p,_r as q,k as r,Ye as s,E as t,Q as u,z as v,Ze as w,Mr as x,N as y,Wr as z,Qr as A,zr as B,Kr as C,v as D,tr as E,K as F,Gr as G,Jr as H,ir as I,Vr as J,Xr as K,Yr as L,Zr as M,G as N,J as O,et as P,rt as Q,tt as R,pr as S,dr as T,mr as U,d as V,hr as W,ut as X,ct as Y,Ue as Z,ke as _,O as $};
