import{a as K}from"./chunk-7QY3BMVN.js";import{a as N}from"./chunk-4HXOVZYF.js";import{a as T}from"./chunk-U2QVIRVP.js";import{l as H,m as J}from"./chunk-CJJRHJ2S.js";import{b as Q,c as B,d as X,e as D}from"./chunk-4ATIL3QV.js";import{c as C}from"./chunk-55ESOXMJ.js";import{a as $}from"./chunk-XDTDVCGP.js";import{p as U,r as w}from"./chunk-465DRXTW.js";function p(e,t){return e?t?4:3:t?3:2}var z=U.getLogger("esri.layers.graphics.featureConversionUtils"),ne={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},ye=(e,t,n,o,s,r)=>{e[n]=s,e[n+1]=r},W=(e,t,n,o,s,r)=>{e[n]=s,e[n+1]=r,e[n+2]=t[o+2]},pe=(e,t,n,o,s,r)=>{e[n]=s,e[n+1]=r,e[n+2]=t[o+3]},Fe=(e,t,n,o,s,r)=>{e[n]=s,e[n+1]=r,e[n+2]=t[o+2],e[n+3]=t[o+3]};function O(e,t,n,o){if(e){if(n)return t&&o?Fe:W;if(t&&o)return pe}else if(t&&o)return W;return ye}function q({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function E({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function S({scale:e,translate:t},n,o){return n*e[o]+t[o]}function Le(e,t,n){return e?t?n?j(e):Y(e):n?A(e):k(e):null}function k(e){let t=e.coords;return{x:t[0],y:t[1]}}function oe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function Y(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function Ie(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function A(e){let t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function be(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function j(e){let t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function Me(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function Ge(e,t,n,o){let s=k;n&&o?s=j:n?s=Y:o&&(s=A);for(let r of t){let{geometry:u,attributes:l}=r,i=u!=null?s(u):null;e.push({attributes:l,geometry:i})}return e}function _(e,t){return e&&t?Me:e?Ie:t?be:oe}function re(e,t,n,o,s){let r=_(n,o);for(let{geometry:u,attributes:l}of t){let i=u!=null?r(new T,u):null;e.push(new N(i,l,null,s?l[s]:void 0))}return e}function Re(e,t,n=_(t.z!=null,t.m!=null)){return n(e,t)}function Te(e,t,n,o){for(let{geometry:s,attributes:r}of t)e.push({attributes:r,geometry:s!=null?se(s,n,o):null});return e}function se(e,t,n){if(e==null)return null;let o=p(t,n),s=[];for(let r=0;r<e.coords.length;r+=o){let u=[];for(let l=0;l<o;l++)u.push(e.coords[r+l]);s.push(u)}return t?n?{points:s,hasZ:t,hasM:n}:{points:s,hasZ:t}:n?{points:s,hasM:n}:{points:s}}function ue(e,t,n,o,s){let r=p(n,o);for(let{geometry:u,attributes:l}of t){let i=u!=null?le(new T,u,r):null;e.push(new N(i,l,null,s?l[s]:void 0))}return e}function le(e,t,n=p(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;let o=e.coords,s=0;for(let r of t.points)for(let u=0;u<n;u++)o[s++]=r[u];return e}function ve(e,t,n,o){for(let{geometry:s,attributes:r}of t)e.push({attributes:r,geometry:s!=null?ce(s,n,o):null});return e}function ce(e,t,n){if(!e)return null;let o=p(t,n),{coords:s,lengths:r}=e,u=[],l=0;for(let i of r){let c=[];for(let a=0;a<i;a++){let f=[];for(let m=0;m<o;m++)f.push(s[l++]);c.push(f)}u.push(c)}return t?n?{paths:u,hasZ:t,hasM:n}:{paths:u,hasZ:t}:n?{paths:u,hasM:n}:{paths:u}}function ie(e,t,n,o,s){let r=p(n,o);for(let{geometry:u,attributes:l}of t){let i=u!=null?ae(new T,u,r):null;e.push(new N(i,l,null,s?l[s]:void 0))}return e}function ae(e,t,n=p(t.hasZ,t.hasM)){let{lengths:o,coords:s}=e,r=0;for(let u of t.paths){for(let l of u)for(let i=0;i<n;i++)s[r++]=l[i];o.push(u.length)}return e}function we(e,t,n,o){for(let{geometry:s,attributes:r,centroid:u}of t){let l=s!=null?fe(s,n,o):null;if(u!=null){let i=k(u);e.push({attributes:r,centroid:i,geometry:l})}else e.push({attributes:r,geometry:l})}return e}function fe(e,t,n){if(!e)return null;let o=p(t,n),{coords:s,lengths:r}=e,u=[],l=0;for(let i of r){let c=[];for(let a=0;a<i;a++){let f=[];for(let m=0;m<o;m++)f.push(s[l++]);c.push(f)}u.push(c)}return t?n?{rings:u,hasZ:t,hasM:n}:{rings:u,hasZ:t}:n?{rings:u,hasM:n}:{rings:u}}function me(e,t,n,o,s){for(let{geometry:r,centroid:u,attributes:l}of t){let i=r!=null?de(new T,r,n,o):null,c=s?l[s]:void 0;u!=null?e.push(new N(i,l,oe(new T,u),c)):e.push(new N(i,l,null,c))}return e}function de(e,t,n=t.hasZ,o=t.hasM){return Ne(e,t.rings,n,o)}function Ne(e,t,n,o){let s=p(n,o),{lengths:r,coords:u}=e,l=0;v(e);for(let i of t){for(let c of i)for(let a=0;a<s;a++)u[l++]=c[a];r.push(i.length)}return e}var P=[],x=[];function Ue(e,t,n,o,s){P[0]=e;let[r]=he(x,P,t,n,o,s);return G(P),G(x),r}function he(e,t,n,o,s,r){if(G(e),!n){for(let u of t){let l=r?u.attributes[r]:void 0;e.push(new N(null,u.attributes,null,l))}return e}switch(n){case"esriGeometryPoint":return re(e,t,o,s,r);case"esriGeometryMultipoint":return ue(e,t,o,s,r);case"esriGeometryPolyline":return ie(e,t,o,s,r);case"esriGeometryPolygon":return me(e,t,o,s,r);default:z.error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${n}'`)),G(e)}return e}function $e(e,t,n,o,s,r){let u=e.length;switch(n){case"esriGeometryPoint":re(e,t,o,s,r);break;case"esriGeometryMultipoint":ue(e,t,o,s,r);break;case"esriGeometryPolyline":ie(e,t,o,s,r);break;case"esriGeometryPolygon":me(e,t,o,s,r);break;default:z.error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${n}'`))}for(let l=0;l<t.length;l++)e[l+u].geometryType=n,e[l+u].insertAfter=t[l].insertAfter,e[l+u].groupId=t[l].groupId;return e}function Ce(e,t,n,o){x[0]=e,ge(P,x,t,n,o);let s=P[0];return G(P),G(x),s}function Qe(e,t,n){if(e==null)return null;let o=new T;return"hasZ"in e&&t==null&&(t=e.hasZ),"hasM"in e&&n==null&&(n=e.hasM),B(e)?_(t??e.z!=null,n??e.m!=null)(o,e):D(e)?de(o,e,t,n):X(e)?ae(o,e,p(t,n)):Q(e)?le(o,e,p(t,n)):void z.error("convertFromGeometry:unknown-geometry",new w(`Unable to parse unknown geometry type '${e}'`))}function Pe(e,t,n,o){let s=e&&("coords"in e?e:e.geometry);if(s==null)return null;switch(t){case"esriGeometryPoint":{let r=k;return n&&o?r=j:n?r=Y:o&&(r=A),r(s)}case"esriGeometryMultipoint":return se(s,n,o);case"esriGeometryPolyline":return ce(s,n,o);case"esriGeometryPolygon":return fe(s,n,o);default:return z.error("convertToGeometry:unknown-geometry",new w(`Unable to parse unknown geometry type '${t}'`)),null}}function ze(e,t){for(let n of t)e.push({attributes:n.attributes});return e}function ge(e,t,n,o,s){if(G(e),n==null)return ze(e,t);switch(n){case"esriGeometryPoint":return Ge(e,t,o,s);case"esriGeometryMultipoint":return Te(e,t,o,s);case"esriGeometryPolyline":return ve(e,t,o,s);case"esriGeometryPolygon":return we(e,t,o,s);default:z.error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${n}'`))}return e}function Be(e){let{objectIdFieldName:t,spatialReference:n,transform:o,fields:s,hasM:r,hasZ:u,features:l,geometryType:i,exceededTransferLimit:c,uniqueIdField:a,queryGeometry:f,queryGeometryType:m}=e,d={features:ge([],l,i,u,r),fields:s,geometryType:i,objectIdFieldName:t,spatialReference:n,uniqueIdField:a,queryGeometry:Pe(f,m,!1,!1)};return o&&(d.transform=o),c&&(d.exceededTransferLimit=c),r&&(d.hasM=r),u&&(d.hasZ=u),d}function Xe(e,t){let n=new K,{hasM:o,hasZ:s,features:r,objectIdFieldName:u,spatialReference:l,geometryType:i,exceededTransferLimit:c,transform:a,fields:f}=e;return f&&(n.fields=f),n.geometryType=i??null,n.objectIdFieldName=u??t??null,n.spatialReference=l??null,n.objectIdFieldName?(r&&he(n.features,r,i,s,o,n.objectIdFieldName),c&&(n.exceededTransferLimit=c),o&&(n.hasM=o),s&&(n.hasZ=s),a&&(n.transform=a),n):(z.error(new w("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function De(e){let{transform:t,features:n,hasM:o,hasZ:s}=e;if(!t)return e;for(let r of n)r.geometry!=null&&te(r.geometry,r.geometry,o,s,t),r.centroid!=null&&te(r.centroid,r.centroid,o,s,t);return e.transform=null,e}function He(e,t){let{geometryType:n,features:o,hasM:s,hasZ:r}=t;if(!e)return t;for(let u=0;u<o.length;u++){let l=o[u],i=l.weakClone();i.geometry=new T,ee(i.geometry,l.geometry,s,r,n,e),l.centroid&&(i.centroid=new T,ee(i.centroid,l.centroid,s,r,"esriGeometryPoint",e)),o[u]=i}return t.transform=e,t}function ee(e,t,n,o,s,r,u=n,l=o){if(v(e),!t?.coords.length)return null;let i=ne[s],{coords:c,lengths:a}=t,f=p(n,o),m=p(n&&u,o&&l),d=O(n,o,u,l);if(!a.length)return d(e.coords,c,0,0,q(r,c[0]),E(r,c[1])),v(e,f,0),e;let h,y,I,b,F=0,g=0,M=g;for(let L of a){if(L<i)continue;let Z=0;g=M,I=h=q(r,c[F]),b=y=E(r,c[F+1]),d(e.coords,c,g,F,I,b),Z++,F+=f,g+=m;for(let R=1;R<L;R++,F+=f)I=q(r,c[F]),b=E(r,c[F+1]),I===h&&b===y||(d(e.coords,c,g,F,I-h,b-y),g+=m,Z++,h=I,y=b);Z>=i&&(e.lengths.push(Z),M=g)}return G(e.coords,M),e.coords.length?e:null}function Je(e,t,n,o,s,r,u=n,l=o){if(v(e),!t?.coords.length)return null;let i=ne[s],{coords:c,lengths:a}=t,f=p(n,o),m=p(n&&u,o&&l),d=O(n,o,u,l);if(!a.length)return d(e.coords,c,0,0,c[0],c[1]),v(e,f,0),e;let h=0,y=r*r;for(let I of a){if(I<i){h+=I*f;continue}let b=e.coords.length/m,F=h,g=h+(I-1)*f;d(e.coords,c,e.coords.length,F,c[F],c[F+1]),V(e.coords,c,f,y,d,F,g),d(e.coords,c,e.coords.length,g,c[g],c[g+1]);let M=e.coords.length/m-b;M>=i?e.lengths.push(M):G(e.coords,b*m),h+=I*f}return e.coords.length?e:null}function xe(e,t,n,o){let s=e[t],r=e[t+1],u=e[n],l=e[n+1],i=e[o],c=e[o+1],a=u,f=l,m=i-a,d=c-f;if(m!==0||d!==0){let h=((s-a)*m+(r-f)*d)/(m*m+d*d);h>1?(a=i,f=c):h>0&&(a+=m*h,f+=d*h)}return m=s-a,d=r-f,m*m+d*d}function V(e,t,n,o,s,r,u){let l,i=o,c=0;for(let a=r+n;a<u;a+=n)l=xe(t,a,r,u),l>i&&(c=a,i=l);i>o&&(c-r>n&&V(e,t,n,o,s,r,c),s(e,t,e.length,c,t[c],t[c+1]),u-c>n&&V(e,t,n,o,s,c,u))}function Ke(e,t,n,o){if(!t?.coords?.length)return null;let s=p(n,o),r=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(t&&t.coords){let c=t.coords;for(let a=0;a<c.length;a+=s){let f=c[a],m=c[a+1];r=Math.min(r,f),l=Math.max(l,f),u=Math.min(u,m),i=Math.max(i,m)}}return J(e)?H(e,r,u,l,i):C(r,u,l,i,e),e}function te(e,t,n,o,s){let{coords:r,lengths:u}=t,l=p(n,o);if(!r.length)return e!==t&&v(e),e;$(s);let{originPosition:i,scale:c,translate:a}=s,f=ke;f.originPosition=i;let m=f.scale;m[0]=c[0]??1,m[1]=-(c[1]??1),m[2]=c[2]??1,m[3]=c[3]??1;let d=f.translate;if(d[0]=a[0]??0,d[1]=a[1]??0,d[2]=a[2]??0,d[3]=a[3]??0,!u.length){for(let y=0;y<l;++y)e.coords[y]=S(f,r[y],y);return e!==t&&v(e,l,0),e}let h=0;for(let y=0;y<u.length;y++){let I=u[y];e.lengths[y]=I;for(let g=0;g<l;++g)e.coords[h+g]=S(f,r[h+g],g);let b=e.coords[h],F=e.coords[h+1];h+=l;for(let g=1;g<I;g++,h+=l){b+=r[h]*m[0],F+=r[h+1]*m[1],e.coords[h]=b,e.coords[h+1]=F;for(let M=2;M<l;++M)e.coords[h+M]=S(f,r[h+M],M)}}return e!==t&&v(e,r.length,u.length),e}function We(e,t,n,o,s,r){if(v(e),e.lengths.push(...t.lengths),n===s&&o===r)for(let u=0;u<t.coords.length;u++)e.coords.push(t.coords[u]);else{let u=p(n,o),l=O(n,o,s,r),i=t.coords;for(let c=0;c<i.length;c+=u)l(e.coords,i,e.coords.length,c,i[c],i[c+1])}return e}function Ze(e,t,n,o){let s=0,r=e[o*t],u=e[o*(t+1)];for(let l=1;l<n;l++){let i=r+e[o*(t+l)],c=u+e[o*(t+l)+1],a=(i-r)*(c+u);r=i,u=c,s+=a}return .5*s}function et(e,t){let{coords:n,lengths:o}=e,s=0,r=0;for(let u=0;u<o.length;u++){let l=o[u];r+=Ze(n,s,l,t),s+=l}return Math.abs(r)}function v(e,t=0,n=0){G(e.lengths,n),G(e.coords,t)}function G(e,t=0){e.length!==t&&(e.length=t)}var ke={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{q as a,E as b,Le as c,Re as d,se as e,ce as f,ae as g,fe as h,de as i,Ne as j,Ue as k,he as l,$e as m,Ce as n,Qe as o,Pe as p,Be as q,Xe as r,De as s,He as t,ee as u,Je as v,Ke as w,te as x,We as y,et as z};
