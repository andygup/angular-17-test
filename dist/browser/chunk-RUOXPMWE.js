import{$ as N,Ea as T,Fa as M,Q as c,R as f,U as A,V as g,W as J,Y as d,Z as m,_ as F,a as S,aa as D,b as u,ba as x,c as l,ca as L,da as h,ea as j,fa as E,m as k,ma as I,oa as C,pa as P,qa as V,ra as q}from"./chunk-WMY3KSI4.js";import{a as i}from"./chunk-URPCXPAW.js";import{a as w}from"./chunk-AHKJJNRE.js";import{g as p}from"./chunk-ESDYQQXO.js";function H(t){z=t}var z;function b(t){return t===null?null:h(t)?t.clone():f(t)?t:d(t)?t.clone():L(t)?t.toArray().map(e=>b(e)):m(t)?t.map(e=>b(e)):F(t)?z.createFromArcadeFeature(t):x(t)||N(t)?t:D(t)||t?.declaredClass==="esri.arcade.Attachment"?t.deepClone():(t?.declaredClass==="esri.arcade.Portal"||t instanceof S||c(t),t)}function y(t,e,s=!1,n=!1){if(t==null)return null;if(J(t))return P(t);if(g(t))return q(t);if(A(t))return I(t);if(h(t))return V(t,e);if(j(t)||E(t))return t;if(m(t)){let a=[];for(let o of t)a.push(y(o,e,s,n));return a}if(n&&d(t))return t;let r=new v;r.immutable=!1;for(let a of Object.keys(t)){let o=t[a];o!==void 0&&r.setField(a,y(o,e,s,n))}return r.immutable=s,r}var v=class t{constructor(e){this.declaredClass="esri.arcade.Dictionary",this.attributes=null,this.plain=!1,this.immutable=!0,this.attributes=e instanceof t?e.attributes:e??{}}field(e){let s=e.toLowerCase(),n=this.attributes[e];if(n!==void 0)return n;for(let r in this.attributes)if(r.toLowerCase()===s)return this.attributes[r];throw new l(null,u.FieldNotFound,null,{key:e})}setField(e,s){if(this.immutable)throw new l(null,u.Immutable,null);if(c(s))throw new l(null,u.NoFunctionInDictionary,null);let n=e.toLowerCase();if(s instanceof Date&&(s=i.dateJSToArcadeDate(s)),this.attributes[e]===void 0){for(let r in this.attributes)if(r.toLowerCase()===n)return void(this.attributes[r]=s);this.attributes[e]=s}else this.attributes[e]=s}hasField(e){let s=e.toLowerCase();if(this.attributes[e]!==void 0)return!0;for(let n in this.attributes)if(n.toLowerCase()===s)return!0;return!1}keys(){let e=[];for(let s in this.attributes)e.push(s);return e=e.sort(),e}castToText(e=!1){let s="";for(let n in this.attributes){s!==""&&(s+=",");let r=this.attributes[n];r==null?s+=JSON.stringify(n)+":null":g(r)||J(r)||A(r)?s+=JSON.stringify(n)+":"+JSON.stringify(r):r instanceof w?s+=JSON.stringify(n)+":"+C(r):r instanceof k||r instanceof Array?s+=JSON.stringify(n)+":"+C(r,null,e):r instanceof i?s+=e?JSON.stringify(n)+":"+JSON.stringify(r.getTime()):JSON.stringify(n)+":"+r.stringify():r!==null&&typeof r=="object"&&r.castToText!==void 0&&(s+=JSON.stringify(n)+":"+r.castToText(e))}return"{"+s+"}"}static convertObjectToArcadeDictionary(e,s,n=!0,r=!1){let a=new t;a.immutable=!1;for(let o in e){let O=e[o];O!==void 0&&a.setField(o.toString(),y(O,s,n,r))}return a.immutable=n,a}static convertJsonToArcade(e,s,n=!1){return y(e,s,n)}castAsJson(e=null){let s={};for(let n in this.attributes){let r=this.attributes[n];r!==void 0&&(e?.keyTranslate&&(n=e.keyTranslate(n)),s[n]=T(r,e))}return s}castDictionaryValueAsJsonAsync(e,s,n,r=null,a){return p(this,null,function*(){let o=yield M(n,r,a);return e[s]=o,o})}castAsJsonAsync(e=null,s=null){return p(this,null,function*(){let n={},r=[];for(let a in this.attributes){let o=this.attributes[a];s?.keyTranslate&&(a=s.keyTranslate(a)),o!==void 0&&(f(o)||o instanceof w||o instanceof i?n[a]=T(o,s):r.push(this.castDictionaryValueAsJsonAsync(n,a,o,e,s)))}return r.length>0&&(yield Promise.all(r)),n})}deepClone(){let e=new t;e.immutable=!1;for(let s of this.keys())e.setField(s,b(this.field(s)));return e}};export{H as a,b,v as c};
