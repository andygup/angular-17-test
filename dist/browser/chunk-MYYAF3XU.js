import{i as E,j as z,k as O,l as G,m as M}from"./chunk-VGW7YJZ7.js";import{c as x}from"./chunk-UW2TVJUN.js";import{b as A,t as y,u as p}from"./chunk-MYELF7MV.js";import{a}from"./chunk-HPJ6EQFO.js";import{a as T}from"./chunk-QAVDKCSH.js";import{a as m}from"./chunk-AQ74ANSJ.js";import{g as L}from"./chunk-4LHUJTP5.js";import{a as S}from"./chunk-HB7BVTLV.js";import{a as w}from"./chunk-IUPUERVS.js";import{$ as P}from"./chunk-XF4NUYV7.js";import{a as I,b as g,g as f}from"./chunk-ESDYQQXO.js";function R(e,t,o,n){if(e)if(e.type!=="CIMTextSymbol"){if(o&&e.effects)for(let r of e.effects)H(r,t);if(e.symbolLayers)for(let r of e.symbolLayers)switch(r.type){case"CIMPictureMarker":case"CIMVectorMarker":D(r,t,n);break;case"CIMPictureStroke":case"CIMSolidStroke":!n?.preserveOutlineWidth&&r.width&&(r.width*=t);break;case"CIMPictureFill":r.height&&(r.height*=t),r.offsetX&&(r.offsetX*=t),r.offsetY&&(r.offsetY*=t);break;case"CIMHatchFill":R(r.lineSymbol,t,!0,g(I({},n),{preserveOutlineWidth:!1})),r.offsetX&&(r.offsetX*=t),r.offsetY&&(r.offsetY*=t),r.separation&&(r.separation*=t)}}else e.height!=null&&(e.height*=t)}function D(e,t,o){if(e&&(e.markerPlacement&&U(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&e.anchorPointUnits==="Absolute"&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=e.size!=null?e.size*t:0,e.type==="CIMVectorMarker"&&e.markerGraphics))for(let n of e.markerGraphics)e.scaleSymbolsProportionally||R(n.symbol,t,!0,o)}function U(e,t){switch(M(e)&&e.offset&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){let o=e.placementTemplate.map(n=>n*t);e.placementTemplate=o}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){let o=e.placementTemplate.map(n=>n*t);e.placementTemplate=o}break;case"CIMMarkerPlacementOnLine":e.startPointOffset&&(e.startPointOffset*=t);break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case"CIMMarkerPlacementPolygonCenter":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMMarkerPlacementInsidePolygon":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}function H(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width&&(e.width*=t);break;case"CIMGeometricEffectBuffer":e.size&&(e.size*=t);break;case"CIMGeometricEffectCut":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case"CIMGeometricEffectDashes":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){let o=e.dashTemplate.map(n=>n*t);e.dashTemplate=o}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length&&(e.length*=t);break;case"CIMGeometricEffectMove":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset&&(e.offset*=t);break;case"CIMGeometricEffectRegularPolygon":e.radius&&(e.radius*=t);break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case"CIMGeometricEffectWave":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function C(e){let t=[];return d(z(e),t),t.length?new a(E(t[0])):null}function d(e,t){if(!e)return;let o;o=e.type==="CIMTextSymbol"?e.symbol:e;let n=e.type==="CIMPolygonSymbol";if(o?.symbolLayers){for(let r of o.symbolLayers)if(!(r.colorLocked||n&&(G(r)||O(r)&&r.markerPlacement&&M(r.markerPlacement))))switch(r.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":r.tintColor&&F(t,r.tintColor);break;case"CIMVectorMarker":r.markerGraphics?.forEach(l=>{d(l.symbol,t)});break;case"CIMSolidStroke":case"CIMSolidFill":F(t,r.color);break;case"CIMHatchFill":d(r.lineSymbol,t)}}}function F(e,t){for(let o of e)if(o.join(".")===t.join("."))return;e.push(t)}var X="picture-fill",Y="simple-fill",J="simple-line",j="simple-marker",N="text",B="cim",k=new T(1e3);function Me(e){let t=e.style,o=null;if(e)switch(e.type){case j:t!=="cross"&&t!=="x"&&(o=e.color);break;case Y:t==="solid"?o=e.color:t!=="none"&&(o={type:"pattern",x:0,y:0,src:w(`esri/symbols/patterns/${t}.png`),width:5,height:5});break;case X:o={type:"pattern",src:e.url,width:m(e.width)*e.xscale,height:m(e.height)*e.yscale,x:m(e.xoffset),y:m(e.yoffset)};break;case N:o=e.color;break;case B:o=C(e)}return o}function de(e,t){let o=e+"-"+t;return k.get(o)!==void 0?Promise.resolve(k.get(o)):P(e,{responseType:"image"}).then(n=>{let r=n.data,l=r.naturalWidth,c=r.naturalHeight,i=document.createElement("canvas");i.width=l,i.height=c;let s=i.getContext("2d");s.fillStyle=t,s.fillRect(0,0,l,c),s.globalCompositeOperation="destination-in",s.drawImage(r,0,0);let u=i.toDataURL();return k.put(o,u),u})}function v(e){if(!e)return null;let t=null;switch(e.type){case Y:case X:case j:t=v(e.outline);break;case J:{let o=m(e.width);e.style!=null&&e.style!=="none"&&o!==0&&(t={color:e.color,style:$(e.style),width:o,cap:e.cap,join:e.join==="miter"?m(e.miterLimit):e.join});break}default:t=null}return t}var $=(()=>{let e={};return t=>{if(e[t])return e[t];let o=t.replaceAll("-","");return e[t]=o,o}})(),ke=new a([128,128,128]);var q=new a("white");function Ae(e){if(e==null||!("symbolLayers"in e)||e.symbolLayers==null)return!1;switch(e.type){case"point-3d":return e.symbolLayers.some(t=>t.type==="object");case"line-3d":return e.symbolLayers.some(t=>t.type==="path");case"polygon-3d":return e.symbolLayers.some(t=>t.type==="object"||t.type==="extrude");default:return!1}}function Fe(e){return e.resource?.href??""}function Re(e,t){if(!e)return null;let o=null;return p(e)?o=K(e):y(e)&&(o=e.type==="cim"?C(e):e.color?new a(e.color):null),o?h(o,t):null}function K(e){let t=e.symbolLayers;if(!t)return null;let o=null;return t.forEach(n=>{n.type==="object"&&n.resource?.href||(o=n.type==="water"?n.color:n.material?n.material.color:null)}),o?new a(o):null}function h(e,t){if(t==null||e==null)return e;let o=e.toRgba();return o[3]=o[3]*t,new a(o)}function Q(e,t,o){let n=e.symbolLayers;if(!n)return;let r=l=>h(t=t??l??(o!=null?q:null),o);n.forEach(l=>{if(l.type!=="object"||!l.resource?.href||t)if(l.type==="water")l.color=r(l.color);else{let c=l.material!=null?l.material.color:null,i=r(c);l.material==null?l.material=new A({color:i}):l.material.color=i,o!=null&&"outline"in l&&l.outline?.color!=null&&(l.outline.color=h(l.outline.color,o))}})}function Z(e,t,o){(t=t??e.color)&&(e.color=h(t,o)),o!=null&&"outline"in e&&e.outline?.color&&(e.outline.color=h(e.outline.color,o))}function Xe(e,t,o){e&&(t||o!=null)&&(t&&(t=new a(t)),p(e)?Q(e,t,o):y(e)&&Z(e,t,o))}function _(e,t){return f(this,null,function*(){let o=e.symbolLayers;o&&(yield S(o,n=>f(this,null,function*(){return ee(n,t)})))})}function ee(e,t){return f(this,null,function*(){switch(e.type){case"extrude":oe(e,t);break;case"icon":case"line":case"text":te(e,t);break;case"path":ne(e,t);break;case"object":yield re(e,t)}})}function te(e,t){let o=W(t);o!=null&&(e.size=o)}function W(e){for(let t of e)if(typeof t=="number")return t;return null}function oe(e,t){e.size=typeof t[2]=="number"?t[2]:0}function re(e,t){return f(this,null,function*(){let{resourceSize:o,symbolSize:n}=yield le(e),r=V(t,o,n);e.width=b(t[0],n[0],o[0],r),e.depth=b(t[1],n[1],o[1],r),e.height=b(t[2],n[2],o[2],r)})}function ne(e,t){let o=V(t,L,[e.width,void 0,e.height]);e.width=b(t[0],e.width,1,o),e.height=b(t[2],e.height,1,o)}function V(e,t,o){for(let n=0;n<3;n++){let r=e[n];switch(r){case"symbol-value":{let l=o[n];return l!=null?l/t[n]:1}case"proportional":break;default:if(r&&t[n])return r/t[n]}}return 1}function le(e){return f(this,null,function*(){let{computeObjectLayerResourceSize:t}=yield import("./chunk-MJQV3O6C.js"),o=yield t(e,10),{width:n,height:r,depth:l}=e,c=[n,l,r],i=1;for(let s=0;s<3;s++){let u=c[s];if(u!=null){i=u/o[s];break}}for(let s=0;s<3;s++)c[s]==null&&(c[s]=o[s]*i);return{resourceSize:o,symbolSize:c}})}function b(e,t,o,n){switch(e){case"proportional":return o*n;case"symbol-value":return t??o;default:return e}}function se(e,t){let o=W(t);if(o!=null)switch(e.type){case"simple-marker":e.size=o;break;case"picture-marker":{let n=e.width/e.height;n>1?(e.width=o,e.height=o*n):(e.width=o*n,e.height=o);break}case"simple-line":e.width=o;break;case"text":e.font.size=o}}function Ye(e,t){return f(this,null,function*(){if(e&&t)return p(e)?_(e,t):void(y(e)&&se(e,t))})}function je(e,t,o){if(e&&t!=null)if(p(e)){let n=e.symbolLayers;n&&n.forEach(r=>{if(r&&r.type==="object")switch(o){case"tilt":r.tilt=t;break;case"roll":r.roll=t;break;default:r.heading=t}})}else y(e)&&(e.type!=="simple-marker"&&e.type!=="picture-marker"&&e.type!=="text"||(e.angle=t))}function ve(e){if(!e)return null;let t=e.effects.filter(o=>o.type!=="bloom").map(o=>o.toJSON());return x(t)}function We(e,t){return f(this,null,function*(){return(yield e.fetchSymbol(t))||e.fetchCIMSymbol(t)})}export{D as a,Me as b,de as c,v as d,$ as e,ke as f,Ae as g,Fe as h,Re as i,Xe as j,Ye as k,je as l,ve as m,We as n};
