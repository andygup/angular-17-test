import{f as d}from"./chunk-5WNLDCIP.js";import{d as u}from"./chunk-AUIMNX4Y.js";import{a as m,g as p}from"./chunk-NKBP5F7I.js";import{g as y}from"./chunk-ESDYQQXO.js";var S={marker:m.MARKER,fill:m.FILL,line:m.LINE,text:m.TEXT},c=class{constructor(t,a,r,l){let s={minScale:a?.minScale,maxScale:a?.maxScale},o=x(s);this.layers=t,this.data=a,this.hash=this._createHash()+o,this.rendererKey=r;let n={isOutline:!1,placement:null,symbologyType:p.DEFAULT,vvFlags:r};for(let i of t){let h=S[i.type];n.isOutline=i.type==="line"&&i.isOutline,i.materialKey=u(h,n),i.maxVVSize=l,i.scaleInfo=s,i.templateHash+=o}}get type(){return"expanded-cim"}_createHash(){let t="";for(let a of this.layers)t+=a.templateHash;return t}};function x(e){return e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:""}var f=(e,t,a)=>y(void 0,null,function*(){let r=new d(a,t);return new c(yield r.analyzeSymbolReference(e.data,!1),e.data,e.rendererKey,e.maxVVSize)});function w(e,t,a,r){return y(this,null,function*(){if(!e)return null;if(e.type==="cim")return f(e,t,a);if(e.type==="web-style"){let{fetchCIMSymbolReference:l}=yield import("./chunk-ZR3Q4JTW.js"),s={type:"cim",data:(yield l(e,null,r))??void 0,rendererKey:e.rendererKey,maxVVSize:e.maxVVSize};return f(s,t,a)}return e})}function K(e){if(!e)return null;let{avoidSDFRasterization:t,type:a,cim:r,url:l,materialHash:s,maxVVSize:o}=e,n={cim:r,type:a,mosaicHash:s,url:l,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:t};switch(a){case"marker":o&&"size"in r&&(r.size=Math.max(o,r.size)),n.size=e.size,n.path=e.path,n.animatedSymbolProperties=e.animatedSymbolProperties;break;case"line":n.dashTemplate=e.dashTemplate;break;case"text":n.text=e.text,n.fontName=e.fontName}return n}export{w as a,K as b};
