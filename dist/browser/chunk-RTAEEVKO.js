import{a as b}from"./chunk-WBGXWYIY.js";import{a as P}from"./chunk-NG2BILDS.js";import{b as I,c as V}from"./chunk-DLW5X5J6.js";import{a as _}from"./chunk-YJHTADW2.js";import"./chunk-KHV2VDNY.js";import{a as x}from"./chunk-FYB33PIO.js";import{a as H}from"./chunk-2ZJ3WQRV.js";import"./chunk-XUKLUIRQ.js";import{a as w,b as v}from"./chunk-6WWQ4Y2G.js";import"./chunk-FJMWXCU4.js";import"./chunk-6GLCEHEN.js";import"./chunk-22K5GEMV.js";import"./chunk-YFMEPRZQ.js";import"./chunk-HTQH2YLG.js";import"./chunk-IOMUCP7J.js";import"./chunk-UEH4FZMX.js";import"./chunk-5ZJSZISC.js";import"./chunk-X77FZHE2.js";import{a as y}from"./chunk-QRBVWOV6.js";import"./chunk-4Y7EKSO4.js";import"./chunk-XKOINRUM.js";import"./chunk-IFG5AX52.js";import"./chunk-EVB25YXG.js";import"./chunk-Z7J4BCLI.js";import"./chunk-3GBPXGQU.js";import"./chunk-BYXBJQAS.js";import"./chunk-BSIXRBVK.js";import"./chunk-H2E4J3PF.js";import"./chunk-G7TZLWYD.js";import"./chunk-N77PCW3L.js";import"./chunk-IGGE7N7W.js";import"./chunk-WF6JACCV.js";import"./chunk-ICBFZ75C.js";import"./chunk-UYKZ3CEC.js";import"./chunk-Y5K4QJZR.js";import"./chunk-5WNLDCIP.js";import"./chunk-N3KNLXBG.js";import"./chunk-PLCDSZE2.js";import"./chunk-NTXQ55BD.js";import"./chunk-EKY6QR7N.js";import"./chunk-VK2CQJOC.js";import"./chunk-TTUUVT2M.js";import"./chunk-AUIMNX4Y.js";import"./chunk-N57AFEUK.js";import"./chunk-N7PHAMWX.js";import"./chunk-JV7BL2Y3.js";import"./chunk-VGW7YJZ7.js";import"./chunk-HX3FHHCG.js";import"./chunk-ZOOQQO74.js";import"./chunk-SHAZ7EU7.js";import"./chunk-NKBP5F7I.js";import"./chunk-EEYJPINK.js";import"./chunk-BZEC7TCW.js";import"./chunk-MBI4IOAA.js";import"./chunk-GIHBFCPM.js";import"./chunk-W5OI4BJ2.js";import"./chunk-TKTKGUCU.js";import"./chunk-G7LWVLCX.js";import"./chunk-M3GEY4SR.js";import"./chunk-7QY3BMVN.js";import"./chunk-4HXOVZYF.js";import"./chunk-U2QVIRVP.js";import"./chunk-VXOK76QV.js";import"./chunk-FYZRIMPP.js";import"./chunk-IRJFYPO2.js";import"./chunk-2UWML3DK.js";import{c as f}from"./chunk-R72KC7FJ.js";import"./chunk-WKOJXXCZ.js";import"./chunk-MNLP6AEE.js";import"./chunk-RH6QQ4K6.js";import"./chunk-WSUW6W66.js";import"./chunk-RZU6EEB3.js";import"./chunk-XFFNQH2H.js";import"./chunk-VL6L3PH6.js";import"./chunk-LGUXUFJ7.js";import{k as c}from"./chunk-QB3NROF7.js";import"./chunk-B3I4XIHJ.js";import"./chunk-DZ3DW7ED.js";import"./chunk-3XRT3SNQ.js";import"./chunk-5OGCWDP4.js";import"./chunk-JBJTQF7V.js";import"./chunk-CN5O6E6T.js";import"./chunk-4KJ462UD.js";import"./chunk-HSB35X5B.js";import"./chunk-JOOJSGLF.js";import"./chunk-MYELF7MV.js";import"./chunk-MS3ZOARX.js";import"./chunk-KCKP7FIY.js";import"./chunk-7K4WIBFN.js";import"./chunk-Z77VHNI3.js";import"./chunk-LMIKL5PS.js";import"./chunk-OKLB3DLR.js";import"./chunk-DWZPFSNU.js";import"./chunk-MCIUWLYC.js";import"./chunk-EEZEB3RB.js";import"./chunk-45GFWXQC.js";import"./chunk-AUVYUYNK.js";import"./chunk-PUCLHWWW.js";import"./chunk-DMYB246F.js";import"./chunk-YEFC7M4L.js";import"./chunk-C7M5MSEL.js";import"./chunk-HPJ6EQFO.js";import"./chunk-ZOTIMGGE.js";import"./chunk-7UQPY7PH.js";import"./chunk-OHIIU6WS.js";import"./chunk-RCWJNG4Z.js";import"./chunk-HUZLTBDZ.js";import"./chunk-V2JYXY4D.js";import"./chunk-5MJXKSZ4.js";import"./chunk-LGGJOMLJ.js";import"./chunk-VVAIF23J.js";import"./chunk-O5K35OSE.js";import"./chunk-D6LLE2YP.js";import"./chunk-I3S324BU.js";import"./chunk-2UDQ3IWX.js";import"./chunk-MXH75ZNY.js";import"./chunk-PQKTT6AH.js";import"./chunk-OM24DGCK.js";import"./chunk-YQRTHGFD.js";import"./chunk-EDSVJRYE.js";import"./chunk-TQYOVOJO.js";import"./chunk-QAVDKCSH.js";import"./chunk-H2AOS66Z.js";import"./chunk-VGGNZXSE.js";import"./chunk-CJJRHJ2S.js";import"./chunk-574KRDZU.js";import"./chunk-2APWMENK.js";import"./chunk-ZWFVPWKA.js";import"./chunk-JOYABHZZ.js";import"./chunk-IEXZWAIE.js";import"./chunk-VDN3XKL2.js";import"./chunk-SVEGZVCP.js";import"./chunk-AQ74ANSJ.js";import"./chunk-SAOUSUZE.js";import"./chunk-6MGDEI2H.js";import"./chunk-QSGARGRB.js";import"./chunk-SREKDU6P.js";import"./chunk-IXIJFOEL.js";import"./chunk-QZ4L25WE.js";import"./chunk-4ATIL3QV.js";import"./chunk-WUM4JBII.js";import"./chunk-URUYU25U.js";import"./chunk-3S2DT2SI.js";import"./chunk-7PPV2CP7.js";import"./chunk-U62SHMHB.js";import"./chunk-55ESOXMJ.js";import"./chunk-BCREO4Q5.js";import"./chunk-EJ3VIBAJ.js";import"./chunk-4LHUJTP5.js";import"./chunk-NBRBW7H5.js";import{a as u}from"./chunk-CBOFHDSC.js";import"./chunk-HB7BVTLV.js";import"./chunk-WZKL6OPG.js";import"./chunk-WF37UVOV.js";import"./chunk-UZQ577CU.js";import"./chunk-FC3MPJI4.js";import"./chunk-5ETRXDS4.js";import"./chunk-QDNKD3H5.js";import"./chunk-B4PK7RBX.js";import"./chunk-6J4Y65BV.js";import"./chunk-RXHILZH7.js";import"./chunk-URPCXPAW.js";import"./chunk-KBFIYTBH.js";import"./chunk-PEPXQ7N3.js";import"./chunk-VU5W7W6Y.js";import"./chunk-6QIKBCPR.js";import"./chunk-AHKJJNRE.js";import"./chunk-HBTOKQC5.js";import"./chunk-A52LT7YB.js";import"./chunk-CZPMRK53.js";import"./chunk-IDSF2RZ6.js";import"./chunk-2BBIRZVO.js";import"./chunk-WQAXQD4X.js";import"./chunk-IUPUERVS.js";import"./chunk-XF4NUYV7.js";import"./chunk-FNDPIYNC.js";import{H as r}from"./chunk-WMYPRHRR.js";import{R as p}from"./chunk-IAMDMFZ7.js";import{a as i}from"./chunk-53MWZ23O.js";import{p as d}from"./chunk-PT7S6WNL.js";import"./chunk-XDTDVCGP.js";import"./chunk-JPDAKIWT.js";import{p as g}from"./chunk-465DRXTW.js";import"./chunk-AC62Z3FX.js";import{a as n,g as l}from"./chunk-ESDYQQXO.js";var E=t=>{let e=class extends t{initialize(){this.exportImageParameters=new y({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return i([r()],e.prototype,"exportImageParameters",void 0),i([r({readOnly:!0})],e.prototype,"floors",null),i([r({readOnly:!0})],e.prototype,"exportImageVersion",null),i([r()],e.prototype,"layer",void 0),i([r()],e.prototype,"suspended",void 0),i([r(c)],e.prototype,"timeExtent",void 0),e=i([p("esri.views.layers.MapImageLayerView")],e),e};var o=class extends E(H(w(v))){constructor(){super(...arguments),this._highlightGraphics=new f,this._updateHash=""}fetchPopupFeatures(t,e){return this._popupHighlightHelper.fetchPopupFeatures(t,e)}update(t){let e=`${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;this._updateHash!==e&&(this._updateHash=e,this.strategy.update(t).catch(a=>{d(a)||g.getLogger(this).error(a)}),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){let{imageMaxWidth:t,imageMaxHeight:e,version:a}=this.layer,s=a>=10.3,C=a>=10;this._bitmapContainer=new P,this.container.addChild(this._bitmapContainer),this._highlightView=new x({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new _(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new I({createFetchPopupFeaturesQueryGeometry:(h,m)=>V(h,m,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(h,m)=>{this._highlightView.graphicUpdateHandler({graphic:h,property:m})},layerView:this,updatingHandles:this._updatingHandles}),this.strategy=new b({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:s,imageNormalizationSupported:C,hidpi:!0}),this.addAttachHandles(u(()=>this.exportImageVersion,()=>this.requestUpdate())),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}doRefresh(){return l(this,null,function*(){this._updateHash="",this.requestUpdate()})}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,a,s){return this.layer.fetchImage(t,e,a,n({timeExtent:this.timeExtent,floors:this.floors},s))}fetchImageBitmap(t,e,a,s){return this.layer.fetchImageBitmap(t,e,a,n({timeExtent:this.timeExtent,floors:this.floors},s))}highlight(t){return this._popupHighlightHelper.highlight(t)}};i([r()],o.prototype,"strategy",void 0),i([r()],o.prototype,"updating",void 0),o=i([p("esri.views.2d.layers.MapImageLayerView2D")],o);var st=o;export{st as default};
