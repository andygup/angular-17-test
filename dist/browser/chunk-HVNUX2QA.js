import{a as x,b as R}from"./chunk-TN7F2BKT.js";import{a as ar,d as Sr,f as Vr}from"./chunk-XF2DBGTH.js";import{a as V,b as Gr,c as Br}from"./chunk-J43N2ESR.js";import{a as E}from"./chunk-Y4SWPZQY.js";import{a as W}from"./chunk-DUAAYE7V.js";import{a as Er}from"./chunk-BFFOE56J.js";import{c as b,e as T,i as ir}from"./chunk-QJR6XTTM.js";import{a as d,d as _}from"./chunk-6B6VO6EC.js";import{c as h,k as P}from"./chunk-PV5D5XIZ.js";import{a as tr,d as er,m as w,n as nr}from"./chunk-7UQPY7PH.js";import{a as _r}from"./chunk-D6LLE2YP.js";import{d as z,e as vr,g as wr,l as Rr,m as br,n as jr}from"./chunk-IXIJFOEL.js";import{a as Nr}from"./chunk-WUM4JBII.js";import{o as Or}from"./chunk-URUYU25U.js";import{i as v}from"./chunk-7PPV2CP7.js";import{g as Cr,h as Mr}from"./chunk-EJ3VIBAJ.js";import{A as X,E as rr,F as or,H as xr,a as O,b as S,c as U,d as Pr,f as Q,h as Ar,i as Fr,j as dr,l as Tr}from"./chunk-4LHUJTP5.js";import{b as hr}from"./chunk-AHKJJNRE.js";import{M as gr,S as yr,t as cr,w as mr,x as ur}from"./chunk-CZPMRK53.js";import{h as I}from"./chunk-FNDPIYNC.js";import{H as F}from"./chunk-WMYPRHRR.js";import{R as L}from"./chunk-IAMDMFZ7.js";import{a as c}from"./chunk-53MWZ23O.js";import{p as B}from"./chunk-465DRXTW.js";var q=class extends _r(I){constructor(){super({}),this.type="georeferenced",this.isRelative=!1,this.isGeoreferenced=!0}};c([Nr({georeferenced:"georeferenced"},{readOnly:!0})],q.prototype,"type",void 0),q=c([L("esri.geometry.support.MeshGeoreferencedVertexSpace")],q);var Lr=q;function C(r=sr){return[r[0],r[1],r[2],r[3]]}function G(r,o,t=C()){return Tr(t,r),t[3]=o,t}function Ir(r,o,t=C()){return V(k,r,J(r)),V(Ur,o,J(o)),Br(k,Ur,k),po(t,Mr(Gr(t,k)))}function qo(r,o,t,e=C()){return G(Ar,r,D),G(Fr,o,zr),G(dr,t,Wr),Ir(D,zr,D),Ir(D,Wr,e),e}function qr(r){return r[3]}function J(r){return Cr(r[3])}function po(r,o){return r[3]=o,r}var sr=[0,0,1,0],k=E(),Ur=E(),ko=C(),D=C(),zr=C(),Wr=C();var lr,g=lr=class extends I{constructor(r){super(r),this.translation=O(),this.rotationAxis=Pr(sr),this.rotationAngle=0,this.scale=U(1,1,1)}get rotation(){return G(this.rotationAxis,this.rotationAngle)}set rotation(r){this.rotationAxis=S(r),this.rotationAngle=qr(r)}get localMatrix(){let r=d();return V(kr,this.rotation,J(this.rotation)),Rr(r,kr,this.translation,this.scale),r}get localMatrixInverse(){return z(d(),this.localMatrix)}applyLocal(r,o){return rr(o,r,this.localMatrix)}applyLocalInverse(r,o){return rr(o,r,this.localMatrixInverse)}equals(r){return this===r||r!=null&&br(this.localMatrix,r.localMatrix)}clone(){let r={translation:S(this.translation),rotationAxis:S(this.rotationAxis),rotationAngle:this.rotationAngle,scale:S(this.scale)};return new lr(r)}};c([F({type:[Number],nonNullable:!0,json:{write:!0}})],g.prototype,"translation",void 0),c([F({type:[Number],nonNullable:!0,json:{write:!0}})],g.prototype,"rotationAxis",void 0),c([F({type:Number,nonNullable:!0,json:{write:!0}})],g.prototype,"rotationAngle",void 0),c([F({type:[Number],nonNullable:!0,json:{write:!0}})],g.prototype,"scale",void 0),c([F()],g.prototype,"rotation",null),c([F()],g.prototype,"localMatrix",null),c([F()],g.prototype,"localMatrixInverse",null),g=lr=c([L("esri.geometry.support.MeshTransform")],g);var kr=E(),Dr=g;function pr(r,o){return r.isGeographic||r.isWebMercator&&(o?.geographic??!0)}function ft(r,o,t){let e=!r.isGeoreferenced;t?.geographic!=null&&t.geographic!==e&&B.getLogger(o).warnOnce(`Specifying the 'geographic' parameter (${t.geographic}) for a Mesh vertex space of type "${r.type}" is not supported. This parameter will be ignored.`)}var Z=B.getLogger("esri.geometry.support.meshUtils.normalProjection");function Jr(r,o,t,e,n){return K(e)?(H(A.TO_PCPF,h.fromTypedArray(r),P.fromTypedArray(o),P.fromTypedArray(t),e,h.fromTypedArray(n)),n):(Z.error("Cannot convert spatial reference to PCPF"),n)}function Yr(r,o,t,e,n){return K(e)?(H(A.FROM_PCPF,h.fromTypedArray(r),P.fromTypedArray(o),P.fromTypedArray(t),e,h.fromTypedArray(n)),n):(Z.error("Cannot convert to spatial reference from PCPF"),n)}function $r(r,o,t){return v(r,o,0,t,x(o),0,r.length/3),t}function Zr(r,o,t){return v(r,x(t),0,o,t,0,r.length/3),o}function Hr(r,o,t){return w(f,t),T(o,r,f),nr(f)||ir(o,o),o}function Kr(r,o,t){if(w(f,t),T(o,r,f,4),nr(f)||ir(o,o,4),r!==o)for(let e=3;e<r.length;e+=4)o[e]=r[e];return o}function Qr(r,o,t,e,n){if(!K(e))return Z.error("Cannot convert spatial reference to PCPF"),n;H(A.TO_PCPF,h.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),P.fromTypedArray(o),P.fromTypedArray(t),e,h.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT));for(let a=3;a<r.length;a+=4)n[a]=r[a];return n}function Xr(r,o,t,e,n){if(!K(e))return Z.error("Cannot convert to spatial reference from PCPF"),n;H(A.FROM_PCPF,h.fromTypedArray(r,16),P.fromTypedArray(o),P.fromTypedArray(t),e,h.fromTypedArray(n,16));for(let a=3;a<r.length;a+=4)n[a]=r[a];return n}function H(r,o,t,e,n,a){if(!o)return;let s=t.count,p=x(n);if(ro(n))for(let l=0;l<s;l++)e.getVec(l,Y),o.getVec(l,y),R(p,Y,$,p),tr(f,$),r===A.FROM_PCPF&&er(f,f),or(y,y,f),a.setVec(l,y);else for(let l=0;l<s;l++){e.getVec(l,Y),o.getVec(l,y),R(p,Y,$,p),tr(f,$);let i=hr(t.get(l,1)),m=Math.cos(i);r===A.TO_PCPF&&(m=1/m),f[0]*=m,f[1]*=m,f[2]*=m,f[3]*=m,f[4]*=m,f[5]*=m,r===A.FROM_PCPF&&er(f,f),or(y,y,f),X(y,y),a.setVec(l,y)}return a}function K(r){return ro(r)||fo(r)}function ro(r){return r.isWGS84||cr(r)||mr(r)||ur(r)}function fo(r){return r.isWebMercator}var A;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(A||(A={}));var Y=O(),y=O(),$=d(),f=W();function to(r,o,t){return pr(o.spatialReference,t)?go(r,o,t):uo(r,o,t)}function co(r,o=_){let{position:t,normal:e,tangent:n}=r;return{position:b(new Float64Array(t.length),t,o),normal:e!=null?Hr(e,new Float32Array(e.length),o):null,tangent:n!=null?Kr(n,new Float32Array(n.length),o):null}}function mo(r,o,t,e){let{position:n,normal:a,tangent:s}=r;return o.isRelative?to(co(r,t?.localMatrix),o.getOriginPoint(e),{geographic:!o.isGeoreferenced}):{position:n,normal:a,tangent:s}}function Dt(r,o,t){if(t?.useTransform){let{position:e,normal:n,tangent:a}=r,{x:s,y:p,z:l}=o,i=U(s,p,l??0);return{vertexAttributes:{position:e,normal:n,tangent:a},vertexSpace:t.geographic??1?new Vr({origin:i}):new Er({origin:i}),transform:new Dr}}return{vertexAttributes:to(r,o,t),vertexSpace:new Lr,transform:null}}function oo(r,o,t){return pr(o.spatialReference,t)?Ao(r,o,t):eo(r,o,t)}function Jt(r,o,t,e,n){if(!o.isRelative)return oo(r,e,n);let{spatialReference:a}=e,s=mo(r,o,t,a);return e.equals(o.getOriginPoint(a))?eo(s,e,n):oo(s,e,n)}function Yt({positions:r,transform:o,vertexSpace:t,inSpatialReference:e,outSpatialReference:n,outPositions:a,localMode:s}){let p=t.isRelative?t.origin:Q,l=t.isRelative?o?.localMatrix??_:_;if(t.isGeoreferenced){let u=a??ar(r.length);if(jr(l,_)?Sr(u,r):b(u,r,l),!xr(p,Q)){let[io,so,lo]=p;for(let N=0;N<u.length;N+=3)u[N]+=io,u[N+1]+=so,u[N+2]+=lo}return v(u,e,0,u,n,0,u.length/3),u}let i=e,m=x(e);i=n.isWebMercator&&s||!Or(e,m)?i:m,R(e,p,M,i),vr(M,M,l);let j=a??ar(r.length);return b(j,r,M),v(j,i,0,j,n,0,j.length/3),j}function uo(r,o,t){let e=new Float64Array(r.position.length),n=r.position,a=o.x,s=o.y,p=o.z??0,l=fr(t?t.unit:null,o.spatialReference);for(let i=0;i<n.length;i+=3)e[i]=n[i]*l+a,e[i+1]=n[i+1]*l+s,e[i+2]=n[i+2]*l+p;return{position:e,normal:r.normal,tangent:r.tangent}}function go(r,o,t){let e=o.spatialReference,n=no(o,t,M),a=new Float64Array(r.position.length),s=yo(r.position,n,e,a),p=w(ao,n);return{position:s,normal:ho(s,a,r.normal,p,e),tangent:Po(s,a,r.tangent,p,e)}}function yo(r,o,t,e){b(e,r,o);let n=new Float64Array(r.length);return Zr(e,n,t)}function ho(r,o,t,e,n){if(t==null)return null;let a=new Float32Array(t.length);return T(a,t,e),Yr(a,r,o,n,a),a}function Po(r,o,t,e,n){if(t==null)return null;let a=new Float32Array(t.length);T(a,t,e,4);for(let s=3;s<a.length;s+=4)a[s]=t[s];return Xr(a,r,o,n,a),a}function eo(r,o,t){let e=new Float64Array(r.position.length),n=r.position,a=o.x,s=o.y,p=o.z??0,l=fr(t?t.unit:null,o.spatialReference);for(let i=0;i<n.length;i+=3)e[i]=(n[i]-a)/l,e[i+1]=(n[i+1]-s)/l,e[i+2]=(n[i+2]-p)/l;return{position:e,normal:r.normal,tangent:r.tangent}}function Ao(r,o,t){let e=o.spatialReference;no(o,t,M);let n=z(Co,M),a=new Float64Array(r.position.length),s=Fo(r.position,e,n,a),p=w(ao,n);return{position:s,normal:To(r.normal,r.position,a,e,p),tangent:xo(r.tangent,r.position,a,e,p)}}function no(r,o,t){R(r.spatialReference,[r.x,r.y,r.z??0],t,x(r.spatialReference));let e=fr(o?o.unit:null,r.spatialReference);return wr(t,t,[e,e,e]),t}function Fo(r,o,t,e){let n=$r(r,o,e),a=new Float64Array(n.length);return b(a,n,t),a}function To(r,o,t,e,n){if(r==null)return null;let a=Jr(r,o,t,e,new Float32Array(r.length));return T(a,a,n),a}function xo(r,o,t,e,n){if(r==null)return null;let a=Qr(r,o,t,e,new Float32Array(r.length));return T(a,a,n,4),a}function fr(r,o){if(r==null)return 1;let t=yr(o);return 1/gr(t,"meters",r)}var M=d(),Co=d(),ao=W();export{Lr as a,C as b,Ir as c,qo as d,J as e,Dr as f,pr as g,ft as h,Jr as i,Yr as j,$r as k,Zr as l,Qr as m,Xr as n,to as o,co as p,mo as q,Dt as r,oo as s,Jt as t,Yt as u};
