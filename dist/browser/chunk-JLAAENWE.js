import{a as g}from"./chunk-7GCVQ2EY.js";import"./chunk-HBDWL3B4.js";import"./chunk-2ZJ3WQRV.js";import"./chunk-XUKLUIRQ.js";import"./chunk-6WWQ4Y2G.js";import"./chunk-6CRNHERM.js";import"./chunk-FJMWXCU4.js";import"./chunk-6GLCEHEN.js";import{a as v}from"./chunk-22K5GEMV.js";import"./chunk-YFMEPRZQ.js";import"./chunk-HTQH2YLG.js";import"./chunk-IOMUCP7J.js";import"./chunk-UEH4FZMX.js";import"./chunk-5ZJSZISC.js";import"./chunk-4Y7EKSO4.js";import"./chunk-XKOINRUM.js";import"./chunk-EVB25YXG.js";import"./chunk-Z7J4BCLI.js";import"./chunk-3GBPXGQU.js";import"./chunk-BYXBJQAS.js";import"./chunk-BSIXRBVK.js";import"./chunk-G7TZLWYD.js";import"./chunk-G3LBVS5W.js";import"./chunk-WF6JACCV.js";import"./chunk-UYKZ3CEC.js";import"./chunk-Y5K4QJZR.js";import"./chunk-5WNLDCIP.js";import"./chunk-N3KNLXBG.js";import"./chunk-NTXQ55BD.js";import"./chunk-EKY6QR7N.js";import"./chunk-VK2CQJOC.js";import"./chunk-AUIMNX4Y.js";import"./chunk-N57AFEUK.js";import"./chunk-N7PHAMWX.js";import"./chunk-JV7BL2Y3.js";import"./chunk-VGW7YJZ7.js";import"./chunk-HX3FHHCG.js";import"./chunk-ZOOQQO74.js";import"./chunk-SHAZ7EU7.js";import"./chunk-NKBP5F7I.js";import"./chunk-EEYJPINK.js";import"./chunk-BZEC7TCW.js";import"./chunk-MBI4IOAA.js";import"./chunk-GIHBFCPM.js";import"./chunk-W5OI4BJ2.js";import"./chunk-TKTKGUCU.js";import"./chunk-M3GEY4SR.js";import"./chunk-7QY3BMVN.js";import"./chunk-4HXOVZYF.js";import"./chunk-U2QVIRVP.js";import"./chunk-VXOK76QV.js";import"./chunk-IRJFYPO2.js";import"./chunk-2UWML3DK.js";import"./chunk-WKOJXXCZ.js";import"./chunk-MNLP6AEE.js";import{a as S}from"./chunk-YH5YGPKQ.js";import"./chunk-WSUW6W66.js";import"./chunk-RZU6EEB3.js";import"./chunk-WHNNLNN4.js";import"./chunk-XFFNQH2H.js";import"./chunk-VL6L3PH6.js";import"./chunk-UW2TVJUN.js";import"./chunk-LGUXUFJ7.js";import"./chunk-QB3NROF7.js";import"./chunk-DR5NPQZL.js";import"./chunk-B3I4XIHJ.js";import"./chunk-DZ3DW7ED.js";import"./chunk-3XRT3SNQ.js";import{a as _}from"./chunk-YEFTRNE3.js";import"./chunk-5OGCWDP4.js";import"./chunk-JBJTQF7V.js";import"./chunk-CN5O6E6T.js";import"./chunk-4KJ462UD.js";import"./chunk-HSB35X5B.js";import"./chunk-JOOJSGLF.js";import"./chunk-MYELF7MV.js";import"./chunk-MS3ZOARX.js";import"./chunk-KCKP7FIY.js";import"./chunk-7K4WIBFN.js";import"./chunk-DWZPFSNU.js";import"./chunk-MCIUWLYC.js";import"./chunk-EEZEB3RB.js";import"./chunk-45GFWXQC.js";import"./chunk-AUVYUYNK.js";import"./chunk-PUCLHWWW.js";import"./chunk-DMYB246F.js";import"./chunk-YEFC7M4L.js";import"./chunk-C7M5MSEL.js";import"./chunk-HPJ6EQFO.js";import"./chunk-ZOTIMGGE.js";import"./chunk-7UQPY7PH.js";import"./chunk-OHIIU6WS.js";import"./chunk-RCWJNG4Z.js";import"./chunk-5MJXKSZ4.js";import"./chunk-TJ3KO5EG.js";import"./chunk-LGGJOMLJ.js";import"./chunk-VVAIF23J.js";import"./chunk-6N5DPLFH.js";import"./chunk-O5K35OSE.js";import"./chunk-D6LLE2YP.js";import"./chunk-I3S324BU.js";import"./chunk-O5IGEGOS.js";import"./chunk-2UDQ3IWX.js";import"./chunk-TQYOVOJO.js";import"./chunk-YH4Z47PR.js";import"./chunk-CJJRHJ2S.js";import"./chunk-574KRDZU.js";import"./chunk-2APWMENK.js";import"./chunk-ZWFVPWKA.js";import"./chunk-JOYABHZZ.js";import"./chunk-IEXZWAIE.js";import"./chunk-VDN3XKL2.js";import"./chunk-SVEGZVCP.js";import"./chunk-AQ74ANSJ.js";import"./chunk-SAOUSUZE.js";import"./chunk-6MGDEI2H.js";import"./chunk-QSGARGRB.js";import"./chunk-SREKDU6P.js";import"./chunk-IXIJFOEL.js";import"./chunk-QZ4L25WE.js";import"./chunk-4ATIL3QV.js";import"./chunk-WUM4JBII.js";import"./chunk-U62SHMHB.js";import"./chunk-55ESOXMJ.js";import"./chunk-BCREO4Q5.js";import"./chunk-EJ3VIBAJ.js";import"./chunk-4LHUJTP5.js";import"./chunk-NBRBW7H5.js";import{a as l}from"./chunk-CBOFHDSC.js";import"./chunk-HB7BVTLV.js";import"./chunk-WZKL6OPG.js";import"./chunk-WF37UVOV.js";import"./chunk-UZQ577CU.js";import"./chunk-FC3MPJI4.js";import"./chunk-5ETRXDS4.js";import"./chunk-QDNKD3H5.js";import"./chunk-B4PK7RBX.js";import"./chunk-6J4Y65BV.js";import"./chunk-RXHILZH7.js";import"./chunk-PEPXQ7N3.js";import"./chunk-VU5W7W6Y.js";import"./chunk-6QIKBCPR.js";import"./chunk-AHKJJNRE.js";import"./chunk-HBTOKQC5.js";import"./chunk-A52LT7YB.js";import"./chunk-CZPMRK53.js";import"./chunk-IDSF2RZ6.js";import"./chunk-2BBIRZVO.js";import"./chunk-WQAXQD4X.js";import"./chunk-IUPUERVS.js";import"./chunk-XF4NUYV7.js";import"./chunk-FNDPIYNC.js";import{H as i}from"./chunk-WMYPRHRR.js";import{R as p}from"./chunk-IAMDMFZ7.js";import{a as s}from"./chunk-53MWZ23O.js";import{a as h,b as f}from"./chunk-PT7S6WNL.js";import"./chunk-XDTDVCGP.js";import"./chunk-JPDAKIWT.js";import{r as d}from"./chunk-465DRXTW.js";import"./chunk-AC62Z3FX.js";import{a as m,b as c,g as y}from"./chunk-ESDYQQXO.js";var O=e=>{let t=class extends e{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}constructor(...r){super(...r),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return this._isUserPaused?"paused":this._streamConnectionStatus}_onSuspendedChange(r){r?this._doPause():this._isUserPaused||this._doResume()}};return s([i()],t.prototype,"_isUserPaused",void 0),s([i({readOnly:!0})],t.prototype,"connectionStatus",null),s([i({type:S})],t.prototype,"filter",void 0),t=s([p("esri.layers.mixins.StreamLayerView")],t),t};function x(e,t){if(e==null&&t==null)return null;let r={};return t!=null&&(r.geometry=t.toJSON()),e!=null&&(r.where=e),r}var o=class extends O(g){constructor(){super(...arguments),this.pipelineConnectionStatus="disconnected",this.pipelineErrorString=null,this._enabledEventTypes=new Set}initialize(){this.addHandles([l(()=>this.layer.customParameters,e=>this._proxy.updateCustomParameters(e)),this.layer.on("send-message-to-socket",e=>this._proxy.sendMessageToSocket(e)),this.layer.on("send-message-to-client",e=>this._proxy.sendMessageToClient(e)),l(()=>this.layer.purgeOptions,()=>this._update()),l(()=>this.suspended,this._onSuspendedChange.bind(this))],"constructor")}get connectionError(){return this.pipelineErrorString?new d("stream-controller",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return f(e.map(u=>this.on(u,t)));let r=["data-received","message-received"].includes(e);r&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));let a=super.on(e,t),n=this;return h(()=>{a.remove(),r&&(n._proxy.closed||n.hasEventListener(e)||n._proxy.enableEvent(e,!1))})}queryLatestObservations(e,t){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new d("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then(r=>{let a=_.fromJSON(r);return a.features.forEach(n=>{n.layer=this.layer,n.sourceLayer=this.layer}),a})}detach(){super.detach(),this.pipelineConnectionStatus="disconnected"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._proxy?.pauseStream()}_doResume(){this._proxy?.resumeStream()}_createClientOptions(){return c(m({},super._createClientOptions()),{setProperty:e=>{this.set(e.propertyName,e.value)}})}_createTileRendererHash(e){let t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(x(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}_createServiceOptions(){return y(this,null,function*(){let e=this.layer,{objectIdField:t}=e,r=e.fields.map(E=>E.toJSON()),a=v(e.geometryType),n=e.timeInfo?.toJSON()||null,u=e.spatialReference?e.spatialReference.toJSON():null;return{type:"stream",isPaused:this._isUserPaused,fields:r,fieldsIndex:this.layer.fieldsIndex.toJSON(),geometryType:a,objectIdField:t,timeInfo:n,source:this.layer.parsedUrl,serviceFilter:x(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:u,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}})}};s([i()],o.prototype,"pipelineConnectionStatus",void 0),s([i()],o.prototype,"pipelineErrorString",void 0),s([i({readOnly:!0})],o.prototype,"connectionError",null),s([i({readOnly:!0})],o.prototype,"_streamConnectionStatus",null),o=s([p("esri.views.2d.layers.StreamLayerView2D")],o);var z=o;export{z as default};
