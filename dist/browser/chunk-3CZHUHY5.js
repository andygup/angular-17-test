import{a as R,b as M}from"./chunk-G7LWVLCX.js";import{c as x,e as V,f as B,h as Z,i as v,u as P,v as D,y as K}from"./chunk-M3GEY4SR.js";import{a as y}from"./chunk-U2QVIRVP.js";import{a as L}from"./chunk-MXH75ZNY.js";import{a as f,d as W,e as g,f as k,g as Q}from"./chunk-4ATIL3QV.js";import{o as Y}from"./chunk-URUYU25U.js";import{q as J}from"./chunk-U62SHMHB.js";import{a as A,b as j,e as z,i as _}from"./chunk-6QIKBCPR.js";import{A as w,T as U,n as b,q as O,u as q,z as I}from"./chunk-CZPMRK53.js";import{a as T}from"./chunk-WQAXQD4X.js";import{r as h}from"./chunk-465DRXTW.js";import{g as m}from"./chunk-ESDYQQXO.js";var at=new T({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),$=Object.freeze({});function Tt(t,e,r){return m(this,null,function*(){let{outFields:i,orderByFields:o,groupByFieldsForStatistics:n,outStatistics:s}=t;if(i)for(let a=0;a<i.length;a++)i[a]=i[a].trim();if(o)for(let a=0;a<o.length;a++)o[a]=o[a].trim();if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(s)for(let a=0;a<s.length;a++)s[a].onStatisticField&&(s[a].onStatisticField=s[a].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),lt(t,e,r)})}function lt(t,e,r){return m(this,null,function*(){if(!t)return null;let{where:i}=t;if(t.where=i=i?.trim(),(!i||/^1 *= *1$/.test(i)||e&&e===i)&&(t.where=null),!t.geometry)return t;let o=yield ct(t);if(t.distance=0,t.units=null,t.spatialRel==="esriSpatialRelEnvelopeIntersects"){let{spatialReference:n}=t.geometry;o=J(o),o.spatialReference=n}if(o){yield R(o.spatialReference,r),o=ut(o,r);let n=(yield L(k(o)))[0];if(n==null)throw $;let s="quantizationParameters"in t&&t.quantizationParameters?.tolerance||"maxAllowableOffset"in t&&t.maxAllowableOffset||0,a=s&&H(o,r)?{densificationStep:8*s}:void 0,u=n.toJSON(),l=M(u,u.spatialReference,r,a);if(!l)throw $;l.spatialReference=r,t.geometry=l}return t})}function H(t,e){if(!t)return!1;let r=t.spatialReference;return(f(t)||g(t)||W(t))&&!b(r,e)&&!Y(r,e)}function ut(t,e){let r=t.spatialReference;return H(t,e)&&f(t)?{spatialReference:r,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:t}function ct(t){return m(this,null,function*(){let{distance:e,units:r}=t,i=t.geometry;if(e==null||"vertexAttributes"in i)return i;let o=i.spatialReference,n=r?at.fromJSON(r):U(o),s=o&&(O(o)||q(o))?i:yield R(o,w).then(()=>M(i,w));return(yield mt())(s.spatialReference,s,e,n)})}function mt(){return m(this,null,function*(){return(yield import("./chunk-ZFAVWZZS.js")).geodesicBuffer})}function X(t){return t==="mesh"?z:_(t)}function tt(t,e){return t?e?4:3:e?3:2}function et(t,e,r,i){return nt(t,e,r,i.coords[0],i.coords[1])}function rt(t,e,r,i,o,n){let s=tt(o,n),{coords:a,lengths:u}=i;if(!u)return!1;for(let l=0,c=0;l<u.length;l++,c+=s)if(!nt(t,e,r,a[c],a[c+1]))return!1;return!0}function nt(t,e,r,i,o){if(!t)return!1;let n=tt(e,r),{coords:s,lengths:a}=t,u=!1,l=0;for(let c of a)u=pt(u,s,n,l,c,i,o),l+=c*n;return u}function pt(t,e,r,i,o,n,s){let a=t,u=i;for(let l=i,c=i+o*r;l<c;l+=r){u=l+r,u===c&&(u=i);let p=e[l],d=e[l+1],st=e[u],G=e[u+1];(d<s&&G>=s||G<s&&d>=s)&&p+(s-d)/(G-d)*(st-p)<n&&(a=!a)}return a}var it=new y,ft=new y,N=new y,E={esriGeometryPoint:x,esriGeometryPolyline:B,esriGeometryPolygon:Z,esriGeometryMultipoint:V};function Dt(t,e,r,i=t.hasZ,o=t.hasM){if(e==null)return null;let n=t.hasZ&&i,s=t.hasM&&o;if(r){let a=P(N,e,t.hasZ,t.hasM,"esriGeometryPoint",r,i,o);return x(a,n,s)}return x(e,n,s)}function S(t,e,r,i,o,n,s=e,a=r){let u=e&&s,l=r&&a,c=i!=null?"coords"in i?i:i.geometry:null;if(c==null)return null;if(o){let p=D(ft,c,e,r,t,o,s,a);return n&&(p=P(N,p,u,l,t,n)),E[t]?.(p,u,l)??null}if(n){let p=P(N,c,e,r,t,n,s,a);return E[t]?.(p,u,l)??null}return K(it,c,e,r,s,a),E[t]?.(it,u,l)??null}function Kt(t){return t&&ot in t?JSON.parse(JSON.stringify(t,yt)):t}var ot="_geVersion",yt=(t,e)=>t!==ot?e:void 0;var C="unsupported-query",gt={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},F={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function Rt(t){return t!=null&&F.spatialRelationship[t]===!0}function St(t){return t!=null&&F.queryGeometry[Q(t)]===!0}function dt(t){return t!=null&&F.layerGeometry[t]===!0}function ht(){return import("./chunk-ZFAVWZZS.js")}function se(t,e,r,i,o){if(g(e)&&r==="esriGeometryPoint"&&(t==="esriSpatialRelIntersects"||t==="esriSpatialRelContains")){let n=v(new y,e,!1,!1);return Promise.resolve(s=>et(n,!1,!1,s))}if(g(e)&&r==="esriGeometryMultipoint"){let n=v(new y,e,!1,!1);if(t==="esriSpatialRelContains")return Promise.resolve(s=>rt(n,!1,!1,s,i,o))}if(f(e)&&r==="esriGeometryPoint"&&(t==="esriSpatialRelIntersects"||t==="esriSpatialRelContains"))return Promise.resolve(n=>A(e,S(r,i,o,n)));if(f(e)&&r==="esriGeometryMultipoint"&&t==="esriSpatialRelContains")return Promise.resolve(n=>j(e,S(r,i,o,n)));if(f(e)&&t==="esriSpatialRelIntersects"){let n=X(r);return Promise.resolve(s=>n(e,S(r,i,o,s)))}return ht().then(n=>{let s=n[gt[t]].bind(null,e.spatialReference,e);return a=>s(S(r,i,o,a))})}function ae(t,e,r){return m(this,null,function*(){let{spatialRel:i,geometry:o}=t;if(o){if(!Rt(i))throw new h(C,"Unsupported query spatial relationship",{query:t});if(I(o.spatialReference)&&I(r)){if(!St(o))throw new h(C,"Unsupported query geometry type",{query:t});if(!dt(e))throw new h(C,"Unsupported layer geometry type",{query:t});if(t.outSR)return R(t.geometry?.spatialReference,t.outSR)}}})}function le(t){if(f(t))return!0;if(g(t)){for(let e of t.rings)if(e.length!==5||e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1;return!0}return!1}function me(t,e){return m(this,null,function*(){if(!t)return null;let r=e.featureAdapter,{startTimeField:i,endTimeField:o}=t,n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(i&&o)yield e.forEach(a=>{let u=r.getAttribute(a,i),l=r.getAttribute(a,o);u==null||isNaN(u)||(n=Math.min(n,u)),l==null||isNaN(l)||(s=Math.max(s,l))});else{let a=i||o;yield e.forEach(u=>{let l=r.getAttribute(u,a);l==null||isNaN(l)||(n=Math.min(n,l),s=Math.max(s,l))})}return{start:n,end:s}})}function pe(t,e,r){if(!e||!t)return null;let{startTimeField:i,endTimeField:o}=t;if(!i&&!o)return null;let{start:n,end:s}=e;if(n===null&&s===null)return null;if(n===void 0&&s===void 0)return Gt();let a=r.getAttributeAsTimestamp?.bind(r)??r.getAttribute.bind(r);return i&&o?xt(a,i,o,n,s):Pt(a,i||o,n,s)}function xt(t,e,r,i,o){return i!=null&&o!=null?n=>{let s=t(n,e),a=t(n,r);return(s==null||s<=o)&&(a==null||a>=i)}:i!=null?n=>{let s=t(n,r);return s==null||s>=i}:o!=null?n=>{let s=t(n,e);return s==null||s<=o}:void 0}function Pt(t,e,r,i){return r!=null&&i!=null&&r===i?o=>t(o,e)===r:r!=null&&i!=null?o=>{let n=t(o,e);return n!=null&&n>=r&&n<=i}:r!=null?o=>{let n=t(o,e);return n!=null&&n>=r}:i!=null?o=>{let n=t(o,e);return n!=null&&n<=i}:void 0}function Gt(){return()=>!1}export{Dt as a,S as b,Kt as c,$ as d,Tt as e,lt as f,se as g,ae as h,le as i,me as j,pe as k};
