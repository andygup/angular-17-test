import{K as j,h as P,i as O,j as h,l as u,n as J,p as T}from"./chunk-WMYPRHRR.js";import{O as x,P as d,Q as y,R as w,b as f,d as p}from"./chunk-IAMDMFZ7.js";import{a as m}from"./chunk-53MWZ23O.js";import{b as _,p as E,r as b}from"./chunk-465DRXTW.js";import{e as D}from"./chunk-AC62Z3FX.js";import{a as v,b as N}from"./chunk-ESDYQQXO.js";function k(i,r,e,t,o){let s={};return r.write?.writer?.call(i,t,s,e,o),s}function C(i,r,e,t,o,s){if(!t?.write)return!1;let n=O(i,e);if(!o&&t.write.overridePolicy){let a=t.write.overridePolicy.call(i,n,e,s??void 0);a!==void 0&&(o=a)}if(o||(o=t.write),!o||o.enabled===!1||o.layerContainerTypes&&s?.layerContainerType&&!o.layerContainerTypes.includes(s.layerContainerType))return!1;if((n===null&&!o.allowNull&&!o.writerEnsuresNonNull||n===void 0)&&o.isRequired){let a=new b("web-document-write:property-required",`Missing value for required property '${e}' on '${i.declaredClass}'`,{propertyName:e,target:i});return a&&s?.messages?s.messages.push(a):a&&!s&&E.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(n===void 0||n===null&&!o.allowNull&&!o.writerEnsuresNonNull||!o.alwaysWriteDefaults&&(!r.store.multipleOriginsSupported||r.store.originOf(e)===u.DEFAULTS)&&F(i,e,s,t,n)||!o.ignoreOrigin&&s?.origin&&r.store.multipleOriginsSupported&&r.store.originOf(e)<J(s.origin))}function F(i,r,e,t,o){let s=t.default;if(s===void 0)return!1;if(t.defaultEquals!=null)return t.defaultEquals(o);if(typeof s=="function"){if(Array.isArray(o)){let n=s.call(i,r,e??void 0);return D(n,o)}return!1}return s===o}function Z(i,r,e,t){let o=f(i),s=o.metadatas,n=y(s[r],t);return!!n&&C(i,o,r,n,e,t)}function z(i,r,e){if(i&&typeof i.toJSON=="function"&&(!i.toJSON.isDefaultToJSON||!i.write))return p(r,i.toJSON(e));let t=f(i),o=t.metadatas;for(let s in o){let n=y(o[s],e);if(!C(i,t,s,n,void 0,e))continue;let a=O(i,s),l=k(i,n,n.write&&typeof n.write.target=="string"?n.write.target:s,a,e);Object.keys(l).length>0&&(r=p(r,l),e?.resources?.pendingOperations?.length&&e.resources.pendingOperations.push(Promise.all(e.resources.pendingOperations).then(()=>p(r,l,()=>"replace-arrays"))),e?.writtenProperties&&e.writtenProperties.push({target:i,propName:s,oldOrigin:T(t.store.originOf(s)),newOrigin:e.origin}))}return r}var g=class i{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(r){let e=new i;return this._values.forEach((t,o)=>{r&&r.has(o)||e.set(o,_(t.value),t.origin)}),e}get(r,e){e=this._normalizeOrigin(e);let t=this._values.get(r);return e==null||t?.origin===e?t?.value:void 0}originOf(r){return this._values.get(r)?.origin??u.USER}keys(r){r=this._normalizeOrigin(r);let e=[...this._values.keys()];return r==null?e:e.filter(t=>this._values.get(t)?.origin===r)}set(r,e,t){if((t=this._normalizeOrigin(t))===u.DEFAULTS){let o=this._values.get(r);if(o?.origin!=null&&o.origin>t)return}this._values.set(r,new S(e,t))}delete(r,e){(e=this._normalizeOrigin(e))!=null&&this._values.get(r)?.origin!==e||this._values.delete(r)}has(r,e){return(e=this._normalizeOrigin(e))!=null?this._values.get(r)?.origin===e:this._values.has(r)}forEach(r){this._values.forEach(({value:e},t)=>r(e,t))}_normalizeOrigin(r){if(r!=null)return r===u.DEFAULTS?r:u.USER}},S=class{constructor(r,e){this.value=r,this.origin=e}};function A(i,r,e){r.keys().forEach(o=>{e.set(o,r.get(o),u.DEFAULTS)});let t=i.metadatas;Object.keys(t).forEach(o=>{i.internalGet(o)&&e.set(o,i.internalGet(o),u.DEFAULTS)})}function R(i,r,e){if(!i?.read||i.read.enabled===!1||!i.read.source)return!1;let t=i.read.source;if(typeof t=="string"){if(t===r||t.includes(".")&&t.indexOf(r)===0&&h(t,e))return!0}else for(let o of t)if(o===r||o.includes(".")&&o.indexOf(r)===0&&h(o,e))return!0;return!1}function I(i){return i&&(!i.read||i.read.enabled!==!1&&!i.read.source)}function W(i,r,e,t,o){let s=d(r[e],o);I(s)&&(i[e]=!0);for(let n of Object.getOwnPropertyNames(r))s=d(r[n],o),R(s,e,t)&&(i[n]=!0)}function M(i,r,e,t){let o=e.metadatas,s=x(o[r],t),n=s?.default;if(n===void 0)return;let a=typeof n=="function"?n.call(i,r,t):n;a!==void 0&&e.set(r,a)}var L={origin:"service"};function U(i,r,e=L){if(!r||typeof r!="object")return;let t=f(i),o=t.metadatas,s={};for(let n of Object.getOwnPropertyNames(r))W(s,o,n,r,e);t.setDefaultOrigin(e.origin);for(let n of Object.getOwnPropertyNames(s)){let a=d(o[n],e).read,l=a?.source,c;c=l&&typeof l=="string"?P(r,l):r[n],a?.reader&&(c=a.reader.call(i,c,r,e)),c!==void 0&&t.set(n,c)}if(!e||!e.ignoreDefaults){t.setDefaultOrigin("defaults");for(let n of Object.getOwnPropertyNames(o))s[n]||M(i,n,t,e)}t.setDefaultOrigin("user")}function le(i,r,e,t=L){let o=N(v({},t),{messages:[]});e(o),o.messages?.forEach(s=>{s.type!=="warning"||i.loaded?t?.messages&&t.messages.push(s):i.loadWarnings.push(s)})}var G=i=>{let r=class extends i{constructor(...e){super(...e);let t=f(this),o=t.store,s=new g;t.store=s,A(t,o,s)}read(e,t){U(this,e,t)}write(e,t){return z(this,e??{},t)}toJSON(e){return this.write({},e)}static fromJSON(e,t){return $.call(this,e,t)}};return r=m([w("esri.core.JSONSupport")],r),r.prototype.toJSON.isDefaultToJSON=!0,r};function $(i,r){if(!i)return null;if(i.declaredClass)throw new Error("JSON object is already hydrated");let e=new this;return e.read(i,r),e}function Se(i){return i&&typeof i=="object"&&"toJSON"in i&&typeof i.toJSON=="function"}var q=class extends G(j){};q=m([w("esri.core.JSONSupport")],q);export{A as a,U as b,le as c,Z as d,z as e,G as f,Se as g,q as h};
